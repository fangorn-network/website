module.exports = [
"[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/equals.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * Returns true if the two passed Uint8Arrays have the same content
 */ __turbopack_context__.s([
    "equals",
    ()=>equals
]);
function equals(a, b) {
    if (a === b) {
        return true;
    }
    if (a.byteLength !== b.byteLength) {
        return false;
    }
    for(let i = 0; i < a.byteLength; i++){
        if (a[i] !== b[i]) {
            return false;
        }
    }
    return true;
} //# sourceMappingURL=equals.js.map
}),
"[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/util/as-uint8array.node.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * To guarantee Uint8Array semantics, convert nodejs Buffers
 * into vanilla Uint8Arrays
 */ __turbopack_context__.s([
    "asUint8Array",
    ()=>asUint8Array
]);
function asUint8Array(buf) {
    return new Uint8Array(buf.buffer, buf.byteOffset, buf.byteLength);
} //# sourceMappingURL=as-uint8array.node.js.map
}),
"[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/alloc.node.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "alloc",
    ()=>alloc,
    "allocUnsafe",
    ()=>allocUnsafe
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:buffer [external] (node:buffer, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/util/as-uint8array.node.js [app-ssr] (ecmascript)");
;
;
function alloc(size = 0) {
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["asUint8Array"])(__TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__["Buffer"].alloc(size));
}
function allocUnsafe(size = 0) {
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["asUint8Array"])(__TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__["Buffer"].allocUnsafe(size));
} //# sourceMappingURL=alloc.node.js.map
}),
"[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/xor.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "xor",
    ()=>xor
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$alloc$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/alloc.node.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/util/as-uint8array.node.js [app-ssr] (ecmascript)");
;
;
function xor(a, b) {
    if (a.length !== b.length) {
        throw new Error('Inputs should have the same length');
    }
    const result = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$alloc$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["allocUnsafe"])(a.length);
    for(let i = 0; i < a.length; i++){
        result[i] = a[i] ^ b[i];
    }
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["asUint8Array"])(result);
} //# sourceMappingURL=xor.js.map
}),
"[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/compare.node.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "compare",
    ()=>compare
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:buffer [external] (node:buffer, cjs)");
;
function compare(a, b) {
    return __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__["Buffer"].compare(a, b);
} //# sourceMappingURL=compare.node.js.map
}),
"[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/concat.node.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "concat",
    ()=>concat
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:buffer [external] (node:buffer, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/util/as-uint8array.node.js [app-ssr] (ecmascript)");
;
;
function concat(arrays, length) {
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["asUint8Array"])(__TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__["Buffer"].concat(arrays, length));
} //# sourceMappingURL=concat.node.js.map
}),
"[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/util/bases.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$basics$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/basics.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$alloc$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/alloc.node.js [app-ssr] (ecmascript)");
;
;
function createCodec(name, prefix, encode, decode) {
    return {
        name,
        prefix,
        encoder: {
            name,
            prefix,
            encode
        },
        decoder: {
            decode
        }
    };
}
const string = createCodec('utf8', 'u', (buf)=>{
    const decoder = new TextDecoder('utf8');
    return 'u' + decoder.decode(buf);
}, (str)=>{
    const encoder = new TextEncoder();
    return encoder.encode(str.substring(1));
});
const ascii = createCodec('ascii', 'a', (buf)=>{
    let string = 'a';
    for(let i = 0; i < buf.length; i++){
        string += String.fromCharCode(buf[i]);
    }
    return string;
}, (str)=>{
    str = str.substring(1);
    const buf = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$alloc$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["allocUnsafe"])(str.length);
    for(let i = 0; i < str.length; i++){
        buf[i] = str.charCodeAt(i);
    }
    return buf;
});
const BASES = {
    utf8: string,
    'utf-8': string,
    hex: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$basics$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["bases"].base16,
    latin1: ascii,
    ascii,
    binary: ascii,
    ...__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$basics$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["bases"]
};
const __TURBOPACK__default__export__ = BASES;
 //# sourceMappingURL=bases.js.map
}),
"[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/from-string.node.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "fromString",
    ()=>fromString
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:buffer [external] (node:buffer, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$bases$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/util/bases.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/util/as-uint8array.node.js [app-ssr] (ecmascript)");
;
;
;
function fromString(string, encoding = 'utf8') {
    const base = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$bases$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"][encoding];
    if (base == null) {
        throw new Error(`Unsupported encoding "${encoding}"`);
    }
    if (encoding === 'utf8' || encoding === 'utf-8') {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["asUint8Array"])(__TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__["Buffer"].from(string, 'utf-8'));
    }
    // add multibase prefix
    return base.decoder.decode(`${base.prefix}${string}`); // eslint-disable-line @typescript-eslint/restrict-template-expressions
} //# sourceMappingURL=from-string.node.js.map
}),
"[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/to-string.node.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "toString",
    ()=>toString
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:buffer [external] (node:buffer, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$bases$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/util/bases.js [app-ssr] (ecmascript)");
;
;
function toString(array, encoding = 'utf8') {
    const base = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$bases$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"][encoding];
    if (base == null) {
        throw new Error(`Unsupported encoding "${encoding}"`);
    }
    if (encoding === 'utf8' || encoding === 'utf-8') {
        return __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__["Buffer"].from(array.buffer, array.byteOffset, array.byteLength).toString('utf8');
    }
    // strip multibase prefix
    return base.encoder.encode(array).substring(1);
} //# sourceMappingURL=to-string.node.js.map
}),
"[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/index.js [app-ssr] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

/**
 * @packageDocumentation
 *
 * `Uint8Array`s bring memory-efficient(ish) byte handling to browsers - they are similar to Node.js `Buffer`s but lack a lot of the utility methods present on that class.
 *
 * This module exports a number of function that let you do common operations - joining Uint8Arrays together, seeing if they have the same contents etc.
 *
 * Since Node.js `Buffer`s are also `Uint8Array`s, it falls back to `Buffer` internally where it makes sense for performance reasons.
 *
 * ## alloc(size)
 *
 * Create a new `Uint8Array`. When running under Node.js, `Buffer` will be used in preference to `Uint8Array`.
 *
 * ### Example
 *
 * ```js
 * import { alloc } from 'uint8arrays/alloc'
 *
 * const buf = alloc(100)
 * ```
 *
 * ## allocUnsafe(size)
 *
 * Create a new `Uint8Array`. When running under Node.js, `Buffer` will be used in preference to `Uint8Array`.
 *
 * On platforms that support it, memory referenced by the returned `Uint8Array` will not be initialized.
 *
 * ### Example
 *
 * ```js
 * import { allocUnsafe } from 'uint8arrays/alloc'
 *
 * const buf = allocUnsafe(100)
 * ```
 *
 * ## compare(a, b)
 *
 * Compare two `Uint8Arrays`
 *
 * ### Example
 *
 * ```js
 * import { compare } from 'uint8arrays/compare'
 *
 * const arrays = [
 *   Uint8Array.from([3, 4, 5]),
 *   Uint8Array.from([0, 1, 2])
 * ]
 *
 * const sorted = arrays.sort(compare)
 *
 * console.info(sorted)
 * // [
 * //    Uint8Array[0, 1, 2]
 * //    Uint8Array[3, 4, 5]
 * // ]
 * ```
 *
 * ## concat(arrays, \[length])
 *
 * Concatenate one or more `Uint8Array`s and return a `Uint8Array` with their contents.
 *
 * If you know the length of the arrays, pass it as a second parameter, otherwise it will be calculated by traversing the list of arrays.
 *
 * ### Example
 *
 * ```js
 * import { concat } from 'uint8arrays/concat'
 *
 * const arrays = [
 *   Uint8Array.from([0, 1, 2]),
 *   Uint8Array.from([3, 4, 5])
 * ]
 *
 * const all = concat(arrays, 6)
 *
 * console.info(all)
 * // Uint8Array[0, 1, 2, 3, 4, 5]
 * ```
 *
 * ## equals(a, b)
 *
 * Returns true if the two arrays are the same array or if they have the same length and contents.
 *
 * ### Example
 *
 * ```js
 * import { equals } from 'uint8arrays/equals'
 *
 * const a = Uint8Array.from([0, 1, 2])
 * const b = Uint8Array.from([3, 4, 5])
 * const c = Uint8Array.from([0, 1, 2])
 *
 * console.info(equals(a, b)) // false
 * console.info(equals(a, c)) // true
 * console.info(equals(a, a)) // true
 * ```
 *
 * ## fromString(string, encoding = 'utf8')
 *
 * Returns a new `Uint8Array` created from the passed string and interpreted as the passed encoding.
 *
 * Supports `utf8` and any of the [multibase encodings](https://github.com/multiformats/multibase/blob/master/multibase.csv) as implemented by the [multiformats module](https://www.npmjs.com/package/multiformats).
 *
 * ### Example
 *
 * ```js
 * import { fromString } from 'uint8arrays/from-string'
 *
 * console.info(fromString('hello world')) // Uint8Array[104, 101 ...
 * console.info(fromString('00010203aabbcc', 'base16')) // Uint8Array[0, 1 ...
 * console.info(fromString('AAECA6q7zA', 'base64')) // Uint8Array[0, 1 ...
 * console.info(fromString('01234', 'ascii')) // Uint8Array[48, 49 ...
 * ```
 *
 * ## toString(array, encoding = 'utf8')
 *
 * Returns a string created from the passed `Uint8Array` in the passed encoding.
 *
 * Supports `utf8` and any of the [multibase encodings](https://github.com/multiformats/multibase/blob/master/multibase.csv) as implemented by the [multiformats module](https://www.npmjs.com/package/multiformats).
 *
 * ### Example
 *
 * ```js
 * import { toString } from 'uint8arrays/to-string'
 *
 * console.info(toString(Uint8Array.from([104, 101...]))) // 'hello world'
 * console.info(toString(Uint8Array.from([0, 1, 2...]), 'base16')) // '00010203aabbcc'
 * console.info(toString(Uint8Array.from([0, 1, 2...]), 'base64')) // 'AAECA6q7zA'
 * console.info(toString(Uint8Array.from([48, 49, 50...]), 'ascii')) // '01234'
 * ```
 *
 * ## xor(a, b)
 *
 * Returns a `Uint8Array` containing `a` and `b` xored together.
 *
 * ### Example
 *
 * ```js
 * import { xor } from 'uint8arrays/xor'
 *
 * console.info(xor(Uint8Array.from([1, 0]), Uint8Array.from([0, 1]))) // Uint8Array[1, 1]
 * ```
 *
 * ## xorCompare(a, b)
 *
 * Compares the distances between two xor `Uint8Array`s.
 *
 * ### Example
 *
 * ```ts
 * import { xor } from 'uint8arrays/xor'
 * import { xorCompare } from 'uint8arrays/xor-compare'
 *
 * const target = Uint8Array.from([1, 1])
 * const val1 = Uint8Array.from([1, 0])
 * const xor1 = xor(target, val1)
 *
 * const val2 = Uint8Array.from([0, 1])
 * const xor2 = xor(target, val2)
 *
 * console.info(xorCompare(xor1, xor2)) // -1 or 0 or 1
 * ```
 */ __turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$equals$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/equals.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$xor$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/xor.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$compare$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/compare.node.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$concat$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/concat.node.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$from$2d$string$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/from-string.node.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$to$2d$string$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/to-string.node.js [app-ssr] (ecmascript)");
;
;
;
;
;
;
;
 //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/equals.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * Returns true if the two passed Uint8Arrays have the same content
 */ __turbopack_context__.s([
    "equals",
    ()=>equals
]);
function equals(a, b) {
    if (a === b) {
        return true;
    }
    if (a.byteLength !== b.byteLength) {
        return false;
    }
    for(let i = 0; i < a.byteLength; i++){
        if (a[i] !== b[i]) {
            return false;
        }
    }
    return true;
} //# sourceMappingURL=equals.js.map
}),
"[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/util/as-uint8array.node.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * To guarantee Uint8Array semantics, convert nodejs Buffers
 * into vanilla Uint8Arrays
 */ __turbopack_context__.s([
    "asUint8Array",
    ()=>asUint8Array
]);
function asUint8Array(buf) {
    return new Uint8Array(buf.buffer, buf.byteOffset, buf.byteLength);
} //# sourceMappingURL=as-uint8array.node.js.map
}),
"[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/alloc.node.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "alloc",
    ()=>alloc,
    "allocUnsafe",
    ()=>allocUnsafe
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:buffer [external] (node:buffer, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/util/as-uint8array.node.js [app-ssr] (ecmascript)");
;
;
function alloc(size = 0) {
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["asUint8Array"])(__TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__["Buffer"].alloc(size));
}
function allocUnsafe(size = 0) {
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["asUint8Array"])(__TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__["Buffer"].allocUnsafe(size));
} //# sourceMappingURL=alloc.node.js.map
}),
"[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/xor.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "xor",
    ()=>xor
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$alloc$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/alloc.node.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/util/as-uint8array.node.js [app-ssr] (ecmascript)");
;
;
function xor(a, b) {
    if (a.length !== b.length) {
        throw new Error('Inputs should have the same length');
    }
    const result = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$alloc$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["allocUnsafe"])(a.length);
    for(let i = 0; i < a.length; i++){
        result[i] = a[i] ^ b[i];
    }
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["asUint8Array"])(result);
} //# sourceMappingURL=xor.js.map
}),
"[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/compare.node.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "compare",
    ()=>compare
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:buffer [external] (node:buffer, cjs)");
;
function compare(a, b) {
    return __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__["Buffer"].compare(a, b);
} //# sourceMappingURL=compare.node.js.map
}),
"[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/concat.node.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "concat",
    ()=>concat
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:buffer [external] (node:buffer, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/util/as-uint8array.node.js [app-ssr] (ecmascript)");
;
;
function concat(arrays, length) {
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["asUint8Array"])(__TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__["Buffer"].concat(arrays, length));
} //# sourceMappingURL=concat.node.js.map
}),
"[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/util/bases.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$basics$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/basics.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$alloc$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/alloc.node.js [app-ssr] (ecmascript)");
;
;
function createCodec(name, prefix, encode, decode) {
    return {
        name,
        prefix,
        encoder: {
            name,
            prefix,
            encode
        },
        decoder: {
            decode
        }
    };
}
const string = createCodec('utf8', 'u', (buf)=>{
    const decoder = new TextDecoder('utf8');
    return 'u' + decoder.decode(buf);
}, (str)=>{
    const encoder = new TextEncoder();
    return encoder.encode(str.substring(1));
});
const ascii = createCodec('ascii', 'a', (buf)=>{
    let string = 'a';
    for(let i = 0; i < buf.length; i++){
        string += String.fromCharCode(buf[i]);
    }
    return string;
}, (str)=>{
    str = str.substring(1);
    const buf = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$alloc$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["allocUnsafe"])(str.length);
    for(let i = 0; i < str.length; i++){
        buf[i] = str.charCodeAt(i);
    }
    return buf;
});
const BASES = {
    utf8: string,
    'utf-8': string,
    hex: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$basics$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["bases"].base16,
    latin1: ascii,
    ascii,
    binary: ascii,
    ...__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$basics$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["bases"]
};
const __TURBOPACK__default__export__ = BASES;
 //# sourceMappingURL=bases.js.map
}),
"[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/from-string.node.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "fromString",
    ()=>fromString
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:buffer [external] (node:buffer, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$bases$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/util/bases.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/util/as-uint8array.node.js [app-ssr] (ecmascript)");
;
;
;
function fromString(string, encoding = 'utf8') {
    const base = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$bases$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"][encoding];
    if (base == null) {
        throw new Error(`Unsupported encoding "${encoding}"`);
    }
    if (encoding === 'utf8' || encoding === 'utf-8') {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$as$2d$uint8array$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["asUint8Array"])(__TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__["Buffer"].from(string, 'utf-8'));
    }
    // add multibase prefix
    return base.decoder.decode(`${base.prefix}${string}`); // eslint-disable-line @typescript-eslint/restrict-template-expressions
} //# sourceMappingURL=from-string.node.js.map
}),
"[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/to-string.node.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "toString",
    ()=>toString
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/node:buffer [external] (node:buffer, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$bases$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/util/bases.js [app-ssr] (ecmascript)");
;
;
function toString(array, encoding = 'utf8') {
    const base = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$util$2f$bases$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"][encoding];
    if (base == null) {
        throw new Error(`Unsupported encoding "${encoding}"`);
    }
    if (encoding === 'utf8' || encoding === 'utf-8') {
        return __TURBOPACK__imported__module__$5b$externals$5d2f$node$3a$buffer__$5b$external$5d$__$28$node$3a$buffer$2c$__cjs$29$__["Buffer"].from(array.buffer, array.byteOffset, array.byteLength).toString('utf8');
    }
    // strip multibase prefix
    return base.encoder.encode(array).substring(1);
} //# sourceMappingURL=to-string.node.js.map
}),
"[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/index.js [app-ssr] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

/**
 * @packageDocumentation
 *
 * `Uint8Array`s bring memory-efficient(ish) byte handling to browsers - they are similar to Node.js `Buffer`s but lack a lot of the utility methods present on that class.
 *
 * This module exports a number of function that let you do common operations - joining Uint8Arrays together, seeing if they have the same contents etc.
 *
 * Since Node.js `Buffer`s are also `Uint8Array`s, it falls back to `Buffer` internally where it makes sense for performance reasons.
 *
 * ## alloc(size)
 *
 * Create a new `Uint8Array`. When running under Node.js, `Buffer` will be used in preference to `Uint8Array`.
 *
 * ### Example
 *
 * ```js
 * import { alloc } from 'uint8arrays/alloc'
 *
 * const buf = alloc(100)
 * ```
 *
 * ## allocUnsafe(size)
 *
 * Create a new `Uint8Array`. When running under Node.js, `Buffer` will be used in preference to `Uint8Array`.
 *
 * On platforms that support it, memory referenced by the returned `Uint8Array` will not be initialized.
 *
 * ### Example
 *
 * ```js
 * import { allocUnsafe } from 'uint8arrays/alloc'
 *
 * const buf = allocUnsafe(100)
 * ```
 *
 * ## compare(a, b)
 *
 * Compare two `Uint8Arrays`
 *
 * ### Example
 *
 * ```js
 * import { compare } from 'uint8arrays/compare'
 *
 * const arrays = [
 *   Uint8Array.from([3, 4, 5]),
 *   Uint8Array.from([0, 1, 2])
 * ]
 *
 * const sorted = arrays.sort(compare)
 *
 * console.info(sorted)
 * // [
 * //    Uint8Array[0, 1, 2]
 * //    Uint8Array[3, 4, 5]
 * // ]
 * ```
 *
 * ## concat(arrays, \[length])
 *
 * Concatenate one or more `Uint8Array`s and return a `Uint8Array` with their contents.
 *
 * If you know the length of the arrays, pass it as a second parameter, otherwise it will be calculated by traversing the list of arrays.
 *
 * ### Example
 *
 * ```js
 * import { concat } from 'uint8arrays/concat'
 *
 * const arrays = [
 *   Uint8Array.from([0, 1, 2]),
 *   Uint8Array.from([3, 4, 5])
 * ]
 *
 * const all = concat(arrays, 6)
 *
 * console.info(all)
 * // Uint8Array[0, 1, 2, 3, 4, 5]
 * ```
 *
 * ## equals(a, b)
 *
 * Returns true if the two arrays are the same array or if they have the same length and contents.
 *
 * ### Example
 *
 * ```js
 * import { equals } from 'uint8arrays/equals'
 *
 * const a = Uint8Array.from([0, 1, 2])
 * const b = Uint8Array.from([3, 4, 5])
 * const c = Uint8Array.from([0, 1, 2])
 *
 * console.info(equals(a, b)) // false
 * console.info(equals(a, c)) // true
 * console.info(equals(a, a)) // true
 * ```
 *
 * ## fromString(string, encoding = 'utf8')
 *
 * Returns a new `Uint8Array` created from the passed string and interpreted as the passed encoding.
 *
 * Supports `utf8` and any of the [multibase encodings](https://github.com/multiformats/multibase/blob/master/multibase.csv) as implemented by the [multiformats module](https://www.npmjs.com/package/multiformats).
 *
 * ### Example
 *
 * ```js
 * import { fromString } from 'uint8arrays/from-string'
 *
 * console.info(fromString('hello world')) // Uint8Array[104, 101 ...
 * console.info(fromString('00010203aabbcc', 'base16')) // Uint8Array[0, 1 ...
 * console.info(fromString('AAECA6q7zA', 'base64')) // Uint8Array[0, 1 ...
 * console.info(fromString('01234', 'ascii')) // Uint8Array[48, 49 ...
 * ```
 *
 * ## toString(array, encoding = 'utf8')
 *
 * Returns a string created from the passed `Uint8Array` in the passed encoding.
 *
 * Supports `utf8` and any of the [multibase encodings](https://github.com/multiformats/multibase/blob/master/multibase.csv) as implemented by the [multiformats module](https://www.npmjs.com/package/multiformats).
 *
 * ### Example
 *
 * ```js
 * import { toString } from 'uint8arrays/to-string'
 *
 * console.info(toString(Uint8Array.from([104, 101...]))) // 'hello world'
 * console.info(toString(Uint8Array.from([0, 1, 2...]), 'base16')) // '00010203aabbcc'
 * console.info(toString(Uint8Array.from([0, 1, 2...]), 'base64')) // 'AAECA6q7zA'
 * console.info(toString(Uint8Array.from([48, 49, 50...]), 'ascii')) // '01234'
 * ```
 *
 * ## xor(a, b)
 *
 * Returns a `Uint8Array` containing `a` and `b` xored together.
 *
 * ### Example
 *
 * ```js
 * import { xor } from 'uint8arrays/xor'
 *
 * console.info(xor(Uint8Array.from([1, 0]), Uint8Array.from([0, 1]))) // Uint8Array[1, 1]
 * ```
 *
 * ## xorCompare(a, b)
 *
 * Compares the distances between two xor `Uint8Array`s.
 *
 * ### Example
 *
 * ```ts
 * import { xor } from 'uint8arrays/xor'
 * import { xorCompare } from 'uint8arrays/xor-compare'
 *
 * const target = Uint8Array.from([1, 1])
 * const val1 = Uint8Array.from([1, 0])
 * const xor1 = xor(target, val1)
 *
 * const val2 = Uint8Array.from([0, 1])
 * const xor2 = xor(target, val2)
 *
 * console.info(xorCompare(xor1, xor2)) // -1 or 0 or 1
 * ```
 */ __turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$equals$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/equals.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$xor$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/xor.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$compare$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/compare.node.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$concat$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/concat.node.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$from$2d$string$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/from-string.node.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$to$2d$string$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/to-string.node.js [app-ssr] (ecmascript)");
;
;
;
;
;
;
;
 //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@storacha/access/dist/errors.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
;
 //# sourceMappingURL=errors.js.map
}),
"[project]/node_modules/@storacha/access/dist/types.js [app-ssr] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

// export other types
__turbopack_context__.s([
    "AppName",
    ()=>AppName
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$types$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/types.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$errors$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/errors.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/did-mailto/dist/index.js [app-ssr] (ecmascript) <locals>");
;
;
;
;
var AppName;
(function(AppName) {
    AppName["BskyBackups"] = "bsky-backups";
    AppName["TGMiniapp"] = "tg-miniapp";
    AppName["Console"] = "console";
})(AppName || (AppName = {})); //# sourceMappingURL=types.js.map
}),
"[project]/node_modules/@storacha/access/dist/encoding.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * Encoding utilities
 *
 * It is recommended that you import directly with:
 * ```js
 * import * as Encoding from '@storacha/access/encoding'
 *
 * // or
 *
 * import { encodeDelegations } from '@storacha/access/encoding'
 * ```
 *
 * @module
 */ __turbopack_context__.s([
    "bytesToDelegations",
    ()=>bytesToDelegations,
    "delegationToString",
    ()=>delegationToString,
    "delegationsToBytes",
    ()=>delegationsToBytes,
    "delegationsToString",
    ()=>delegationsToString,
    "expirationToDate",
    ()=>expirationToDate,
    "stringToDelegation",
    ()=>stringToDelegation,
    "stringToDelegations",
    ()=>stringToDelegations
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$car$2f$src$2f$buffer$2d$reader$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ipld/car/src/buffer-reader.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$car$2f$src$2f$buffer$2d$writer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ipld/car/src/buffer-writer.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/index.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$to$2d$string$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/to-string.node.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$from$2d$string$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/node_modules/uint8arrays/dist/src/from-string.node.js [app-ssr] (ecmascript)");
// eslint-disable-next-line no-unused-vars
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-ssr] (ecmascript)");
;
;
;
;
;
function delegationsToBytes(delegations) {
    if (!Array.isArray(delegations) || delegations.length === 0) {
        throw new Error('Delegations required to be an non empty array.');
    }
    const roots = delegations.map((d)=>d.root.cid);
    const cids = new Set();
    /** @type {CarBufferWriter.Block[]} */ const blocks = [];
    let byteLength = 0;
    for (const delegation of delegations){
        for (const block of delegation.export()){
            const cid = block.cid.toV1().toString();
            if (!cids.has(cid)) {
                byteLength += __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$car$2f$src$2f$buffer$2d$writer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["blockLength"](block);
                blocks.push(block);
                cids.add(cid);
            }
        }
    }
    const headerLength = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$car$2f$src$2f$buffer$2d$writer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["estimateHeaderLength"](roots.length);
    const writer = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$car$2f$src$2f$buffer$2d$writer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createWriter"](new ArrayBuffer(headerLength + byteLength), {
        roots
    });
    for (const block of blocks){
        writer.write(block);
    }
    return writer.close();
}
function bytesToDelegations(bytes) {
    if (!(bytes instanceof Uint8Array) || bytes.length === 0) {
        throw new TypeError('Input should be a non-empty Uint8Array.');
    }
    const reader = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$car$2f$src$2f$buffer$2d$reader$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["CarBufferReader"].fromBytes(bytes);
    const roots = reader.getRoots();
    /** @type {Types.Delegation<T>[]} */ const delegations = [];
    for (const root of roots){
        const rootBlock = reader.get(root);
        if (rootBlock) {
            const blocks = new Map();
            for (const block of reader.blocks()){
                if (block.cid.toString() !== root.toString()) blocks.set(block.cid.toString(), block);
            }
            // @ts-ignore
            delegations.push(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Delegation"](rootBlock, blocks));
        } else {
            throw new Error('Failed to find root from raw delegation.');
        }
    }
    return delegations;
}
function delegationsToString(delegations, encoding = 'base64url') {
    const bytes = delegationsToBytes(delegations);
    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$to$2d$string$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["toString"](bytes, encoding);
}
function delegationToString(delegation, encoding) {
    return delegationsToString([
        delegation
    ], encoding);
}
function stringToDelegations(raw, encoding = 'base64url') {
    const bytes = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$from$2d$string$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["fromString"](raw, encoding);
    return bytesToDelegations(bytes);
}
function stringToDelegation(raw, encoding) {
    const delegations = stringToDelegations(raw, encoding);
    return delegations[0];
}
function expirationToDate(expiration) {
    const expires = expiration === Infinity || !expiration ? undefined : new Date(expiration * 1000);
    return expires;
} //# sourceMappingURL=encoding.js.map
}),
"[project]/node_modules/@storacha/access/dist/access.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "GrantedAccess",
    ()=>GrantedAccess,
    "accountAccess",
    ()=>accountAccess,
    "claim",
    ()=>claim,
    "createPendingAccessRequest",
    ()=>createPendingAccessRequest,
    "delegate",
    ()=>delegate,
    "request",
    ()=>request,
    "spaceAccess",
    ()=>spaceAccess,
    "toCapabilities",
    ()=>toCapabilities
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/access.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$types$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/types.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/result.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__DID$3e$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/did.js [app-ssr] (ecmascript) <export * as DID>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/agent.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$encoding$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/encoding.js [app-ssr] (ecmascript)");
;
;
;
;
;
const delegate = async (agent, { delegations, proofs = [], space = agent.currentSpace() })=>{
    if (!space) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["fail"])('Space must be specified');
    }
    const entries = Object.values(delegations).map((proof)=>[
            proof.cid.toString(),
            proof.cid
        ]);
    const { out } = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["delegate"], {
        with: space,
        nb: {
            delegations: Object.fromEntries(entries)
        },
        // must be embedded here because it's referenced by cid in .nb.delegations
        proofs: [
            ...delegations,
            ...proofs
        ]
    });
    return out;
};
const request = async (agent, { account, provider = agent.connection.id.did(), audience: audience = agent.did(), access = spaceAccess, appName, sso })=>{
    // Build facts array with appName and SSO object
    const facts = [];
    if (appName) {
        facts.push({
            appName
        });
    }
    if (sso) {
        if (typeof sso !== 'object') {
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["fail"])('SSO parameter must be an object');
        }
        if (!sso.authProvider || typeof sso.authProvider !== 'string') {
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["fail"])('SSO authProvider must be a non-empty string');
        }
        if (!sso.externalUserId || typeof sso.externalUserId !== 'string') {
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["fail"])('SSO externalUserId must be a non-empty string');
        }
        if (!sso.externalSessionToken || typeof sso.externalSessionToken !== 'string') {
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["fail"])('SSO externalSessionToken must be a non-empty string');
        }
        facts.push({
            sso: {
                authProvider: sso.authProvider,
                externalUserId: sso.externalUserId,
                externalSessionToken: sso.externalSessionToken
            }
        });
    }
    // Request access from the account.
    const { out: result } = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["authorize"], {
        audience: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__DID$3e$__["DID"].parse(provider),
        with: audience,
        nb: {
            iss: account,
            // New ucan spec moved to recap style layout for capabilities and new
            // `access/request` will use similar format as opposed to legacy one,
            // in the meantime we translate new format to legacy format here.
            att: [
                ...toCapabilities(access)
            ]
        },
        facts
    });
    return result.error ? result : {
        ok: new PendingAccessRequest({
            ...result.ok,
            agent,
            audience,
            provider
        })
    };
};
const claim = async (agent, { provider = agent.connection.id.did(), audience = agent.did() } = {})=>{
    const { out: result } = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["claim"], {
        audience: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__DID$3e$__["DID"].parse(provider),
        with: audience
    });
    if (result.error) {
        return result;
    } else {
        const delegations = Object.values(result.ok.delegations);
        const proofs = delegations.flatMap((proof)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$encoding$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["bytesToDelegations"])(proof));
        return {
            ok: new GrantedAccess({
                agent,
                proofs
            })
        };
    }
};
const createPendingAccessRequest = (agent, { request, expiration, provider = agent.connection.id.did(), audience: audience = agent.did() })=>new PendingAccessRequest({
        agent,
        request,
        expiration,
        provider,
        audience
    });
/**
 * Represents a pending access request. It can be used to poll for the requested
 * delegation.
 */ class PendingAccessRequest {
    /**
     * @typedef {object} PendingAccessRequestModel
     * @property {API.Agent} agent - Agent handling interaction.
     * @property {API.DID} audience - Principal requesting an access.
     * @property {API.ProviderDID} provider - Provider handling request.
     * @property {API.UTCUnixTimestamp} expiration - Seconds in UTC.
     * @property {API.Link} request - Link to the `access/authorize` invocation.
     *
     * @param {PendingAccessRequestModel} model
     */ constructor(model){
        this.model = model;
    }
    get agent() {
        return this.model.agent;
    }
    get audience() {
        return this.model.audience;
    }
    get expiration() {
        return new Date(this.model.expiration * 1000);
    }
    get request() {
        return this.model.request;
    }
    get provider() {
        return this.model.provider;
    }
    /**
     * Low level method and most likely you want to use `.claim` instead. This method will poll
     * fetch delegations **just once** and will return proofs matching to this request. Please note
     * that there may not be any matches in which case result will be `{ ok: [] }`.
     *
     * If you do want to continuously poll until request is approved or expired, you should use
     * `.claim` method instead.
     *
     * @returns {Promise<API.Result<API.Delegation[], API.InvocationError|API.AccessClaimFailure|RequestExpired>>}
     */ async poll() {
        const { agent, audience, provider, expiration } = this.model;
        const timeout = expiration * 1000 - Date.now();
        if (timeout <= 0) {
            return {
                error: new RequestExpired(this.model)
            };
        } else {
            const result = await claim(agent, {
                audience,
                provider
            });
            return result.error ? result : {
                ok: result.ok.proofs.filter((proof)=>isRequestedAccess(proof, this.model))
            };
        }
    }
    /**
     * Continuously polls delegations until this request is approved or expired. Returns
     * a `GrantedAccess` object (view over the delegations) that can be used in the
     * invocations or can be saved in the agent (store) using `.save()` method.
     *
     * @param {object} options
     * @param {number} [options.interval]
     * @param {AbortSignal} [options.signal]
     * @returns {Promise<API.Result<GrantedAccess, Error>>}
     */ async claim({ signal, interval = 250 } = {}) {
        while(signal?.aborted !== true){
            const result = await this.poll();
            // If polling failed, return the error.
            if (result.error) {
                return result;
            } else if (result.ok.length > 0) {
                return {
                    ok: new GrantedAccess({
                        agent: this.agent,
                        proofs: result.ok
                    })
                };
            }
            await new Promise((resolve)=>setTimeout(resolve, interval));
        }
        return {
            error: Object.assign(new Error('Aborted'), {
                reason: signal.reason
            })
        };
    }
}
/**
 * Error returned when pending access request expires.
 */ class RequestExpired extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Failure"] {
    /**
     * @param {PendingAccessRequestModel} model
     */ constructor(model){
        super();
        this.model = model;
    }
    get name() {
        return 'RequestExpired';
    }
    get request() {
        return this.model.request;
    }
    get expiredAt() {
        return new Date(this.model.expiration * 1000);
    }
    describe() {
        return `Access request expired at ${this.expiredAt} for ${this.request} request.`;
    }
}
class GrantedAccess {
    /**
     * @typedef {object} GrantedAccessModel
     * @property {API.Agent} agent - Agent that processed the request.
     * @property {API.Tuple<API.Delegation>} proofs - Delegations that grant access.
     *
     * @param {GrantedAccessModel} model
     */ constructor(model){
        this.model = model;
    }
    get proofs() {
        return this.model.proofs;
    }
    /**
     * Saves access into the agents proofs store so that it can be retained
     * between sessions.
     *
     * @param {object} input
     * @param {API.Agent} [input.agent]
     */ save({ agent = this.model.agent } = {}) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["importAuthorization"])(agent, this);
    }
}
/**
 * Checks if the given delegation is caused by the passed `request` for access.
 *
 * @param {API.Delegation} delegation
 * @param {object} selector
 * @param {API.Link} selector.request
 * @returns
 */ const isRequestedAccess = (delegation, { request })=>// `access/confirm` handler adds facts to the delegation issued by the account
    // so that principal requesting access can identify correct delegation when
    // access is granted.
    delegation.facts.some((fact)=>`${fact['access/request']}` === `${request}`);
const toCapabilities = (access)=>{
    const abilities = [];
    const entries = Object.entries(access);
    for (const [can, details] of entries){
        if (details) {
            abilities.push({
                can
            });
        }
    }
    return abilities;
};
const spaceAccess = {
    'assert/*': {},
    'space/*': {},
    'blob/*': {},
    'index/*': {},
    'store/*': {},
    'upload/*': {},
    'access/*': {},
    'filecoin/*': {},
    'usage/*': {}
};
const accountAccess = {
    '*': {}
}; //# sourceMappingURL=access.js.map
}),
"[project]/node_modules/@storacha/access/dist/provider.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "AccountDID",
    ()=>AccountDID,
    "ProviderDID",
    ()=>ProviderDID,
    "add",
    ()=>add
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$types$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/types.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$provider$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/provider.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$provider$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/provider.js [app-ssr] (ecmascript)");
;
;
const { Provider: ProviderDID, AccountDID } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$provider$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__;
const add = async (agent, { account, consumer, provider = agent.connection.id.did(), proofs })=>{
    if (!ProviderDID.is(provider)) {
        throw new Error(`Unable to determine provider from agent.connection.id did ${provider}. expected a did:web:`);
    }
    const { out } = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$provider$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__.add, {
        with: account,
        nb: {
            provider,
            consumer
        },
        proofs
    });
    return out;
}; //# sourceMappingURL=provider.js.map
}),
"[project]/node_modules/@storacha/access/dist/space-access.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "SpaceAccess",
    ()=>SpaceAccess
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$types$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/types.js [app-ssr] (ecmascript) <locals>");
;
/**
 * Known valid provider/algorithm combinations
 *
 * @type {Record<string, string[]>}
 */ const VALID_COMBINATIONS = {
    'google-kms': [
        'RSA_DECRYPT_OAEP_3072_SHA256'
    ]
};
class SpaceAccess {
    /**
     * Creates and validates a space access configuration
     *
     * @template {API.SpaceAccessType} T
     * @param {T} [access] - The access configuration to validate
     * @returns {T}
     * @throws {Error} When access configuration is invalid
     */ static from(access) {
        if (!access || access.type === 'public') {
            return {
                type: 'public'
            };
        }
        if (access.type === 'private') {
            if (!access.encryption) {
                throw new Error('Private access type requires encryption configuration');
            }
            const { provider, algorithm } = access.encryption;
            if (!VALID_COMBINATIONS[provider]) {
                throw new Error(`unknown encryption provider: ${provider}`);
            }
            if (!VALID_COMBINATIONS[provider].includes(algorithm)) {
                throw new Error(`unknown encryption algorithm: ${algorithm} for provider: ${provider}`);
            }
            return access;
        }
        throw new Error(`unknown access type: ${/** @type {any} */ access.type}`);
    }
    /**
     * Creates a public space access configuration
     *
     * @returns {API.PublicAccess}
     */ static public() {
        return {
            type: 'public'
        };
    }
    /**
     * Creates a private space access configuration with encryption provider
     *
     * @param {string} [provider] - The encryption provider. Defaults to `google-kms`.
     * @param {string} [algorithm] - The encryption algorithm. Defaults to `RSA_DECRYPT_OAEP_3072_SHA256`.
     * @returns {API.PrivateAccess<API.EncryptionProvider>}
     * @throws {Error} When provider/algorithm combination is invalid
     */ static private(provider = 'google-kms', algorithm = 'RSA_DECRYPT_OAEP_3072_SHA256') {
        if (!VALID_COMBINATIONS[provider]) {
            throw new Error(`unknown encryption provider: ${provider}`);
        }
        if (!VALID_COMBINATIONS[provider].includes(algorithm)) {
            throw new Error(`unknown encryption algorithm: ${algorithm} for provider: ${provider}`);
        }
        return {
            type: 'private',
            encryption: {
                provider,
                algorithm
            }
        };
    }
} //# sourceMappingURL=space-access.js.map
}),
"[project]/node_modules/@storacha/access/dist/space.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "OwnedSpace",
    ()=>OwnedSpace,
    "SESSION_LIFETIME",
    ()=>SESSION_LIFETIME,
    "SharedSpace",
    ()=>SharedSpace,
    "createAuthorization",
    ()=>createAuthorization,
    "createRecovery",
    ()=>createRecovery,
    "fromDelegation",
    ()=>fromDelegation,
    "fromMnemonic",
    ()=>fromMnemonic,
    "generate",
    ()=>generate,
    "provision",
    ()=>provision,
    "toMnemonic",
    ()=>toMnemonic
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/signer.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/schema.js [app-ssr] (ecmascript) <export * as Schema>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__UCAN$3e$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/lib.js [app-ssr] (ecmascript) <export * as UCAN>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/result.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__DID$3e$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/did.js [app-ssr] (ecmascript) <export * as DID>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$scure$2f$bip39$2f$esm$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@scure/bip39/esm/index.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$scure$2f$bip39$2f$esm$2f$wordlists$2f$english$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@scure/bip39/esm/wordlists/english.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$types$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/types.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/access.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$provider$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/provider.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2d$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/space-access.js [app-ssr] (ecmascript)");
;
;
;
;
;
;
;
;
const generate = async ({ name, access, agent })=>{
    const { signer } = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["generate"]();
    const normalizedAccess = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2d$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["SpaceAccess"].from(access);
    return new OwnedSpace({
        signer,
        name,
        access: normalizedAccess,
        agent
    });
};
const fromMnemonic = async (mnemonic, { name, access, agent })=>{
    // TODO: Improve recovery UX by auto-detecting access type from existing space metadata
    // or storing access type with space mnemonic. Should default to public if mnemonic
    // doesn't contain access type information.
    const secret = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$scure$2f$bip39$2f$esm$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["mnemonicToEntropy"](mnemonic, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$scure$2f$bip39$2f$esm$2f$wordlists$2f$english$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["wordlist"]);
    const signer = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["derive"](secret);
    const normalizedAccess = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2d$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["SpaceAccess"].from(access);
    return new OwnedSpace({
        signer,
        name,
        access: normalizedAccess,
        agent
    });
};
const toMnemonic = ({ signer })=>{
    /** @type {Uint8Array} */ // @ts-expect-error - Field is defined but not in the interface
    const secret = signer.secret;
    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$scure$2f$bip39$2f$esm$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["entropyToMnemonic"](secret, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$scure$2f$bip39$2f$esm$2f$wordlists$2f$english$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["wordlist"]);
};
const createRecovery = (space, account)=>createAuthorization(space, {
        audience: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__DID$3e$__["DID"].parse(account),
        access: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["accountAccess"],
        expiration: Infinity
    });
const SESSION_LIFETIME = 60 * 60 * 24 * 365;
const createAuthorization = async ({ signer, name, access }, { audience, access: spaceAccess = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["spaceAccess"], expiration = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__UCAN$3e$__["UCAN"].now() + SESSION_LIFETIME })=>{
    const normalizedAccess = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2d$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["SpaceAccess"].from(access);
    const facts = [
        {
            space: {
                name,
                access: normalizedAccess
            }
        }
    ];
    return await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["delegate"])({
        issuer: signer,
        audience: audience,
        capabilities: toCapabilities({
            [signer.did()]: spaceAccess
        }),
        ...expiration ? {
            expiration
        } : {},
        facts
    });
};
/**
 * @param {Record<API.Resource, API.Access>} allow
 * @returns {API.Capabilities}
 */ const toCapabilities = (allow)=>{
    const capabilities = [];
    for (const [subject, access] of Object.entries(allow)){
        const entries = Object.entries(access);
        for (const [can, details] of entries){
            if (details) {
                capabilities.push({
                    can,
                    with: subject
                });
            }
        }
    }
    return capabilities;
};
class OwnedSpace {
    /**
     * @param {Model<S>} model
     */ constructor(model){
        this.model = model;
    }
    get signer() {
        return this.model.signer;
    }
    get name() {
        return this.model.name;
    }
    get access() {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2d$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["SpaceAccess"].from(this.model.access);
    }
    did() {
        return this.signer.did();
    }
    /**
     * Creates a renamed version of this space.
     *
     * @param {string} name
     */ withName(name) {
        return new OwnedSpace({
            signer: this.signer,
            name,
            access: this.access
        });
    }
    /**
     * Saves account in the agent store so it can be accessed across sessions.
     *
     * @param {object} input
     * @param {API.Agent<S>} [input.agent]
     * @returns {Promise<API.Result<API.Unit, Error>>}
     */ async save({ agent = this.model.agent } = {}) {
        if (!agent) {
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["fail"])('Please provide an agent to save the space into');
        }
        const proof = await createAuthorization(this, {
            audience: agent
        });
        await agent.importSpaceFromDelegation(proof);
        await agent.setCurrentSpace(this.did());
        return {
            ok: {}
        };
    }
    /**
     * @param {Authorization} authorization
     * @param {object} options
     * @param {API.Agent<S>} [options.agent]
     */ provision({ proofs }, { agent = this.model.agent } = {}) {
        if (!agent) {
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["fail"])('Please provide an agent to save the space into');
        }
        return provision(this, {
            proofs,
            agent
        });
    }
    /**
     * Creates a (UCAN) delegation that gives full access to the space to the
     * specified `account`. At the moment we only allow `did:mailto` principal
     * to be used as an `account`.
     *
     * @param {API.AccountDID} account
     */ async createRecovery(account) {
        return createRecovery(this, account);
    }
    /**
     * Creates (UCAN) delegation that gives specified `agent` an access to
     * specified ability (passed as `access.can` field) on the this space.
     * Optionally, you can specify `access.expiration` field to set the
     *
     * @param {API.Principal} principal
     * @param {object} [input]
     * @param {API.Access} [input.access]
     * @param {API.UCAN.UTCUnixTimestamp} [input.expiration]
     */ createAuthorization(principal, input) {
        return createAuthorization(this, {
            ...input,
            audience: principal
        });
    }
    /**
     * Derives BIP39 mnemonic that can be used to recover the space.
     *
     * @returns {string}
     */ toMnemonic() {
        return toMnemonic(this);
    }
}
const SpaceDID = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].did({
    method: 'key'
});
const fromDelegation = (delegation)=>{
    const result = SpaceDID.read(delegation.capabilities[0].with);
    if (result.error) {
        throw Object.assign(new Error(`Invalid delegation, expected capabilities[0].with to be DID, ${result.error}`), {
            cause: result.error
        });
    }
    /** @type {{name?:string, access?:API.SpaceAccessType}} */ const meta = delegation.facts[0]?.space ?? {};
    // Ensure access defaults to public for backwards compatibility
    meta.access = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2d$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["SpaceAccess"].from(meta.access);
    return new SharedSpace({
        id: result.ok,
        delegation,
        meta
    });
};
const provision = async (space, { proofs, agent })=>{
    const [capability] = proofs[0].capabilities;
    const { ok: account, error: reason } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$provider$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["AccountDID"].read(capability.with);
    if (reason) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["error"])(reason);
    }
    return await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$provider$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["add"](agent, {
        consumer: space.did(),
        account,
        proofs
    });
};
class SharedSpace {
    /**
     * @typedef {object} SharedSpaceModel
     * @property {API.SpaceDID} id
     * @property {API.Delegation} delegation
     * @property {{name?:string, access?:API.SpaceAccessType}} meta
     * @property {API.Agent} [agent]
     *
     * @param {SharedSpaceModel} model
     */ constructor(model){
        this.model = model;
    }
    get delegation() {
        return this.model.delegation;
    }
    get meta() {
        return this.model.meta;
    }
    get name() {
        return this.meta.name ?? '';
    }
    get access() {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2d$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["SpaceAccess"].from(this.meta.access);
    }
    did() {
        return this.model.id;
    }
    /**
     * @param {string} name
     */ withName(name) {
        return new SharedSpace({
            ...this.model,
            meta: {
                ...this.meta,
                name,
                access: this.access
            }
        });
    }
} //# sourceMappingURL=space.js.map
}),
"[project]/node_modules/@storacha/access/dist/delegations.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "canDelegateCapability",
    ()=>canDelegateCapability,
    "isExpired",
    ()=>isExpired,
    "isTooEarly",
    ()=>isTooEarly,
    "matchResource",
    ()=>matchResource,
    "validate",
    ()=>validate
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Delegation$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-ssr] (ecmascript) <export * as Delegation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$types$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/types.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$utils$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/utils.js [app-ssr] (ecmascript)");
;
;
;
function isExpired(delegation) {
    if (delegation.expiration === undefined || delegation.expiration <= Math.floor(Date.now() / 1000)) {
        return true;
    }
    return false;
}
function isTooEarly(delegation) {
    if (!delegation.notBefore) {
        return false;
    }
    return delegation.notBefore > Math.floor(Date.now() / 1000);
}
function validate(delegation, opts) {
    const { checkAudience, checkIsExpired = true, checkIsTooEarly = true } = opts ?? {};
    if (checkAudience && delegation.audience.did() !== checkAudience.did()) {
        throw new Error(`Delegation audience ${delegation.audience.did()} does not match required DID ${checkAudience.did()}`);
    }
    if (checkIsExpired && isExpired(delegation)) {
        throw new Error(`Delegation expired.`);
    }
    if (checkIsTooEarly && isTooEarly(delegation)) {
        throw new Error(`Delegation is not active yet (too early).`);
    }
}
function canDelegateCapability(delegation, capability) {
    const allowsCapabilities = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Delegation$3e$__["Delegation"].allows(delegation);
    for (const [uri, abilities] of Object.entries(allowsCapabilities)){
        if (matchResource(uri, capability.with)) {
            const cans = Object.keys(abilities);
            for (const can of cans){
                if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$utils$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["canDelegateAbility"])(can, capability.can)) {
                    return true;
                }
            }
        }
    }
    return false;
}
const matchResource = (resource, query)=>{
    if (query === 'ucan:*') {
        return true;
    } else if (typeof query === 'string') {
        return resource === query;
    } else {
        return query.test(resource);
    }
}; //# sourceMappingURL=delegations.js.map
}),
"[project]/node_modules/@storacha/access/dist/utils/buffers.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * Convert a Uint8Array to an ArrayBuffer, taking into account
 * that we may be looking at a "data view".
 * thanks, https://stackoverflow.com/a/54646864
 *
 * If we aren't looking at a data view, simply returns the underlying ArrayBuffer
 * directly.
 *
 * @param {Uint8Array} array
 * @returns ArrayBuffer
 */ __turbopack_context__.s([
    "uint8ArrayToArrayBuffer",
    ()=>uint8ArrayToArrayBuffer
]);
function uint8ArrayToArrayBuffer(array) {
    if (array.byteOffset === 0 && array.byteLength === array.buffer.byteLength) {
        return array.buffer;
    } else {
        return array.buffer.slice(array.byteOffset, array.byteLength + array.byteOffset);
    }
} //# sourceMappingURL=buffers.js.map
}),
"[project]/node_modules/@storacha/access/dist/agent-data.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "AgentData",
    ()=>AgentData,
    "getSessionProofs",
    ()=>getSessionProofs,
    "isSessionProof",
    ()=>isSessionProof
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Signer$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/signer.js [app-ssr] (ecmascript) <export * as Signer>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/index.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$cid$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/cid.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$ucan$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__UCAN$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/ucan.js [app-ssr] (ecmascript) <export * as UCAN>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$delegations$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/delegations.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$utils$2f$buffers$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/utils/buffers.js [app-ssr] (ecmascript)");
;
;
;
;
;
;
;
;
class AgentData {
    /** @type {(data: import('./types.js').AgentDataExport) => Promise<void> | void} */ #save;
    /**
     * @param {import('./types.js').AgentDataModel} data
     * @param {import('./types.js').AgentDataOptions} [options]
     */ constructor(data, options = {}){
        this.meta = data.meta;
        this.principal = data.principal;
        this.spaces = data.spaces;
        this.delegations = data.delegations;
        this.currentSpace = data.currentSpace;
        this.#save = (data)=>options.store ? options.store.save(data) : undefined;
    }
    /**
     * Create a new AgentData instance from the passed initialization data.
     *
     * @param {Partial<import('./types.js').AgentDataModel>} [init]
     * @param {import('./types.js').AgentDataOptions} [options]
     */ static async create(init = {}, options = {}) {
        const agentData = new AgentData({
            meta: {
                name: 'agent',
                type: 'device',
                ...init.meta
            },
            principal: init.principal ?? await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Signer$3e$__["Signer"].generate(),
            spaces: init.spaces ?? new Map(),
            delegations: init.delegations ?? new Map(),
            currentSpace: init.currentSpace
        }, options);
        if (options.store) {
            await options.store.save(agentData.export());
        }
        return agentData;
    }
    /**
     * Instantiate AgentData from previously exported data.
     *
     * @param {import('./types.js').AgentDataExport} raw
     * @param {import('./types.js').AgentDataOptions} [options]
     */ static fromExport(raw, options) {
        /** @type {import('./types.js').AgentDataModel['delegations']} */ const dels = new Map();
        for (const [key, value] of raw.delegations){
            dels.set(key, {
                delegation: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["importDAG"])(value.delegation.map((d)=>({
                        cid: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$cid$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["CID"].parse(d.cid).toV1(),
                        bytes: d.bytes instanceof Uint8Array ? d.bytes : new Uint8Array(d.bytes)
                    }))),
                meta: value.meta
            });
        }
        return new AgentData({
            meta: raw.meta,
            // @ts-expect-error for some reason TS thinks this is a EdSigner
            principal: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["Signer"].from(raw.principal),
            currentSpace: raw.currentSpace,
            spaces: raw.spaces,
            delegations: dels
        }, options);
    }
    /**
     * Export data in a format safe to pass to `structuredClone()`.
     */ export() {
        /** @type {import('./types.js').AgentDataExport} */ const raw = {
            meta: this.meta,
            principal: this.principal.toArchive(),
            currentSpace: this.currentSpace,
            spaces: this.spaces,
            delegations: new Map()
        };
        for (const [key, value] of this.delegations){
            raw.delegations.set(key, {
                meta: value.meta,
                delegation: [
                    ...value.delegation.export()
                ].map((b)=>({
                        cid: b.cid.toString(),
                        bytes: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$utils$2f$buffers$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["uint8ArrayToArrayBuffer"])(b.bytes)
                    }))
            });
        }
        return raw;
    }
    /**
     * @param {import('@ucanto/interface').DID} did
     * @param {import('./types.js').SpaceMeta} meta
     * @param {import('@ucanto/interface').Delegation} [proof]
     */ async addSpace(did, meta, proof) {
        this.spaces.set(did, meta);
        await (proof ? this.addDelegation(proof) : this.#save(this.export()));
    }
    /**
     * @deprecated
     * @param {import('@ucanto/interface').DID<'key'>} did
     */ async setCurrentSpace(did) {
        this.currentSpace = did;
        await this.#save(this.export());
    }
    /**
     * @param {import('@ucanto/interface').Delegation} delegation
     * @param {import('./types.js').DelegationMeta} [meta]
     */ async addDelegation(delegation, meta) {
        this.delegations.set(delegation.cid.toString(), {
            delegation,
            meta: meta ?? {}
        });
        await this.#save(this.export());
    }
    /**
     * @param {import('@ucanto/interface').UCANLink} cid
     */ async removeDelegation(cid) {
        this.delegations.delete(cid.toString());
        await this.#save(this.export());
    }
}
/**
 * Is the given capability a session attestation?
 *
 * @param {Ucanto.Capability} cap
 * @returns {boolean}
 */ const isSessionCapability = (cap)=>cap.can === __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$ucan$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__UCAN$3e$__["UCAN"].attest.can;
const isSessionProof = (delegation)=>delegation.capabilities.some((cap)=>isSessionCapability(cap));
function getSessionProofs(data) {
    /** @type {SessionProofIndexedByAuthorizationAndIssuer} */ const proofs = {};
    for (const { delegation } of data.delegations.values()){
        if (isSessionProof(delegation)) {
            const cap = delegation.capabilities[0];
            if (cap && !(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$delegations$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["isExpired"])(delegation)) {
                const proof = cap.nb.proof;
                if (proof) {
                    const proofCid = proof.toString();
                    const issuerDid = delegation.issuer.did();
                    proofs[proofCid] = proofs[proofCid] ?? {};
                    proofs[proofCid][issuerDid] = proofs[proofCid][issuerDid] ?? [];
                    proofs[proofCid][issuerDid].push(delegation);
                }
            }
        }
    }
    return proofs;
} //# sourceMappingURL=agent-data.js.map
}),
"[project]/node_modules/@storacha/access/dist/agent-use-cases.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "addProvider",
    ()=>addProvider,
    "addProviderAndDelegateToAccount",
    ()=>addProviderAndDelegateToAccount,
    "authorizeAndWait",
    ()=>authorizeAndWait,
    "authorizeWaitAndClaim",
    ()=>authorizeWaitAndClaim,
    "claimAccess",
    ()=>claimAccess,
    "delegationsIncludeSessionProof",
    ()=>delegationsIncludeSessionProof,
    "getAccountPlan",
    ()=>getAccountPlan,
    "pollAccessClaimUntil",
    ()=>pollAccessClaimUntil,
    "requestAccess",
    ()=>requestAccess,
    "waitForAuthorizationByPolling",
    ()=>waitForAuthorizationByPolling
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/agent.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/access.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$encoding$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/encoding.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$provider$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Provider$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/provider.js [app-ssr] (ecmascript) <export * as Provider>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$plan$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Plan$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/plan.js [app-ssr] (ecmascript) <export * as Plan>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Access$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/access.js [app-ssr] (ecmascript) <export * as Access>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/schema.js [app-ssr] (ecmascript) <export * as Schema>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2d$data$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/agent-data.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/did-mailto/dist/index.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$types$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/types.js [app-ssr] (ecmascript) <locals>");
;
;
;
;
;
;
;
;
;
const DIDWeb = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].DID.match({
    method: 'web'
});
async function requestAccess(access, account, capabilities) {
    const res = await access.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["authorize"], {
        audience: access.connection.id,
        with: access.issuer.did(),
        nb: {
            iss: account.did(),
            att: [
                ...capabilities
            ]
        }
    });
    if (res?.out.error) {
        throw res.out.error;
    }
}
async function claimAccess(access, audienceOfClaimedDelegations = access.connection.id.did(), { addProofs = false, nonce } = {}) {
    const res = await access.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["claim"], {
        audience: access.connection.id,
        with: audienceOfClaimedDelegations,
        nonce
    });
    if (res.out.error) {
        throw res.out.error;
    }
    const delegations = Object.values(res.out.ok.delegations).flatMap((bytes)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$encoding$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["bytesToDelegations"])(bytes));
    if (addProofs) {
        for (const d of delegations){
            await access.addProof(d);
        }
        await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["addSpacesFromDelegations"])(access, delegations);
    }
    return delegations;
}
async function addProvider({ access, space, account, provider }) {
    const result = await access.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$provider$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Provider$3e$__["Provider"].add, {
        audience: access.connection.id,
        with: account.did(),
        nb: {
            provider,
            consumer: space
        }
    });
    if (result.out.error) {
        throw result.out.error;
    }
}
function delegationsIncludeSessionProof(delegations) {
    return delegations.some((d)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2d$data$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["isSessionProof"])(d));
}
async function pollAccessClaimUntil(delegationsMatch, access, delegee, opts) {
    const interval = opts?.interval || 250;
    // eslint-disable-next-line no-constant-condition
    while(true){
        if (opts?.signal?.aborted) throw opts.signal.reason ?? new Error('operation aborted');
        const res = await access.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Access$3e$__["Access"].claim, {
            with: delegee
        });
        if (res.out.error) throw res.out.error;
        const claims = Object.values(res.out.ok.delegations).flatMap((d)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$encoding$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["bytesToDelegations"])(d));
        if (delegationsMatch(claims)) return claims;
        await new Promise((resolve)=>setTimeout(resolve, interval));
    }
}
async function waitForAuthorizationByPolling(access, opts = {}) {
    const claimed = await pollAccessClaimUntil(delegationsIncludeSessionProof, access, access.issuer.did(), {
        signal: opts?.signal,
        interval: opts?.interval
    });
    return [
        ...claimed
    ];
}
async function authorizeAndWait(access, email, opts = {}) {
    const expectAuthorization = opts.expectAuthorization || waitForAuthorizationByPolling;
    const account = {
        did: ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["fromEmail"](email)
    };
    await requestAccess(access, account, opts?.capabilities || [
        {
            can: 'assert/*'
        },
        {
            can: 'space/*'
        },
        {
            can: 'store/*'
        },
        {
            can: 'provider/add'
        },
        {
            can: 'subscription/list'
        },
        {
            can: 'upload/*'
        },
        {
            can: 'ucan/*'
        },
        {
            can: 'plan/*'
        },
        {
            can: 'usage/*'
        },
        {
            can: 'w3up/*'
        }
    ]);
    const sessionDelegations = [
        ...await expectAuthorization(access, opts)
    ];
    if (!opts?.dontAddProofs) {
        await Promise.all(sessionDelegations.map(async (d)=>access.addProof(d)));
    }
}
async function authorizeWaitAndClaim(accessAgent, email, opts) {
    await authorizeAndWait(accessAgent, email, opts);
    await claimAccess(accessAgent, accessAgent.issuer.did(), {
        addProofs: opts?.addProofs ?? true
    });
}
async function addProviderAndDelegateToAccount(access, agentData, email, opts) {
    const space = opts?.space || access.currentSpace();
    const spaceMeta = space ? agentData.spaces.get(space) : undefined;
    const provider = opts?.provider || (()=>{
        const service = access.connection.id.did();
        if (DIDWeb.is(service)) {
            // connection.id did is a valid provider value. Try using that.
            return service;
        }
        throw new Error(`unable to determine provider to use to addProviderAndDelegateToAccount using access.connection.id did ${service}. expected a did:web:`);
    })();
    if (!space || !spaceMeta) {
        throw new Error('No space selected');
    }
    if (spaceMeta) {
        throw new Error('Space already registered with storacha.network.');
    }
    const account = {
        did: ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["fromEmail"](__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["email"](email))
    };
    await addProvider({
        access,
        space,
        account,
        provider
    });
    const delegateSpaceAccessResult = await delegateSpaceAccessToAccount(access, space, account);
    if (delegateSpaceAccessResult.out.error) {
        throw delegateSpaceAccessResult.out.error;
    }
    await agentData.addSpace(space, spaceMeta);
}
/**
 * @param {AccessAgent} access
 * @param {API.SpaceDID} space
 * @param {API.Principal<API.AccountDID>} account
 */ async function delegateSpaceAccessToAccount(access, space, account) {
    const issuerSaysAccountCanAdminSpace = await createIssuerSaysAccountCanAdminSpace(access.issuer, space, account, undefined, access.proofs([
        {
            with: space,
            can: '*'
        }
    ]), // we want to sign over control of this space forever
    Infinity);
    return access.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["delegate"], {
        audience: access.connection.id,
        with: space,
        expiration: Infinity,
        nb: {
            delegations: {
                [issuerSaysAccountCanAdminSpace.cid.toString()]: issuerSaysAccountCanAdminSpace.cid
            }
        },
        proofs: [
            // must be embedded here because it's referenced by cid in .nb.delegations
            issuerSaysAccountCanAdminSpace
        ]
    });
}
/**
 * @param {API.Signer<API.DIDKey>} issuer
 * @param {API.SpaceDID} space
 * @param {API.Principal<API.AccountDID>} account
 * @param {API.Capabilities} capabilities
 * @param {API.Delegation[]} proofs
 * @param {number} expiration
 * @returns
 */ async function createIssuerSaysAccountCanAdminSpace(issuer, space, account, capabilities = [
    {
        can: '*',
        with: space
    }
], proofs = [], expiration) {
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["delegate"])({
        issuer,
        audience: account,
        capabilities,
        proofs,
        expiration
    });
}
async function getAccountPlan(agent, account) {
    const receipt = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$plan$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Plan$3e$__["Plan"].get, {
        with: account
    });
    return receipt.out;
} //# sourceMappingURL=agent-use-cases.js.map
}),
"[project]/node_modules/@storacha/access/dist/agent.js [app-ssr] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Agent",
    ()=>Agent,
    "addSpacesFromDelegations",
    ()=>addSpacesFromDelegations,
    "connection",
    ()=>connection,
    "importAuthorization",
    ()=>importAuthorization
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/connection.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/http.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Delegation$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-ssr] (ecmascript) <export * as Delegation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/space.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$ucan$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/ucan.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/access.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/space.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$invocation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/invocation.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__DID$3e$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/did.js [app-ssr] (ecmascript) <export * as DID>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/schema.js [app-ssr] (ecmascript) <export * as Schema>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$delegations$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/delegations.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2d$data$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/agent-data.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$ucan$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__UCAN$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/ucan.js [app-ssr] (ecmascript) <export * as UCAN>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$types$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/types.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2d$use$2d$cases$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/agent-use-cases.js [app-ssr] (ecmascript)");
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
const HOST = 'https://up.storacha.network';
const PRINCIPAL = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__DID$3e$__["DID"].parse('did:web:up.storacha.network');
/**
 * Default identities for the service, including the primary identity.
 *
 * @type {API.DID[]}
 */ const IDENTITIES = [
    PRINCIPAL.did(),
    'did:web:web3.storage'
];
/**
 * Keeps track of AgentData for all Agents constructed.
 * Used by addSpacesFromDelegations - so it can only accept Agent as param, but
 * still mutate corresponding AgentData
 *
 * @deprecated - remove this when deprecated addSpacesFromDelegations is removed
 */ /** @type {WeakMap<Agent<Record<string, any>>, AgentData>} */ const agentToData = new WeakMap();
function connection(options = {}) {
    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["connect"]({
        id: options.principal ?? PRINCIPAL,
        codec: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["outbound"],
        channel: options.channel ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["open"]({
            url: options.url ?? new URL(HOST),
            method: 'POST',
            fetch: options.fetch ?? globalThis.fetch.bind(globalThis)
        })
    });
}
class Agent {
    /** @type {import('./agent-data.js').AgentData} */ #data;
    /**
     * DIDs the service is known by, including the primary. They are used by
     * `invoke` and `invokeAndExecute` to scope session proofs to just the service
     * DID or it's aliases.
     *
     * @type {Set<API.DID>}
     */ #serviceIdentities;
    /**
     * @param {import('./agent-data.js').AgentData} data - Agent data
     * @param {import('./types.js').AgentOptions<S>} [options]
     */ constructor(data, options = {}){
        /** @type { Client.Channel<S> & { url?: URL } | undefined } */ const channel = options.connection?.channel;
        this.url = options.url ?? channel?.url ?? new URL(HOST);
        this.connection = options.connection ?? connection({
            principal: options.servicePrincipal,
            url: this.url
        });
        this.#data = data;
        agentToData.set(this, this.#data);
        const primary = this.connection.id;
        const serviceIdentities = new Set(options.serviceIdentities);
        // If the default identities includes the configured primary identity then
        // add them to the service identities list.
        if (IDENTITIES.includes(primary.did())) {
            for (const id of IDENTITIES){
                serviceIdentities.add(id);
            }
        }
        // Add the primary identity if not already in service identities.
        if (!serviceIdentities.has(primary.did())) {
            serviceIdentities.add(primary.did());
        }
        this.#serviceIdentities = serviceIdentities;
    }
    /**
     * Create a new Agent instance, optionally with the passed initialization data.
     *
     * @template {Record<string, any>} [R=Service]
     * @param {Partial<import('./types.js').AgentDataModel>} [init]
     * @param {import('./types.js').AgentOptions<R> & import('./types.js').AgentDataOptions} [options]
     */ static async create(init, options = {}) {
        const data = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2d$data$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["AgentData"].create(init, options);
        return new Agent(data, options);
    }
    /**
     * Instantiate an Agent from pre-exported agent data.
     *
     * @template {Record<string, any>} [R=Service]
     * @param {import('./types.js').AgentDataExport} raw
     * @param {import('./types.js').AgentOptions<R> & import('./types.js').AgentDataOptions} [options]
     */ static from(raw, options = {}) {
        const data = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2d$data$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["AgentData"].fromExport(raw, options);
        return new Agent(data, options);
    }
    get issuer() {
        return this.#data.principal;
    }
    get meta() {
        return this.#data.meta;
    }
    get spaces() {
        return this.#data.spaces;
    }
    did() {
        return this.#data.principal.did();
    }
    /**
     * Add a proof to the agent store.
     *
     * @param {API.Delegation} delegation
     */ async addProof(delegation) {
        return await this.addProofs([
            delegation
        ]);
    }
    /**
     * Adds set of proofs to the agent store.
     *
     * @param {Iterable<API.Delegation>} delegations
     */ async addProofs(delegations) {
        for (const proof of delegations){
            await this.#data.addDelegation(proof, {
                audience: this.meta
            });
        }
        await this.removeExpiredDelegations();
        return {};
    }
    /**
     * Query the delegations store for all the delegations matching the capabilities provided.
     *
     * @param {API.CapabilityQuery[]} [caps]
     */ #delegations(caps) {
        const _caps = new Set(caps);
        /** @type {Array<{ delegation: API.Delegation, meta: API.DelegationMeta }>} */ const values = [];
        for (const [, value] of this.#data.delegations){
            // check expiration
            if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$delegations$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["isExpired"])(value.delegation) && // check if delegation can be used
            !(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$delegations$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["isTooEarly"])(value.delegation)) {
                // check if we need to filter for caps
                if (Array.isArray(caps) && caps.length > 0) {
                    for (const cap of _caps){
                        if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$delegations$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["canDelegateCapability"])(value.delegation, cap)) {
                            values.push(value);
                        }
                    }
                } else {
                    values.push(value);
                }
            }
        }
        return values;
    }
    /**
     * Clean up any expired delegations.
     */ async removeExpiredDelegations() {
        for (const [, value] of this.#data.delegations){
            if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$delegations$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["isExpired"])(value.delegation)) {
                await this.#data.removeDelegation(value.delegation.cid);
            }
        }
    }
    /**
     * Revoke a delegation by CID.
     *
     * If the delegation was issued by this agent (and therefore is stored in the
     * delegation store) you can just pass the CID. If not, or if the current agent's
     * delegation store no longer contains the delegation, you MUST pass a chain of
     * proofs that proves your authority to revoke this delegation as `options.proofs`.
     *
     * @param {API.UCANLink} delegationCID
     * @param {object} [options]
     * @param {API.Delegation[]} [options.proofs]
     */ async revoke(delegationCID, options = {}) {
        const additionalProofs = options.proofs ?? [];
        // look for the identified delegation in the delegation store and the passed proofs
        const delegation = [
            ...this.delegations(),
            ...additionalProofs
        ].find((delegation)=>delegation.cid.equals(delegationCID));
        if (!delegation) {
            return {
                error: new Error(`could not find delegation ${delegationCID.toString()} - please include the delegation in options.proofs`)
            };
        }
        const receipt = await this.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$ucan$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__UCAN$3e$__["UCAN"].revoke, {
            // per https://github.com/storacha/upload-service/blob/main/packages/capabilities/src/ucan.js#L38C6-L38C6 the resource here should be
            // the current issuer - using the space DID here works for simple cases but falls apart when a delegee tries to revoke a delegation
            // they have re-delegated, since they don't have "ucan/revoke" capabilities on the space
            with: this.issuer.did(),
            nb: {
                ucan: delegation.cid
            },
            proofs: [
                delegation,
                ...additionalProofs
            ]
        });
        return receipt.out;
    }
    /**
     * Get all the proofs matching the capabilities.
     *
     * Proofs are delegations with an audience matching agent DID, or with an
     * audience matching the session DID.
     *
     * Proof of session will also be included in the returned proofs if any
     * proofs matching the passed capabilities require it.
     *
     * @param {API.CapabilityQuery[]} [caps] - Capabilities to filter by. Empty or undefined caps with return all the proofs.
     * @param {object} [options]
     * @param {API.DID|API.DID[]} [options.sessionProofIssuer] - only include session proofs for these issuer(s)
     */ proofs(caps, options) {
        /** @type {Map<string, API.Delegation<API.Capabilities>>} */ const authorizations = new Map();
        for (const { delegation } of this.#delegations(caps)){
            if (delegation.audience.did() === this.issuer.did()) {
                authorizations.set(delegation.cid.toString(), delegation);
            }
        }
        /** @type {Set<API.DID>} */ const sessionProofIssuers = new Set();
        if (options?.sessionProofIssuer) {
            const ids = Array.isArray(options.sessionProofIssuer) ? options.sessionProofIssuer : [
                options.sessionProofIssuer
            ];
            for (const id of ids){
                sessionProofIssuers.add(id);
            }
        }
        // now let's add any session proofs that refer to those authorizations
        const sessions = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2d$data$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["getSessionProofs"])(this.#data);
        for (const proof of [
            ...authorizations.values()
        ]){
            const proofsByIssuer = sessions[proof.asCID.toString()] ?? {};
            const sessionProofs = [];
            if (sessionProofIssuers.size > 0) {
                for (const id of sessionProofIssuers){
                    const proofs = proofsByIssuer[id];
                    if (proofs) sessionProofs.push(...proofs);
                }
            } else {
                sessionProofs.push(...Object.values(proofsByIssuer).flat());
            }
            for (const sessionProof of sessionProofs){
                authorizations.set(sessionProof.cid.toString(), sessionProof);
            }
        }
        return [
            ...authorizations.values()
        ];
    }
    /**
     * Get delegations created by the agent for others.
     *
     * @param {API.CapabilityQuery[]} [caps] - Capabilities to filter by. Empty or undefined caps with return all the delegations.
     */ delegations(caps) {
        const arr = [];
        for (const { delegation } of this.delegationsWithMeta(caps)){
            arr.push(delegation);
        }
        return arr;
    }
    /**
     * Get delegations created by the agent for others and their metadata.
     *
     * @param {API.CapabilityQuery[]} [caps] - Capabilities to filter by. Empty or undefined caps with return all the delegations.
     */ delegationsWithMeta(caps) {
        const arr = [];
        for (const value of this.#delegations(caps)){
            const { delegation } = value;
            const isSession = delegation.capabilities.some((c)=>c.can === __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$ucan$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["attest"].can);
            if (!isSession && delegation.audience.did() !== this.issuer.did()) {
                arr.push(value);
            }
        }
        return arr;
    }
    /**
     * Creates a space signer and a delegation to the agent
     *
     * @param {string} name
     * @param {object} [options]
     * @param {API.SpaceAccessType} [options.access] - The access type for the space. Defaults to { type: 'public' }.
     */ async createSpace(name, { access } = {}) {
        return await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["generate"]({
            name,
            access,
            agent: this
        });
    }
    /**
     * @param {string} secret
     * @param {object} options
     * @param {string} options.name - The name of the space.
     * @param {API.SpaceAccessType} [options.access] - The access type for the space. Defaults to { type: 'public' }.
     */ async recoverSpace(secret, { name, access }) {
        return await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["fromMnemonic"](secret, {
            name,
            access,
            agent: this
        });
    }
    /**
     * Import a space from a delegation.
     *
     * @param {API.Delegation} delegation
     * @param {object} options
     * @param {string} [options.name]
     */ async importSpaceFromDelegation(delegation, { name = '' } = {}) {
        const space = name === '' ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["fromDelegation"](delegation) : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["fromDelegation"](delegation).withName(name);
        // Store space metadata preserving all properties
        this.#data.spaces.set(space.did(), {
            ...space.meta,
            name: space.name,
            access: space.access
        });
        await this.addProof(space.delegation);
        // if we do not have a current space, make this one current
        if (!this.currentSpace()) {
            await this.setCurrentSpace(space.did());
        }
        return space;
    }
    /**
     * Sets the current selected space
     *
     * Other methods will default to use the current space if no resource is defined
     *
     * @param {API.SpaceDID} space
     */ async setCurrentSpace(space) {
        if (!this.#data.spaces.has(space)) {
            throw new Error(`Agent has no proofs for ${space}.`);
        }
        await this.#data.setCurrentSpace(space);
        return space;
    }
    /**
     * Get current space DID
     */ currentSpace() {
        return this.#data.currentSpace;
    }
    /**
     * Get current space DID, proofs and abilities
     */ currentSpaceWithMeta() {
        if (!this.#data.currentSpace) {
            return;
        }
        const proofs = this.proofs([
            {
                can: 'space/info',
                with: this.#data.currentSpace
            }
        ]);
        const caps = new Set();
        for (const p of proofs){
            for (const cap of p.capabilities){
                caps.add(cap.can);
            }
        }
        return {
            did: this.#data.currentSpace,
            proofs,
            capabilities: [
                ...caps
            ],
            meta: this.#data.spaces.get(this.#data.currentSpace)
        };
    }
    /**
     *
     * @param {import('./types.js').DelegationOptions} options
     */ async delegate(options) {
        const space = this.currentSpaceWithMeta();
        if (!space) {
            throw new Error('no space selected.');
        }
        const caps = options.abilities.map((a)=>{
            return {
                with: space.did,
                can: a
            };
        });
        // Verify agent can provide proofs for each requested capability
        for (const cap of caps){
            if (!this.proofs([
                cap
            ]).length) {
                throw new Error(`cannot delegate capability ${cap.can} with ${cap.with}`);
            }
        }
        const delegation = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["delegate"])({
            issuer: this.issuer,
            capabilities: caps,
            proofs: this.proofs(caps),
            facts: [
                {
                    space: space.meta ?? {}
                }
            ],
            ...options
        });
        await this.#data.addDelegation(delegation, {
            audience: options.audienceMeta
        });
        await this.removeExpiredDelegations();
        return delegation;
    }
    /**
     * Invoke and execute the given capability on the Access service connection
     *
     * ```js
     *
     * await agent.invokeAndExecute(Space.recover, {
     *   nb: {
     *     identity: 'mailto: email@gmail.com',
     *   },
     * })
     *
     * // sugar for
     * const recoverInvocation = await agent.invoke(Space.recover, {
     *   nb: {
     *     identity: 'mailto: email@gmail.com',
     *   },
     * })
     *
     * await recoverInvocation.execute(agent.connection)
     * ```
     *
     * @template {API.Ability} A
     * @template {API.URI} R
     * @template {API.Caveats} C
     * @param {API.TheCapabilityParser<API.CapabilityMatch<A, R, C>>} cap
     * @param {API.InvokeOptions<A, R, API.TheCapabilityParser<API.CapabilityMatch<A, R, C>>>} options
     * @returns {Promise<API.InferReceipt<API.Capability<A, R, C>, S>>}
     */ async invokeAndExecute(cap, options) {
        const inv = await this.invoke(cap, options);
        const out = inv.execute(this.connection);
        return out;
    }
    /**
     * Execute invocations on the agent's connection
     *
     * @example
     * ```js
     * const i1 = await agent.invoke(Space.info, {})
     * const i2 = await agent.invoke(Space.recover, {
     *   nb: {
     *     identity: 'mailto:hello@storacha.network',
     *   },
     * })
     *
     * const results = await agent.execute2(i1, i2)
     *
     * ```
     * @template {API.Capability} C
     * @template {API.Tuple<API.ServiceInvocation<C, S>>} I
     * @param {I} invocations
     */ execute(...invocations) {
        return this.connection.execute(...invocations);
    }
    /**
     * Creates an invocation for the given capability with Agent's proofs, service, issuer and space.
     *
     * @example
     * ```js
     * const recoverInvocation = await agent.invoke(Space.recover, {
     *   nb: {
     *     identity: 'mailto: email@gmail.com',
     *   },
     * })
     *
     * await recoverInvocation.execute(agent.connection)
     * // or
     * await agent.execute(recoverInvocation)
     * ```
     *
     * @template {API.Ability} A
     * @template {API.URI} R
     * @template {API.TheCapabilityParser<API.CapabilityMatch<A, R, C>>} CAP
     * @template {API.Caveats} [C={}]
     * @param {CAP} cap
     * @param {import('./types.js').InvokeOptions<A, R, CAP>} options
     */ async invoke(cap, options) {
        const audience = options.audience || this.connection.id;
        const space = options.with || this.currentSpace();
        if (!space) {
            throw new Error('No space or resource selected, you need pass a resource.');
        }
        const proofs = [
            ...options.proofs || [],
            ...this.proofs([
                {
                    with: space,
                    can: cap.can
                }
            ], {
                sessionProofIssuer: this.#serviceIdentities.has(audience.did()) ? [
                    ...this.#serviceIdentities
                ] : audience.did()
            })
        ];
        if (proofs.length === 0 && options.with !== this.did()) {
            throw new Error(`no proofs available for resource ${space} and ability ${cap.can}`);
        }
        const inv = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$invocation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["invoke"])({
            ...options,
            audience,
            // @ts-ignore
            capability: cap.create({
                with: space,
                nb: 'nb' in options ? options.nb : undefined
            }),
            issuer: this.issuer,
            proofs: [
                ...proofs
            ],
            nonce: options.nonce
        });
        return inv;
    }
    /**
     * Get Space information from Access service
     *
     * @param {API.URI<"did:">} [space]
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ async getSpaceInfo(space, options) {
        const _space = space || this.currentSpace();
        if (!_space) {
            throw new Error('No space selected, you need pass a resource.');
        }
        const inv = await this.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["info"], {
            ...options,
            with: _space
        });
        if (inv.out.error) {
            throw inv.out.error;
        }
        return inv.out.ok;
    }
}
async function addSpacesFromDelegations(agent, delegations) {
    const data = agentToData.get(agent);
    if (!data) {
        throw Object.assign(new Error(`cannot determine AgentData for Agent`), {
            agent: agent
        });
    }
    // spaces we find along the way.
    const spaces = new Map();
    // only consider ucans with this agent as the audience
    const ours = delegations.filter((x)=>x.audience.did() === agent.did());
    // space names are stored as facts in proofs in the special `ucan:*` delegation from email to agent.
    const ucanStars = ours.filter((x)=>x.capabilities[0].can === '*' && x.capabilities[0].with === 'ucan:*');
    for (const delegation of ucanStars){
        for (const proof of delegation.proofs){
            if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["isDelegation"])(proof) || !proof.capabilities[0].with.startsWith('did:key')) {
                continue;
            }
            const space = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["fromDelegation"](proof);
            spaces.set(space.did(), space.meta);
        }
    }
    // Find any other spaces the user may have access to
    for (const delegation of ours){
        // TODO: we need a more robust way to determine which spaces a user has access to
        // it may or may not involve look at delegations
        const allows = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Delegation$3e$__["Delegation"].allows(delegation);
        for (const [resource, value] of Object.entries(allows)){
            // If we discovered a delegation to any DID, we add it to the spaces list.
            if (resource.startsWith('did:key') && Object.keys(value).length > 0) {
                if (!spaces.has(resource)) {
                    spaces.set(resource, {});
                }
            }
        }
    }
    for (const [did, meta] of spaces){
        await data.addSpace(did, meta);
    }
}
const importAuthorization = async (agent, { proofs })=>{
    try {
        await agent.addProofs(proofs);
        await addSpacesFromDelegations(agent, proofs);
        return {
            ok: {}
        };
    } catch (error) {
        return {
            error
        };
    }
}; //# sourceMappingURL=agent.js.map
}),
"[project]/node_modules/@storacha/access/dist/utils/json.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// JSON.stringify and JSON.parse with URL, Map and Uint8Array type support.
/**
 * @param {string} k
 * @param {any} v
 */ __turbopack_context__.s([
    "parse",
    ()=>parse,
    "replacer",
    ()=>replacer,
    "reviver",
    ()=>reviver,
    "stringify",
    ()=>stringify
]);
const replacer = (k, v)=>{
    if (v instanceof URL) {
        return {
            $url: v.toString()
        };
    } else if (v instanceof Map) {
        return {
            $map: [
                ...v.entries()
            ]
        };
    } else if (v instanceof Uint8Array) {
        return {
            $bytes: [
                ...v.values()
            ]
        };
    } else if (v instanceof ArrayBuffer) {
        return {
            $bytes: [
                ...new Uint8Array(v).values()
            ]
        };
    } else if (v?.type === 'Buffer' && Array.isArray(v.data)) {
        return {
            $bytes: v.data
        };
    }
    return v;
};
const reviver = (k, v)=>{
    if (!v) return v;
    if (v.$url) return new URL(v.$url);
    if (v.$map) return new Map(v.$map);
    if (v.$bytes) return new Uint8Array(v.$bytes);
    return v;
};
const stringify = (value, space)=>JSON.stringify(value, replacer, space);
const parse = (value)=>JSON.parse(value, reviver); //# sourceMappingURL=json.js.map
}),
"[project]/node_modules/@storacha/access/dist/drivers/conf.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "ConfDriver",
    ()=>ConfDriver
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$conf$2f$dist$2f$source$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/conf/dist/source/index.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$utils$2f$json$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/utils/json.js [app-ssr] (ecmascript)");
;
;
class ConfDriver {
    /**
     * @type {Conf<T>}
     */ #config;
    /**
     * @param {{ profile: string }} opts
     */ constructor(opts){
        this.#config = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$conf$2f$dist$2f$source$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"]({
            projectName: 'w3access',
            projectSuffix: '',
            configName: opts.profile,
            serialize: (v)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$utils$2f$json$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["stringify"](v),
            deserialize: (v)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$utils$2f$json$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["parse"](v)
        });
        this.path = this.#config.path;
    }
    async open() {}
    async close() {}
    async reset() {
        this.#config.clear();
    }
    /** @param {T} data */ async save(data) {
        if (typeof data === 'object') {
            data = {
                ...data
            };
            for (const [k, v] of Object.entries(data)){
                if (v === undefined) {
                    delete data[k];
                }
            }
        }
        this.#config.set(data);
    }
    /** @returns {Promise<T|undefined>} */ async load() {
        const data = this.#config.store ?? {};
        if (Object.keys(data).length === 0) return;
        return data;
    }
} //# sourceMappingURL=conf.js.map
}),
"[project]/node_modules/@storacha/access/dist/stores/store-conf.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "StoreConf",
    ()=>StoreConf
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$drivers$2f$conf$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/drivers/conf.js [app-ssr] (ecmascript)");
;
class StoreConf extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$drivers$2f$conf$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["ConfDriver"] {
} //# sourceMappingURL=store-conf.js.map
}),
"[project]/node_modules/@storacha/access/dist/access.js [app-ssr] (ecmascript) <export * as Access>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Access",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/access.js [app-ssr] (ecmascript)");
}),
"[project]/node_modules/@storacha/did-mailto/dist/types.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
;
 //# sourceMappingURL=types.js.map
}),
"[project]/node_modules/@storacha/did-mailto/dist/index.js [app-ssr] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "email",
    ()=>email,
    "fromEmail",
    ()=>fromEmail,
    "fromString",
    ()=>fromString,
    "toEmail",
    ()=>toEmail
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$types$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/did-mailto/dist/types.js [app-ssr] (ecmascript)");
;
function fromEmail(email) {
    const { domain, local } = parseEmail(email);
    const did = `did:mailto:${encodeURIComponent(domain)}:${encodeURIComponent(local)}`;
    return did;
}
function toEmail(did) {
    const parts = did.split(':');
    if (parts[1] !== 'mailto') {
        throw new Error(`DID ${did} is not a mailto did.`);
    }
    return `${decodeURIComponent(parts[3])}@${decodeURIComponent(parts[2])}`;
}
function email(input) {
    const { domain, local } = parseEmail(input);
    /** @type {import("./types.js").EmailAddress} */ const emailAddress = `${local}@${domain}`;
    return emailAddress;
}
function fromString(input) {
    const colonParts = input.split(':');
    if (colonParts.length !== 4) {
        throw new TypeError(`expected did:mailto to have 4 colon-delimited segments, but got ${colonParts.length}`);
    }
    const [domain, local] = [
        colonParts[2],
        colonParts[3]
    ];
    return `did:mailto:${domain}:${local}`;
}
/**
 * @param {string} email
 */ function parseEmail(email) {
    const atParts = email.split('@');
    if (atParts.length < 2) {
        throw new TypeError(`expected at least 2 @-delimited segments, but got ${atParts.length}`);
    }
    const domain = atParts.at(-1) ?? '';
    const local = atParts.slice(0, -1).join('@');
    return {
        domain,
        local
    };
} //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@storacha/did-mailto/dist/index.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "email",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["email"],
    "fromEmail",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["fromEmail"],
    "fromString",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["fromString"],
    "toEmail",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["toEmail"]
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/did-mailto/dist/index.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$types$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/did-mailto/dist/types.js [app-ssr] (ecmascript)");
}),
"[project]/node_modules/@storacha/did-mailto/dist/index.js [app-ssr] (ecmascript) <export * as DIDMailto>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "DIDMailto",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/did-mailto/dist/index.js [app-ssr] (ecmascript)");
}),
"[project]/node_modules/@storacha/filecoin-client/dist/service.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "services",
    ()=>services
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/did.js [app-ssr] (ecmascript)");
;
const services = {
    STOREFRONT: {
        url: new URL('https://up.storacha.network'),
        principal: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["parse"]('did:web:up.storacha.network')
    },
    AGGREGATOR: {
        url: new URL('https://aggregator.web3.storage'),
        principal: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["parse"]('did:web:web3.storage')
    },
    DEALER: {
        url: new URL('https://dealer.web3.storage'),
        principal: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["parse"]('did:web:web3.storage')
    },
    DEAL_TRACKER: {
        url: new URL('https://tracker.web3.storage'),
        principal: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["parse"]('did:web:web3.storage')
    }
}; //# sourceMappingURL=service.js.map
}),
"[project]/node_modules/@storacha/filecoin-client/dist/storefront.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "connection",
    ()=>connection,
    "filecoinAccept",
    ()=>filecoinAccept,
    "filecoinInfo",
    ()=>filecoinInfo,
    "filecoinOffer",
    ()=>filecoinOffer,
    "filecoinSubmit",
    ()=>filecoinSubmit
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/connection.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car.js [app-ssr] (ecmascript) <export * as CAR>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/http.js [app-ssr] (ecmascript) <export * as HTTP>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$storefront$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/filecoin/storefront.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/filecoin-client/dist/service.js [app-ssr] (ecmascript)");
;
;
;
;
const connection = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["connect"])({
    id: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].STOREFRONT.principal,
    codec: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].outbound,
    channel: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__["HTTP"].open({
        url: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].STOREFRONT.url,
        method: 'POST'
    })
});
async function filecoinOffer({ issuer, with: resource, proofs, audience }, content, piece, options = {}) {
    /* c8 ignore next */ const conn = options.connection ?? connection;
    const invocation = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$storefront$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["filecoinOffer"].invoke({
        issuer,
        /* c8 ignore next */ audience: audience ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].STOREFRONT.principal,
        with: resource,
        nb: {
            content,
            piece
        },
        proofs,
        expiration: Infinity
    });
    return await invocation.execute(conn);
}
async function filecoinSubmit({ issuer, with: resource, proofs, audience }, content, piece, options = {}) {
    /* c8 ignore next */ const conn = options.connection ?? connection;
    const invocation = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$storefront$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["filecoinSubmit"].invoke({
        issuer,
        /* c8 ignore next */ audience: audience ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].STOREFRONT.principal,
        with: resource,
        nb: {
            content,
            piece
        },
        proofs,
        expiration: Infinity
    });
    return await invocation.execute(conn);
}
async function filecoinAccept({ issuer, with: resource, proofs, audience }, content, piece, options = {}) {
    /* c8 ignore next */ const conn = options.connection ?? connection;
    const invocation = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$storefront$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["filecoinAccept"].invoke({
        issuer,
        /* c8 ignore next */ audience: audience ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].STOREFRONT.principal,
        with: resource,
        nb: {
            content,
            piece
        },
        proofs,
        expiration: Infinity
    });
    return await invocation.execute(conn);
}
async function filecoinInfo({ issuer, with: resource, proofs, audience }, piece, options = {}) {
    /* c8 ignore next */ const conn = options.connection ?? connection;
    const invocation = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$storefront$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["filecoinInfo"].invoke({
        issuer,
        /* c8 ignore next */ audience: audience ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].STOREFRONT.principal,
        with: resource,
        nb: {
            piece
        },
        proofs
    });
    return await invocation.execute(conn);
} //# sourceMappingURL=storefront.js.map
}),
"[project]/node_modules/@storacha/filecoin-client/dist/aggregator.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "connection",
    ()=>connection,
    "pieceAccept",
    ()=>pieceAccept,
    "pieceOffer",
    ()=>pieceOffer
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/connection.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car.js [app-ssr] (ecmascript) <export * as CAR>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/http.js [app-ssr] (ecmascript) <export * as HTTP>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$aggregator$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/filecoin/aggregator.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/filecoin-client/dist/service.js [app-ssr] (ecmascript)");
;
;
;
;
const connection = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["connect"])({
    id: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].AGGREGATOR.principal,
    codec: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].outbound,
    channel: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__["HTTP"].open({
        url: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].AGGREGATOR.url,
        method: 'POST'
    })
});
async function pieceOffer({ issuer, with: resource, proofs, audience }, piece, group, options = {}) {
    /* c8 ignore next */ const conn = options.connection ?? connection;
    const invocation = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$aggregator$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["pieceOffer"].invoke({
        issuer,
        /* c8 ignore next */ audience: audience ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].AGGREGATOR.principal,
        with: resource,
        nb: {
            piece,
            group
        },
        proofs,
        expiration: Infinity
    });
    return await invocation.execute(conn);
}
async function pieceAccept({ issuer, with: resource, proofs, audience }, piece, group, options = {}) {
    /* c8 ignore next */ const conn = options.connection ?? connection;
    const invocation = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$aggregator$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["pieceAccept"].invoke({
        issuer,
        /* c8 ignore next */ audience: audience ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].AGGREGATOR.principal,
        with: resource,
        nb: {
            piece,
            group
        },
        proofs,
        expiration: Infinity
    });
    return await invocation.execute(conn);
} //# sourceMappingURL=aggregator.js.map
}),
"[project]/node_modules/@storacha/filecoin-client/dist/dealer.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "aggregateAccept",
    ()=>aggregateAccept,
    "aggregateOffer",
    ()=>aggregateOffer,
    "connection",
    ()=>connection
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/connection.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car.js [app-ssr] (ecmascript) <export * as CAR>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/http.js [app-ssr] (ecmascript) <export * as HTTP>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$cbor$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CBOR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/cbor.js [app-ssr] (ecmascript) <export * as CBOR>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$dealer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/filecoin/dealer.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/filecoin-client/dist/service.js [app-ssr] (ecmascript)");
;
;
;
;
;
const connection = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["connect"])({
    id: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].DEALER.principal,
    codec: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].outbound,
    channel: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__["HTTP"].open({
        url: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].DEALER.url,
        method: 'POST'
    })
});
async function aggregateOffer({ issuer, with: resource, proofs, audience }, aggregate, pieces, options = {}) {
    /* c8 ignore next */ const conn = options.connection ?? connection;
    const block = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$cbor$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CBOR$3e$__["CBOR"].write(pieces);
    const invocation = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$dealer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["aggregateOffer"].invoke({
        issuer,
        /* c8 ignore next */ audience: audience ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].AGGREGATOR.principal,
        with: resource,
        nb: {
            aggregate,
            pieces: block.cid
        },
        proofs,
        expiration: Infinity
    });
    invocation.attach(block);
    return await invocation.execute(conn);
}
async function aggregateAccept({ issuer, with: resource, proofs, audience }, aggregate, pieces, options = {}) {
    /* c8 ignore next */ const conn = options.connection ?? connection;
    const invocation = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$dealer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["aggregateAccept"].invoke({
        issuer,
        /* c8 ignore next */ audience: audience ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].AGGREGATOR.principal,
        with: resource,
        nb: {
            aggregate,
            pieces
        },
        proofs,
        expiration: Infinity
    });
    return await invocation.execute(conn);
} //# sourceMappingURL=dealer.js.map
}),
"[project]/node_modules/@storacha/filecoin-client/dist/deal-tracker.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "connection",
    ()=>connection,
    "dealInfo",
    ()=>dealInfo
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/connection.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car.js [app-ssr] (ecmascript) <export * as CAR>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/http.js [app-ssr] (ecmascript) <export * as HTTP>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$deal$2d$tracker$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/filecoin/deal-tracker.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/filecoin-client/dist/service.js [app-ssr] (ecmascript)");
;
;
;
;
const connection = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["connect"])({
    id: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].DEAL_TRACKER.principal,
    codec: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].outbound,
    channel: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__["HTTP"].open({
        url: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].DEAL_TRACKER.url,
        method: 'POST'
    })
});
async function dealInfo({ issuer, with: resource, proofs, audience }, piece, options = {}) {
    /* c8 ignore next */ const conn = options.connection ?? connection;
    const invocation = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$deal$2d$tracker$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["dealInfo"].invoke({
        issuer,
        /* c8 ignore next */ audience: audience ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["services"].DEAL_TRACKER.principal,
        with: resource,
        nb: {
            piece
        },
        proofs
    });
    return await invocation.execute(conn);
} //# sourceMappingURL=deal-tracker.js.map
}),
"[project]/node_modules/@storacha/filecoin-client/dist/index.js [app-ssr] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$storefront$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/filecoin-client/dist/storefront.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$aggregator$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/filecoin-client/dist/aggregator.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$dealer$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/filecoin-client/dist/dealer.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$deal$2d$tracker$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/filecoin-client/dist/deal-tracker.js [app-ssr] (ecmascript)"); //# sourceMappingURL=index.js.map
;
;
;
;
}),
"[project]/node_modules/@storacha/filecoin-client/dist/storefront.js [app-ssr] (ecmascript) <export * as Storefront>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Storefront",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$storefront$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$storefront$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/filecoin-client/dist/storefront.js [app-ssr] (ecmascript)");
}),
"[project]/node_modules/@storacha/blob-index/dist/api.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
;
 //# sourceMappingURL=api.js.map
}),
"[project]/node_modules/@storacha/blob-index/dist/digest-map.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "DigestMap",
    ()=>DigestMap
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$api$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/dist/api.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base58$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/bases/base58.js [app-ssr] (ecmascript)");
;
;
/** @type {WeakMap<Uint8Array, string>} */ const cache = new WeakMap();
/** @param {API.MultihashDigest} digest */ const toBase58String = (digest)=>{
    let str = cache.get(digest.bytes);
    if (!str) {
        str = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base58$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["base58btc"].encode(digest.bytes);
        cache.set(digest.bytes, str);
    }
    return str;
};
class DigestMap {
    /** @type {Map<string, [Key, Value]>} */ #data;
    /**
     * @param {Array<[Key, Value]>} [entries]
     */ constructor(entries){
        this.#data = new Map();
        for (const [k, v] of entries ?? []){
            this.set(k, v);
        }
    }
    get [Symbol.toStringTag]() {
        return 'DigestMap';
    }
    clear() {
        this.#data.clear();
    }
    /**
     * @param {Key} key
     * @returns {boolean}
     */ delete(key) {
        const mhstr = toBase58String(key);
        return this.#data.delete(mhstr);
    }
    /**
     * @param {(value: Value, key: Key, map: Map<Key, Value>) => void} callbackfn
     * @param {any} [thisArg]
     */ forEach(callbackfn, thisArg) {
        for (const [k, v] of this.#data.values()){
            callbackfn.call(thisArg, v, k, this);
        }
    }
    /**
     * @param {Key} key
     * @returns {Value|undefined}
     */ get(key) {
        const data = this.#data.get(toBase58String(key));
        if (data) return data[1];
    }
    /**
     * @param {Key} key
     * @returns {boolean}
     */ has(key) {
        return this.#data.has(toBase58String(key));
    }
    /**
     * @param {Key} key
     * @param {Value} value
     */ set(key, value) {
        this.#data.set(toBase58String(key), [
            key,
            value
        ]);
        return this;
    }
    /** @returns {number} */ get size() {
        return this.#data.size;
    }
    /** @returns */ [Symbol.iterator]() {
        return this.entries();
    }
    /** @returns {IterableIterator<[Key, Value]>} */ *entries() {
        yield* this.#data.values();
    }
    /** @returns {IterableIterator<Key>} */ *keys() {
        for (const [k] of this.#data.values()){
            yield k;
        }
    }
    /** @returns {IterableIterator<Value>} */ *values() {
        for (const [, v] of this.#data.values()){
            yield v;
        }
    }
} //# sourceMappingURL=digest-map.js.map
}),
"[project]/node_modules/@storacha/blob-index/dist/sharded-dag-index.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "BlobIndexSchema",
    ()=>BlobIndexSchema,
    "DecodeFailure",
    ()=>DecodeFailure,
    "MultihashSchema",
    ()=>MultihashSchema,
    "ShardedDAGIndexSchema",
    ()=>ShardedDAGIndexSchema,
    "UnknownFormat",
    ()=>UnknownFormat,
    "archive",
    ()=>archive,
    "create",
    ()=>create,
    "extract",
    ()=>extract,
    "version",
    ()=>version,
    "view",
    ()=>view
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$api$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/dist/api.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/car.js [app-ssr] (ecmascript) <export * as CAR>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/result.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/schema.js [app-ssr] (ecmascript) <export * as Schema>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/index.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$compare$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/node_modules/uint8arrays/dist/src/compare.node.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$cbor$2f$src$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-cbor/src/index.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$digest$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/hashes/digest.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$link$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/link.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$sha2$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/hashes/sha2.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$digest$2d$map$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/dist/digest-map.js [app-ssr] (ecmascript)");
;
;
;
;
;
;
;
;
const version = 'index/sharded/dag@0.1';
const ShardedDAGIndexSchema = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].variant({
    [version]: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].struct({
        /** DAG root. */ content: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].link(),
        /** Shards the DAG can be found in. */ shards: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].link())
    })
});
const MultihashSchema = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].bytes();
const BlobIndexSchema = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].tuple([
    MultihashSchema,
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].array(/** multihash bytes, offset, length. */ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].tuple([
        MultihashSchema,
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].tuple([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].number(),
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].number()
        ])
    ]))
]);
const extract = (archive)=>{
    const { roots, blocks } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].decode(archive);
    if (!roots.length) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["error"])(new UnknownFormat('missing root block'));
    }
    const { code } = roots[0].cid;
    if (code !== __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$cbor$2f$src$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["code"]) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["error"])(new UnknownFormat(`unexpected root CID codec: 0x${code.toString(16)}`));
    }
    return view({
        root: roots[0],
        blocks
    });
};
const view = ({ root, blocks })=>{
    const [version, dagIndexData] = ShardedDAGIndexSchema.match(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$cbor$2f$src$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["decode"](root.bytes));
    switch(version){
        case version:
            {
                const dagIndex = create(dagIndexData.content);
                for (const shardLink of dagIndexData.shards){
                    const shard = blocks.get(shardLink.toString());
                    if (!shard) {
                        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["error"])(new DecodeFailure(`missing shard block: ${shardLink}`));
                    }
                    const blobIndexData = BlobIndexSchema.from(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$cbor$2f$src$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["decode"](shard.bytes));
                    const blobIndex = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$digest$2d$map$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["DigestMap"]();
                    for (const [digest, [offset, length]] of blobIndexData[1]){
                        blobIndex.set(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$digest$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["decode"](digest), [
                            offset,
                            length
                        ]);
                    }
                    dagIndex.shards.set(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$digest$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["decode"](blobIndexData[0]), blobIndex);
                }
                return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["ok"])(dagIndex);
            }
        default:
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["error"])(new UnknownFormat(`unknown index version: ${version}`));
    }
};
/** @implements {API.ShardedDAGIndexView} */ class ShardedDAGIndex {
    #content;
    #shards;
    /** @param {API.UnknownLink} content */ constructor(content){
        this.#content = content;
        /** @type {DigestMap<API.ShardDigest, API.Position>} */ this.#shards = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$digest$2d$map$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["DigestMap"]();
    }
    get content() {
        return this.#content;
    }
    get shards() {
        return this.#shards;
    }
    /**
     * @param {API.ShardDigest} shard
     * @param {API.SliceDigest} slice
     * @param {API.Position} pos
     */ setSlice(shard, slice, pos) {
        let index = this.#shards.get(shard);
        if (!index) {
            index = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$digest$2d$map$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["DigestMap"]();
            this.#shards.set(shard, index);
        }
        index.set(slice, pos);
    }
    archive() {
        return archive(this);
    }
}
class UnknownFormat extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Failure"] {
    #reason;
    /** @param {string} [reason] */ constructor(reason){
        super();
        this.name = 'UnknownFormat';
        this.#reason = reason;
    }
    describe() {
        return this.#reason ?? 'unknown format';
    }
}
class DecodeFailure extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Failure"] {
    #reason;
    /** @param {string} [reason] */ constructor(reason){
        super();
        this.name = 'DecodeFailure';
        this.#reason = reason;
    }
    describe() {
        return this.#reason ?? 'failed to decode';
    }
}
const create = (content)=>new ShardedDAGIndex(content);
const archive = async (model)=>{
    const roots = [];
    const blocks = new Map();
    try {
        const shards = [
            ...model.shards.entries()
        ].sort((a, b)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$compare$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["compare"])(a[0].digest, b[0].digest));
        const index = {
            content: model.content,
            shards: []
        };
        for (const s of shards){
            const slices = [
                ...s[1].entries()
            ].sort((a, b)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$node_modules$2f$uint8arrays$2f$dist$2f$src$2f$compare$2e$node$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["compare"])(a[0].digest, b[0].digest)).map((e)=>[
                    e[0].bytes,
                    e[1]
                ]);
            const bytes = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$cbor$2f$src$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["encode"]([
                s[0].bytes,
                slices
            ]);
            const digest = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$sha2$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["sha256"].digest(bytes);
            const cid = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$link$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["create"](__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$cbor$2f$src$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["code"], digest);
            blocks.set(cid.toString(), {
                cid,
                bytes
            });
            index.shards.push(cid);
        }
        const bytes = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$cbor$2f$src$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["encode"]({
            [version]: index
        });
        const digest = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$sha2$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["sha256"].digest(bytes);
        const cid = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$link$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["create"](__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$cbor$2f$src$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["code"], digest);
        roots.push({
            cid,
            bytes
        });
    } catch (/** @type {any} */ err) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["error"])({
            name: 'EncodeFailure',
            message: `encoding DAG: ${err.message}`,
            stack: err.stack
        });
    }
    try {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["ok"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].encode({
            roots,
            blocks
        }));
    } catch (/** @type {any} */ err) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["error"])({
            name: 'EncodeFailure',
            message: `encoding CAR: ${err.message}`,
            stack: err.stack
        });
    }
}; //# sourceMappingURL=sharded-dag-index.js.map
}),
"[project]/node_modules/@storacha/blob-index/dist/util.js [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "fromShardArchives",
    ()=>fromShardArchives,
    "indexShardedDAG",
    ()=>indexShardedDAG
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$carstream$2f$src$2f$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/carstream/src/index.js [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$carstream$2f$src$2f$reader$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/carstream/src/reader.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$sha2$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/hashes/sha2.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$api$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/dist/api.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$sharded$2d$dag$2d$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/dist/sharded-dag-index.js [app-ssr] (ecmascript)");
;
;
;
;
const fromShardArchives = async (content, shards)=>{
    const index = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$sharded$2d$dag$2d$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["create"])(content);
    for (const s of shards){
        const digest = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$sha2$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["sha256"].digest(s);
        await new ReadableStream({
            pull: (c)=>{
                c.enqueue(s);
                c.close();
            }
        }).pipeThrough(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$carstream$2f$src$2f$reader$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["CARReaderStream"]()).pipeTo(new WritableStream({
            write ({ cid, blockOffset, blockLength }) {
                index.setSlice(digest, cid.multihash, [
                    blockOffset,
                    blockLength
                ]);
            }
        }));
    }
    return index;
};
async function indexShardedDAG(root, shards, shardIndexes) {
    const index = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$sharded$2d$dag$2d$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["create"])(root);
    for (const [i, shard] of shards.entries()){
        const slices = shardIndexes[i];
        index.shards.set(shard.multihash, slices);
    }
    return await index.archive();
} //# sourceMappingURL=util.js.map
}),
"[project]/node_modules/@storacha/blob-index/dist/index.js [app-ssr] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$sharded$2d$dag$2d$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/dist/sharded-dag-index.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$digest$2d$map$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/dist/digest-map.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$util$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/dist/util.js [app-ssr] (ecmascript)"); //# sourceMappingURL=index.js.map
;
;
;
}),
"[project]/node_modules/@storacha/blob-index/dist/sharded-dag-index.js [app-ssr] (ecmascript) <export * as ShardedDAGIndex>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "ShardedDAGIndex",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$sharded$2d$dag$2d$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$blob$2d$index$2f$dist$2f$sharded$2d$dag$2d$index$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/blob-index/dist/sharded-dag-index.js [app-ssr] (ecmascript)");
}),
];

//# sourceMappingURL=node_modules_%40storacha_6c3686a7._.js.map