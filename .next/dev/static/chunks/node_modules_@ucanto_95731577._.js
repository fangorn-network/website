(globalThis.TURBOPACK || (globalThis.TURBOPACK = [])).push([typeof document === "object" ? document.currentScript : undefined,
"[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
}),
"[project]/node_modules/@ucanto/client/src/connection.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "connect",
    ()=>connect,
    "execute",
    ()=>execute
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Signature$3e$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/signature.js [app-client] (ecmascript) <export * as Signature>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$message$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Message$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/message.js [app-client] (ecmascript) <export * as Message>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$receipt$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Receipt$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/receipt.js [app-client] (ecmascript) <export * as Receipt>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$sha2$2d$browser$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/hashes/sha2-browser.js [app-client] (ecmascript)");
;
;
const connect = (options)=>new Connection(options);
/**
 * @template {Record<string, any>} T
 * @implements {API.ConnectionView<T>}
 */ class Connection {
    /**
   * @param {API.ConnectionOptions<T>} options
   */ constructor(options){
        this.id = options.id;
        this.options = options;
        this.codec = options.codec;
        this.channel = options.channel;
        this.hasher = options.hasher || __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$sha2$2d$browser$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["sha256"];
    }
    /**
   * Execute invocations.
   *
   * @template {API.Capability} C
   * @template {API.Tuple<API.ServiceInvocation<C, T>>} I
   * @param {I} invocations
   * @returns {Promise<API.InferReceipts<I, T>>}
   */ async execute(...invocations) {
        return execute(invocations, this);
    }
}
const execute = async (invocations, connection)=>{
    const input = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$message$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Message$3e$__["Message"].build({
        invocations
    });
    const request = await connection.codec.encode(input, connection);
    const response = await connection.channel.request(request);
    // We may fail to decode the response if content type is not supported
    // or if data was corrupted. We do not want to throw in such case however,
    // because client will get an Error object as opposed to a receipt, to retain
    // consistent client API with two kinds of errors we encode caught error as
    // a receipts per workflow invocation.
    try {
        const output = await connection.codec.decode(response);
        const receipts = input.invocationLinks.map((link)=>output.get(link));
        return receipts;
    } catch (error) {
        // No third party code is run during decode and we know
        // we only throw an Error
        const { message, name = 'Error', ...cause } = error;
        const receipts = [];
        for await (const ran of input.invocationLinks){
            const receipt = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$receipt$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Receipt$3e$__["Receipt"].issue({
                ran,
                result: {
                    error: {
                        ...cause,
                        name,
                        message
                    }
                },
                // @ts-expect-error - we can not really sign a receipt without having
                // an access to a signer which client does not have. In the future
                // we will change client API requiring a signer to be passed in but
                // for now we just use a dummy signer.
                issuer: {
                    did () {
                        return connection.id.did();
                    },
                    sign () {
                        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Signature$3e$__["Signature"].createNonStandard('', new Uint8Array());
                    }
                }
            });
            receipts.push(receipt);
        }
        return receipts;
    }
};
}),
"[project]/node_modules/@ucanto/client/src/lib.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "delegate",
    ()=>delegate
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/connection.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Delegation$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-client] (ecmascript) <export * as Delegation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$invocation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/invocation.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/schema.js [app-client] (ecmascript) <export * as Schema>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$dag$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__DAG$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/dag.js [app-client] (ecmascript) <export * as DAG>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/result.js [app-client] (ecmascript)");
;
;
;
const delegate = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Delegation$3e$__["Delegation"].delegate;
;
}),
"[project]/node_modules/@ucanto/transport/src/car/request.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "contentType",
    ()=>contentType,
    "decode",
    ()=>decode,
    "encode",
    ()=>encode
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/car.js [app-client] (ecmascript) <export * as CAR>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$message$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Message$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/message.js [app-client] (ecmascript) <export * as Message>");
;
;
;
const contentType = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].contentType;
const HEADERS = Object.freeze({
    'content-type': contentType,
    // We will signal that we want to receive a CAR file in the response
    accept: contentType
});
const encode = (message, options)=>{
    const blocks = new Map();
    for (const block of message.iterateIPLDBlocks()){
        blocks.set(`${block.cid}`, block);
    }
    /**
   * Cast to Uint8Array to remove phantom type set by the
   * CAR encoder which is too specific.
   *
   * @type {Uint8Array}
   */ const body = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].encode({
        roots: [
            message.root
        ],
        blocks
    });
    return {
        headers: options?.headers || {
            ...HEADERS
        },
        body
    };
};
const decode = async ({ headers, body })=>{
    const { roots, blocks } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].decode(body);
    const message = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$message$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Message$3e$__["Message"].view({
        root: roots[0].cid,
        store: blocks
    });
    return message;
};
}),
"[project]/node_modules/@ucanto/transport/src/car/request.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "codec",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"],
    "contentType",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["contentType"],
    "decode",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["decode"],
    "encode",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["encode"]
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car/request.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/car.js [app-client] (ecmascript) <export * as CAR>");
}),
"[project]/node_modules/@ucanto/transport/src/car/response.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "contentType",
    ()=>contentType,
    "decode",
    ()=>decode,
    "encode",
    ()=>encode
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/car.js [app-client] (ecmascript) <export * as CAR>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$message$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Message$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/message.js [app-client] (ecmascript) <export * as Message>");
;
;
;
const contentType = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].contentType;
const HEADERS = Object.freeze({
    'content-type': contentType
});
const encode = (message, options)=>{
    const blocks = new Map();
    for (const block of message.iterateIPLDBlocks()){
        blocks.set(`${block.cid}`, block);
    }
    /**
   * Cast to Uint8Array to remove phantom type set by the
   * CAR encoder which is too specific.
   *
   * @type {Uint8Array}
   */ const body = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].encode({
        roots: [
            message.root
        ],
        blocks
    });
    return {
        headers: {
            ...HEADERS
        },
        body
    };
};
const decode = async ({ headers, body })=>{
    const { roots, blocks } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].decode(body);
    const message = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$message$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Message$3e$__["Message"].view({
        root: roots[0].cid,
        store: blocks
    });
    return message;
};
}),
"[project]/node_modules/@ucanto/transport/src/car/response.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "codec",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"],
    "contentType",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["contentType"],
    "decode",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["decode"],
    "encode",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["encode"]
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car/response.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/car.js [app-client] (ecmascript) <export * as CAR>");
}),
"[project]/node_modules/@ucanto/transport/src/codec.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "formatAcceptHeader",
    ()=>formatAcceptHeader,
    "formatMediaType",
    ()=>formatMediaType,
    "inbound",
    ()=>inbound,
    "outbound",
    ()=>outbound,
    "parseAcceptHeader",
    ()=>parseAcceptHeader,
    "parseMediaType",
    ()=>parseMediaType
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
;
const inbound = (source)=>new Inbound(source);
/**
 * @implements {API.InboundCodec}
 */ class Inbound {
    /**
   * @param {API.HTTPRequest} request
   * @returns {API.Result<API.InboundAcceptCodec, API.HTTPError>} transport
   */ accept({ headers }) {
        const contentType = headers['content-type'] || headers['Content-Type'];
        const decoder = this.decoders[contentType];
        if (!decoder) {
            return {
                error: {
                    status: 415,
                    message: `The server cannot process the request because the payload format is not supported. Please check the content-type header and try again with a supported media type.`,
                    headers: {
                        accept: Object.keys(this.decoders).join(', ')
                    }
                }
            };
        }
        const accept = parseAcceptHeader(headers.accept || headers.Accept || '*/*');
        for (const { category, type } of accept){
            for (const encoder of this.encoders){
                const select = (category === '*' || category === encoder.category) && (type === '*' || type === encoder.type);
                if (select) {
                    return {
                        ok: {
                            ...encoder,
                            decoder
                        }
                    };
                }
            }
        }
        return {
            error: {
                status: 406,
                message: `The requested resource cannot be served in the requested content type. Please specify a supported content type using the Accept header.`,
                headers: {
                    accept: formatAcceptHeader(Object.values(this.encoders))
                }
            }
        };
    }
    /**
   * @param {object} source
   * @param {Record<string, API.Transport.RequestDecoder>} source.decoders
   * @param {Record<string, API.Transport.ResponseEncoder>} source.encoders
   */ constructor({ decoders = {}, encoders = {} }){
        this.decoders = decoders;
        if (Object.keys(decoders).length === 0) {
            throw new Error('At least one decoder MUST be provided');
        }
        // We sort the encoders by preference, so that we can pick the most
        // preferred one when client accepts multiple content types.
        this.encoders = Object.entries(encoders).map(([mediaType, encoder])=>{
            return {
                ...parseMediaType(mediaType),
                encoder
            };
        }).sort((a, b)=>b.preference - a.preference);
        if (this.encoders.length === 0) {
            throw new Error('At least one encoder MUST be provided');
        }
    }
}
const outbound = (source)=>new Outbound(source);
/**
 * @implements {API.OutboundCodec}
 */ class Outbound {
    /**
   * @param {object} source
   * @param {Record<string, API.Transport.RequestEncoder>} source.encoders
   * @param {Record<string, API.Transport.ResponseDecoder>} source.decoders
   */ constructor({ decoders = {}, encoders = {} }){
        this.decoders = decoders;
        if (Object.keys(decoders).length === 0) {
            throw new Error('At least one decoder MUST be provided');
        }
        // We sort the encoders by preference, so that we can pick the most
        // preferred one when client accepts multiple content types.
        this.encoders = Object.entries(encoders).map(([mediaType, encoder])=>{
            return {
                ...parseMediaType(mediaType),
                encoder
            };
        }).sort((a, b)=>b.preference - a.preference);
        this.acceptType = formatAcceptHeader(this.encoders);
        if (this.encoders.length === 0) {
            throw new Error('At least one encoder MUST be provided');
        }
        this.encoder = this.encoders[0].encoder;
    }
    /**
   * @template {API.AgentMessage} Message
   * @param {Message} message
   */ encode(message) {
        return this.encoder.encode(message, {
            accept: this.acceptType
        });
    }
    /**
   * @template {API.AgentMessage} Message
   * @param {API.HTTPResponse<Message>} response
   * @returns {API.Await<Message>}
   */ decode(response) {
        const { headers } = response;
        const contentType = headers['content-type'] || headers['Content-Type'];
        const decoder = this.decoders[contentType] || this.decoders['*/*'];
        switch(response.status){
            case 415:
            case 406:
                throw Object.assign(new RangeError(new TextDecoder().decode(response.body)), {
                    status: response.status,
                    headers: response.headers
                });
        }
        if (!decoder) {
            throw Object.assign(TypeError(`Can not decode response with content-type '${contentType}' because no matching transport decoder is configured.`), {
                error: true
            });
        }
        return decoder.decode(response);
    }
}
const parseMediaType = (source)=>{
    const [mediaType = '*/*', mediaRange = ''] = source.trim().split(';');
    const [category = '*', type = '*'] = mediaType.split('/');
    const params = new URLSearchParams(mediaRange);
    const preference = parseFloat(params.get('q') || '0');
    return {
        category,
        type,
        /* c8 ignore next */ preference: isNaN(preference) ? 0 : preference
    };
};
const formatMediaType = ({ category, type, preference })=>`${category}/${type}${preference ? `;q=${preference}` : ''}`;
const parseAcceptHeader = (source)=>source.split(',').map(parseMediaType).sort((a, b)=>b.preference - a.preference);
const formatAcceptHeader = (source)=>source.map(formatMediaType).join(', ');
}),
"[project]/node_modules/@ucanto/transport/src/car.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "contentType",
    ()=>contentType,
    "inbound",
    ()=>inbound,
    "outbound",
    ()=>outbound
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/car.js [app-client] (ecmascript) <export * as CAR>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car/request.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car/request.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car/response.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car/response.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$codec$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/codec.js [app-client] (ecmascript)");
;
;
;
;
;
const contentType = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].contentType;
const inbound = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$codec$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["inbound"]({
    decoders: {
        [__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__.contentType]: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__
    },
    encoders: {
        [__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__.contentType]: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__
    }
});
const outbound = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$codec$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["outbound"]({
    encoders: {
        [__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__.contentType]: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__
    },
    decoders: {
        [__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__.contentType]: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__
    }
});
}),
"[project]/node_modules/@ucanto/transport/src/http.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "open",
    ()=>open
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
;
const open = ({ url, method = 'POST', fetch, headers })=>{
    /* c8 ignore next 9 */ if (!fetch) {
        if (typeof globalThis.fetch !== 'undefined') {
            fetch = globalThis.fetch.bind(globalThis);
        } else {
            throw new TypeError(`ucanto HTTP transport got undefined \`fetch\`. Try passing in a \`fetch\` implementation explicitly.`);
        }
    }
    return new Channel({
        url,
        method,
        fetch,
        headers
    });
};
/**
 * @template {Record<string, any>} S
 * @implements {API.Channel<S>}
 */ class Channel {
    /**
   * @param {object} options
   * @param {URL} options.url
   * @param {Fetcher} options.fetch
   * @param {string} [options.method]
   * @param {Record<string, string>} [options.headers]
   */ constructor({ url, fetch, method, headers }){
        this.fetch = fetch;
        this.method = method;
        this.url = url;
        this.headers = headers;
    }
    /**
   * @template {API.Tuple<API.ServiceInvocation<API.Capability, S>>} I
   * @param {API.HTTPRequest<API.AgentMessage<{ In: API.InferInvocations<I>, Out: API.Tuple<API.Receipt> }>>} request
   * @returns {Promise<API.HTTPResponse<API.AgentMessage<{ Out: API.InferReceipts<I, S>, In: API.Tuple<API.Invocation> }>>>}
   */ async request({ headers, body }) {
        const response = await this.fetch(this.url.href, {
            headers: {
                ...this.headers,
                ...headers
            },
            body,
            method: this.method
        });
        const buffer = response.ok ? await response.arrayBuffer() : HTTPError.throw(`HTTP Request failed. ${this.method} ${this.url.href} â†’ ${response.status}`, response);
        return {
            headers: response.headers.entries ? Object.fromEntries(response.headers.entries()) : /* c8 ignore next */ {},
            body: new Uint8Array(buffer)
        };
    }
}
/**
 * @typedef {{
 * status?: number
 * statusText?: string
 * url?: string
 * }} Options
 */ class HTTPError extends Error {
    /**
   * @param {string} message
   * @param {Options} options
   * @returns {never}
   */ static throw(message, options) {
        throw new this(message, options);
    }
    /**
   * @param {string} message
   * @param {Options} options
   */ constructor(message, { url, status = 500, statusText = 'Server error' }){
        super(message);
        /** @type {'HTTPError'} */ this.name = 'HTTPError';
        this.url = url;
        this.status = status;
        this.statusText = statusText;
    }
}
}),
"[project]/node_modules/@ucanto/transport/src/utf8.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "decode",
    ()=>decode,
    "decoder",
    ()=>decoder,
    "encode",
    ()=>encode,
    "encoder",
    ()=>encoder
]);
const encoder = new TextEncoder();
const decoder = new TextDecoder();
const encode = (text)=>encoder.encode(text);
const decode = (bytes)=>decoder.decode(bytes);
}),
"[project]/node_modules/@ucanto/transport/src/car/request.js [app-client] (ecmascript) <export * as request>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "request",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car/request.js [app-client] (ecmascript)");
}),
"[project]/node_modules/@ucanto/transport/src/car/response.js [app-client] (ecmascript) <export * as response>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "response",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car/response.js [app-client] (ecmascript)");
}),
"[project]/node_modules/@ucanto/transport/src/legacy/response.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "contentType",
    ()=>contentType,
    "encode",
    ()=>encode
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$cbor$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/cbor.js [app-client] (ecmascript) <locals>");
;
;
const contentType = 'application/cbor';
const HEADERS = Object.freeze({
    'content-type': contentType
});
const encode = (message, options)=>{
    const legacyResults = [];
    for (const receipt of message.receipts.values()){
        const result = receipt.out;
        if (result.ok) {
            legacyResults.push(result.ok);
        } else {
            legacyResults.push({
                ...result.error,
                error: true
            });
        }
    }
    /** @type {Uint8Array} */ const body = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$cbor$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["encode"](legacyResults);
    return {
        headers: HEADERS,
        body
    };
};
}),
"[project]/node_modules/@ucanto/transport/src/legacy/request.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "contentType",
    ()=>contentType,
    "decode",
    ()=>decode
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/car.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$invocation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Invocation$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/invocation.js [app-client] (ecmascript) <export * as Invocation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$message$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Message$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/message.js [app-client] (ecmascript) <export * as Message>");
;
;
;
const contentType = 'application/car';
const decode = async ({ body })=>{
    const { roots, blocks } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["decode"](body);
    /** @type {API.IssuedInvocation[]} */ const run = [];
    for (const { cid } of roots){
        // We don't have a way to know if the root matches a ucan link.
        const invocation = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$invocation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Invocation$3e$__["Invocation"].view({
            root: cid,
            blocks
        });
        run.push(invocation);
    }
    const message = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$message$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Message$3e$__["Message"].build({
        invocations: run
    });
    return message;
};
}),
"[project]/node_modules/@ucanto/transport/src/legacy.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "contentType",
    ()=>contentType,
    "inbound",
    ()=>inbound
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$codec$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/codec.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__request$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car/request.js [app-client] (ecmascript) <export * as request>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__response$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car/response.js [app-client] (ecmascript) <export * as response>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$legacy$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/legacy/response.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$legacy$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/legacy/request.js [app-client] (ecmascript)");
;
;
;
;
const { contentType } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$legacy$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__;
;
const inbound = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$codec$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["inbound"]({
    decoders: {
        [contentType]: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$legacy$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__,
        [__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["contentType"]]: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__request$3e$__["request"]
    },
    encoders: {
        // Here we configure encoders such that if accept header is `*/*` (which is
        // the default if omitted) we will encode the response in CBOR. If
        // `application/vnd.ipld.car` is set we will encode the response in current
        // format.
        // Here we exploit the fact that legacy clients do not send an accept header
        // and therefore will get response in legacy format. New clients on the other
        // hand will send `application/vnd.ipld.car` and consequently get response
        // in current format.
        '*/*;q=0.1': __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$legacy$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__,
        [__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["contentType"]]: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__response$3e$__["response"]
    }
});
}),
"[project]/node_modules/@ucanto/transport/src/lib.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

// top level exports
__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/http.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$utf8$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/utf8.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$legacy$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/legacy.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$codec$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/codec.js [app-client] (ecmascript)");
;
;
;
;
;
;
}),
"[project]/node_modules/@ucanto/transport/src/car.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "codec",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"],
    "contentType",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["contentType"],
    "inbound",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["inbound"],
    "outbound",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["outbound"],
    "request",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__,
    "response",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/car.js [app-client] (ecmascript) <export * as CAR>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$request$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car/request.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2f$response$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car/response.js [app-client] (ecmascript)");
}),
"[project]/node_modules/@ucanto/transport/src/car.js [app-client] (ecmascript) <export * as CAR>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "CAR",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car.js [app-client] (ecmascript)");
}),
"[project]/node_modules/@ucanto/transport/src/http.js [app-client] (ecmascript) <export * as HTTP>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "HTTP",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/http.js [app-client] (ecmascript)");
}),
"[project]/node_modules/@ucanto/validator/src/util.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * @template {string|boolean|number|[unknown, ...unknown[]]} T
 * @param {T} value
 * @returns {T}
 */ __turbopack_context__.s([
    "combine",
    ()=>combine,
    "entries",
    ()=>entries,
    "intersection",
    ()=>intersection,
    "the",
    ()=>the
]);
const the = (value)=>value;
const entries = (object)=>Object.entries(object);
const combine = ([first, ...rest])=>{
    const results = first.map((value)=>[
            value
        ]);
    for (const values of rest){
        const tuples = results.splice(0);
        for (const value of values){
            for (const tuple of tuples){
                results.push([
                    ...tuple,
                    value
                ]);
            }
        }
    }
    return results;
};
const intersection = (left, right)=>{
    const [result, other] = left.length < right.length ? [
        new Set(left),
        new Set(right)
    ] : [
        new Set(right),
        new Set(left)
    ];
    for (const item of result){
        if (!other.has(item)) {
            result.delete(item);
        }
    }
    return [
        ...result
    ];
};
}),
"[project]/node_modules/@ucanto/validator/src/error.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "DIDKeyResolutionError",
    ()=>DIDKeyResolutionError,
    "DelegationError",
    ()=>DelegationError,
    "EscalatedCapability",
    ()=>EscalatedCapability,
    "Expired",
    ()=>Expired,
    "InvalidSignature",
    ()=>InvalidSignature,
    "MalformedCapability",
    ()=>MalformedCapability,
    "NotValidBefore",
    ()=>NotValidBefore,
    "PrincipalAlignmentError",
    ()=>PrincipalAlignmentError,
    "Revoked",
    ()=>Revoked,
    "SessionEscalation",
    ()=>SessionEscalation,
    "Unauthorized",
    ()=>Unauthorized,
    "UnavailableProof",
    ()=>UnavailableProof,
    "UnknownCapability",
    ()=>UnknownCapability,
    "indent",
    ()=>indent,
    "li",
    ()=>li
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/validator/src/util.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$link$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/link.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$link$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/link.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/result.js [app-client] (ecmascript)");
;
;
;
;
;
class EscalatedCapability extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {API.ParsedCapability} claimed
   * @param {object} delegated
   * @param {API.Failure} cause
   */ constructor(claimed, delegated, cause){
        super();
        this.claimed = claimed;
        this.delegated = delegated;
        this.cause = cause;
        this.name = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["the"])('EscalatedCapability');
    }
    describe() {
        return `Constraint violation: ${this.cause.message}`;
    }
}
class DelegationError extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {(API.InvalidCapability | API.EscalatedDelegation | API.DelegationError)[]} causes
   * @param {object} context
   */ constructor(causes, context){
        super();
        this.name = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["the"])('InvalidClaim');
        this.causes = causes;
        this.context = context;
    }
    describe() {
        return [
            `Can not derive ${this.context} from delegated capabilities:`,
            ...this.causes.map((cause)=>li(cause.message))
        ].join('\n');
    }
    /**
   * @type {API.InvalidCapability | API.EscalatedDelegation | API.DelegationError}
   */ get cause() {
        /* c8 ignore next 9 */ if (this.causes.length !== 1) {
            return this;
        } else {
            const [cause] = this.causes;
            const value = cause.name === 'InvalidClaim' ? cause.cause : cause;
            Object.defineProperties(this, {
                cause: {
                    value
                }
            });
            return value;
        }
    }
}
class SessionEscalation extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {object} source
   * @param {API.Delegation} source.delegation
   * @param {API.Failure} source.cause
   */ constructor({ delegation, cause }){
        super();
        this.name = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["the"])('SessionEscalation');
        this.delegation = delegation;
        this.cause = cause;
    }
    describe() {
        const issuer = this.delegation.issuer.did();
        return [
            `Delegation ${this.delegation.cid} issued by ${issuer} has an invalid session`,
            li(this.cause.message)
        ].join('\n');
    }
}
class InvalidSignature extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {API.Delegation} delegation
   * @param {API.Verifier} verifier
   */ constructor(delegation, verifier){
        super();
        this.name = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["the"])('InvalidSignature');
        this.delegation = delegation;
        this.verifier = verifier;
    }
    get issuer() {
        return this.delegation.issuer;
    }
    get audience() {
        return this.delegation.audience;
    }
    get key() {
        return this.verifier.toDIDKey();
    }
    describe() {
        const issuer = this.issuer.did();
        const key = this.key;
        return (issuer.startsWith('did:key') ? [
            `Proof ${this.delegation.cid} does not has a valid signature from ${key}`
        ] : [
            `Proof ${this.delegation.cid} issued by ${issuer} does not has a valid signature from ${key}`,
            `  â„¹ï¸ Probably issuer signed with a different key, which got rotated, invalidating delegations that were issued with prior keys`
        ]).join('\n');
    }
}
class UnavailableProof extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {API.UCAN.Link} link
   * @param {Error} [cause]
   */ constructor(link, cause){
        super();
        this.name = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["the"])('UnavailableProof');
        this.link = link;
        this.cause = cause;
    }
    describe() {
        return [
            `Linked proof '${this.link}' is not included and could not be resolved`,
            ...this.cause ? [
                li(`Proof resolution failed with: ${this.cause.message}`)
            ] : []
        ].join('\n');
    }
}
class DIDKeyResolutionError extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {API.UCAN.DID} did
   * @param {API.Failure} [cause]
   */ constructor(did, cause){
        super();
        this.name = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["the"])('DIDKeyResolutionError');
        this.did = did;
        this.cause = cause;
    }
    describe() {
        return `Unable to resolve '${this.did}' key`;
    }
}
class PrincipalAlignmentError extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {API.UCAN.Principal} audience
   * @param {API.Delegation} delegation
   */ constructor(audience, delegation){
        super();
        this.name = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["the"])('InvalidAudience');
        this.audience = audience;
        this.delegation = delegation;
    }
    describe() {
        return `Delegation audience is '${this.delegation.audience.did()}' instead of '${this.audience.did()}'`;
    }
    toJSON() {
        const { name, audience, message, stack } = this;
        return {
            name,
            audience: audience.did(),
            delegation: {
                audience: this.delegation.audience.did()
            },
            message,
            stack
        };
    }
}
class MalformedCapability extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {API.Capability} capability
   * @param {API.Failure} cause
   */ constructor(capability, cause){
        super();
        this.name = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["the"])('MalformedCapability');
        this.capability = capability;
        this.cause = cause;
    }
    describe() {
        return [
            `Encountered malformed '${this.capability.can}' capability: ${format(this.capability)}`,
            li(this.cause.message)
        ].join('\n');
    }
}
class UnknownCapability extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {API.Capability} capability
   */ constructor(capability){
        super();
        this.name = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["the"])('UnknownCapability');
        this.capability = capability;
    }
    /* c8 ignore next 3 */ describe() {
        return `Encountered unknown capability: ${format(this.capability)}`;
    }
}
class Expired extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {API.Delegation & { expiration: number }} delegation
   */ constructor(delegation){
        super();
        this.name = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["the"])('Expired');
        this.delegation = delegation;
    }
    describe() {
        return `Proof ${this.delegation.cid} has expired on ${new Date(this.delegation.expiration * 1000)}`;
    }
    get expiredAt() {
        return this.delegation.expiration;
    }
    toJSON() {
        const { name, expiredAt, message, stack } = this;
        return {
            name,
            message,
            expiredAt,
            stack
        };
    }
}
class Revoked extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {API.Delegation} delegation
   */ constructor(delegation){
        super();
        this.name = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["the"])('Revoked');
        this.delegation = delegation;
    }
    describe() {
        return `Proof ${this.delegation.cid} has been revoked`;
    }
    toJSON() {
        const { name, message, stack } = this;
        return {
            name,
            message,
            stack
        };
    }
}
class NotValidBefore extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {API.Delegation & { notBefore: number }} delegation
   */ constructor(delegation){
        super();
        this.name = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["the"])('NotValidBefore');
        this.delegation = delegation;
    }
    describe() {
        return `Proof ${this.delegation.cid} is not valid before ${new Date(this.delegation.notBefore * 1000)}`;
    }
    get validAt() {
        return this.delegation.notBefore;
    }
    toJSON() {
        const { name, validAt, message, stack } = this;
        return {
            name,
            message,
            validAt,
            stack
        };
    }
}
class Unauthorized extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {{
   * capability: API.CapabilityParser
   * delegationErrors: API.DelegationError[]
   * unknownCapabilities: API.Capability[]
   * invalidProofs: API.InvalidProof[]
   * failedProofs: API.InvalidClaim[]
   * }} cause
   */ constructor({ capability, delegationErrors, unknownCapabilities, invalidProofs, failedProofs }){
        super();
        this.name = 'Unauthorized';
        this.capability = capability;
        this.delegationErrors = delegationErrors;
        this.unknownCapabilities = unknownCapabilities;
        this.invalidProofs = invalidProofs;
        this.failedProofs = failedProofs;
    }
    describe() {
        const errors = [
            ...this.failedProofs.map((error)=>li(error.message)),
            ...this.delegationErrors.map((error)=>li(error.message)),
            ...this.invalidProofs.map((error)=>li(error.message))
        ];
        const unknown = this.unknownCapabilities.map((c)=>li(JSON.stringify(c)));
        return [
            `Claim ${this.capability} is not authorized`,
            ...errors.length > 0 ? errors : [
                li(`No matching delegated capability found`)
            ],
            ...unknown.length > 0 ? [
                li(`Encountered unknown capabilities\n${unknown.join('\n')}`)
            ] : []
        ].join('\n');
    }
}
/**
 * @param {unknown} capability
 * @param {string|number} [space]
 */ const format = (capability, space)=>JSON.stringify(capability, (_key, value)=>{
        /* c8 ignore next 2 */ if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$link$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isLink"])(value)) {
            return value.toString();
        } else {
            return value;
        }
    }, space);
const indent = (message, indent = '  ')=>`${indent}${message.split('\n').join(`\n${indent}`)}`;
const li = (message)=>indent(`- ${message}`);
}),
"[project]/node_modules/@ucanto/validator/src/capability.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "and",
    ()=>and,
    "capability",
    ()=>capability,
    "derive",
    ()=>derive,
    "or",
    ()=>or
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/validator/src/util.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/validator/src/error.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$invocation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/invocation.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/schema.js [app-client] (ecmascript) <export * as Schema>");
;
;
;
;
const capability = ({ derives = defaultDerives, nb = defaultNBSchema, ...etc })=>new Capability({
        derives,
        nb,
        ...etc
    });
const defaultNBSchema = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].struct({});
const or = (left, right)=>new Or(left, right);
const and = (...selectors)=>new And(selectors);
const derive = ({ from, to, derives })=>new Derive(from, to, derives);
/**
 * @template {API.Match} M
 * @implements {API.View<M>}
 */ class View {
    /**
   * @param {API.Source} source
   * @returns {API.MatchResult<M>}
   */ /* c8 ignore next 3 */ match(source) {
        return {
            error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["UnknownCapability"](source.capability)
        };
    }
    /**
   * @param {API.Source[]} capabilities
   * @returns {API.Select<M>}
   */ select(capabilities) {
        return select(this, capabilities);
    }
    /**
   * @template {API.ParsedCapability} U
   * @param {object} source
   * @param {API.TheCapabilityParser<API.DirectMatch<U>>} source.to
   * @param {API.Derives<U, API.InferDeriveProof<M['value']>>} source.derives
   * @returns {API.TheCapabilityParser<API.DerivedMatch<U, M>>}
   */ derive({ derives, to }) {
        return derive({
            derives,
            to,
            from: this
        });
    }
}
/**
 * @template {API.Match} M
 * @implements {API.CapabilityParser<M>}
 * @extends {View<M>}
 */ class Unit extends View {
    /**
   * @template {API.Match} W
   * @param {API.MatchSelector<W>} other
   * @returns {API.CapabilityParser<M | W>}
   */ or(other) {
        return or(this, other);
    }
    /**
   * @template {API.Match} W
   * @param {API.CapabilityParser<W>} other
   * @returns {API.CapabilitiesParser<[M, W]>}
   */ and(other) {
        return and(this, other);
    }
}
/**
 * @template {API.Ability} A
 * @template {API.URI} R
 * @template {API.Caveats} C
 * @implements {API.TheCapabilityParser<API.DirectMatch<API.ParsedCapability<A, R, C>>>}
 * @extends {Unit<API.DirectMatch<API.ParsedCapability<A, R, C>>>}
 */ class Capability extends Unit {
    /**
   * @param {Required<Descriptor<A, R, C>>} descriptor
   */ constructor(descriptor){
        super();
        this.descriptor = descriptor;
        this.schema = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].struct({
            can: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].literal(descriptor.can),
            with: descriptor.with,
            nb: descriptor.nb
        });
    }
    /**
   * @param {API.InferCreateOptions<R, C>} options
   */ create(options) {
        const { descriptor, can } = this;
        const decoders = descriptor.nb;
        const data = options.nb || {};
        const resource = descriptor.with.read(options.with);
        if (resource.error) {
            throw Object.assign(new Error(`Invalid 'with' - ${resource.error.message}`), {
                cause: resource
            });
        }
        const nb = descriptor.nb.read(data);
        if (nb.error) {
            throw Object.assign(new Error(`Invalid 'nb' - ${nb.error.message}`), {
                cause: nb
            });
        }
        return createCapability({
            can,
            with: resource.ok,
            nb: nb.ok
        });
    }
    /**
   * @param {API.InferInvokeOptions<R, C>} options
   */ invoke({ with: with_, nb, ...options }) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$invocation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["invoke"])({
            ...options,
            capability: this.create({
                with: with_,
                nb
            })
        });
    }
    /**
   * @param {API.InferDelegationOptions<R, C>} options
   * @returns {Promise<API.Delegation<[API.InferDelegatedCapability<API.ParsedCapability<A, R, C>>]>>}
   */ async delegate({ nb: input = {}, with: with_, ...options }) {
        const { descriptor, can } = this;
        const readers = descriptor.nb;
        const resource = descriptor.with.read(with_);
        if (resource.error) {
            throw Object.assign(new Error(`Invalid 'with' - ${resource.error.message}`), {
                cause: resource
            });
        }
        const nb = descriptor.nb.partial().read(input);
        if (nb.error) {
            throw Object.assign(new Error(`Invalid 'nb' - ${nb.error.message}`), {
                cause: nb
            });
        }
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["delegate"])({
            capabilities: [
                createCapability({
                    can,
                    with: resource.ok,
                    nb: nb.ok
                })
            ],
            ...options
        });
    }
    get can() {
        return this.descriptor.can;
    }
    /**
   * @param {API.Source} source
   * @returns {API.MatchResult<API.DirectMatch<API.ParsedCapability<A, R, C>>>}
   */ match(source) {
        const result = parseCapability(this.descriptor, source);
        return result.error ? result : {
            ok: new Match(source, result.ok, this.descriptor)
        };
    }
    toString() {
        return JSON.stringify({
            can: this.descriptor.can
        });
    }
}
/**
 * Normalizes capability by removing empty nb field.
 *
 * @template {API.ParsedCapability} T
 * @param {T} source
 */ const createCapability = ({ can, with: with_, nb })=>/** @type {API.InferCapability<T>} */ ({
        can,
        with: with_,
        ...isEmpty(nb) ? {} : {
            nb
        }
    });
/**
 * @param {object} object
 * @returns {object is {}}
 */ const isEmpty = (object)=>{
    for(const _ in object){
        return false;
    }
    return true;
};
/**
 * @template {API.Match} M
 * @template {API.Match} W
 * @implements {API.CapabilityParser<M|W>}
 * @extends {Unit<M|W>}
 */ class Or extends Unit {
    /**
   * @param {API.Matcher<M>} left
   * @param {API.Matcher<W>} right
   */ constructor(left, right){
        super();
        this.left = left;
        this.right = right;
    }
    /**
   * @param {API.Source} capability
   * @return {API.MatchResult<M|W>}
   */ match(capability) {
        const left = this.left.match(capability);
        if (left.error) {
            const right = this.right.match(capability);
            if (right.error) {
                return right.error.name === 'MalformedCapability' ? right : left;
            } else {
                return right;
            }
        } else {
            return left;
        }
    }
    toString() {
        return `${this.left.toString()}|${this.right.toString()}`;
    }
}
/**
 * @template {API.MatchSelector<API.Match>[]} Selectors
 * @implements {API.CapabilitiesParser<API.InferMembers<Selectors>>}
 * @extends {View<API.Amplify<API.InferMembers<Selectors>>>}
 */ class And extends View {
    /**
   * @param {Selectors} selectors
   */ constructor(selectors){
        super();
        this.selectors = selectors;
    }
    /**
   * @param {API.Source} capability
   * @returns {API.MatchResult<API.Amplify<API.InferMembers<Selectors>>>}
   */ match(capability) {
        const group = [];
        for (const selector of this.selectors){
            const result = selector.match(capability);
            if (result.error) {
                return result;
            } else {
                group.push(result.ok);
            }
        }
        return {
            ok: new AndMatch(group)
        };
    }
    /**
   * @param {API.Source[]} capabilities
   */ select(capabilities) {
        return selectGroup(this, capabilities);
    }
    /**
   * @template E
   * @template {API.Match} X
   * @param {API.MatchSelector<API.Match<E, X>>} other
   * @returns {API.CapabilitiesParser<[...API.InferMembers<Selectors>, API.Match<E, X>]>}
   */ and(other) {
        return new And([
            ...this.selectors,
            other
        ]);
    }
    toString() {
        return `[${this.selectors.map(String).join(', ')}]`;
    }
}
/**
 * @template {API.ParsedCapability} T
 * @template {API.Match} M
 * @implements {API.TheCapabilityParser<API.DerivedMatch<T, M>>}
 * @extends {Unit<API.DerivedMatch<T, M>>}
 */ class Derive extends Unit {
    /**
   * @param {API.MatchSelector<M>} from
   * @param {API.TheCapabilityParser<API.DirectMatch<T>>} to
   * @param {API.Derives<T, API.InferDeriveProof<M['value']>>} derives
   */ constructor(from, to, derives){
        super();
        this.from = from;
        this.to = to;
        this.derives = derives;
    }
    /**
   * @type {typeof this.to['create']}
   */ create(options) {
        return this.to.create(options);
    }
    /**
   * @type {typeof this.to['invoke']}
   */ invoke(options) {
        return this.to.invoke(options);
    }
    /**
   * @type {typeof this.to['delegate']}
   */ delegate(options) {
        return this.to.delegate(options);
    }
    get can() {
        return this.to.can;
    }
    /**
   * @param {API.Source} capability
   * @returns {API.MatchResult<API.DerivedMatch<T, M>>}
   */ match(capability) {
        const match = this.to.match(capability);
        if (match.error) {
            return match;
        } else {
            return {
                ok: new DerivedMatch(match.ok, this.from, this.derives)
            };
        }
    }
    toString() {
        return this.to.toString();
    }
}
/**
 * @template {API.Ability} A
 * @template {API.URI} R
 * @template {API.Caveats} C
 * @implements {API.DirectMatch<API.ParsedCapability<A, R, C>>}
 */ class Match {
    /**
   * @param {API.Source} source
   * @param {API.ParsedCapability<A, R, C>} value
   * @param {Required<Descriptor<A, R, C>>} descriptor
   */ constructor(source, value, descriptor){
        this.source = [
            source
        ];
        this.value = value;
        this.descriptor = descriptor;
    }
    get can() {
        return this.value.can;
    }
    get proofs() {
        const proofs = [
            this.source[0].delegation
        ];
        Object.defineProperties(this, {
            proofs: {
                value: proofs
            }
        });
        return proofs;
    }
    /**
   * @param {API.CanIssue} context
   * @returns {API.DirectMatch<API.ParsedCapability<A, R, C>>|null}
   */ prune(context) {
        if (context.canIssue(this.value, this.source[0].delegation.issuer.did())) {
            return null;
        } else {
            return this;
        }
    }
    /**
   * @param {API.Source[]} capabilities
   * @returns {API.Select<API.DirectMatch<API.ParsedCapability<A, R, C>>>}
   */ select(capabilities) {
        const unknown = [];
        const errors = [];
        const matches = [];
        for (const capability of capabilities){
            const result = resolveCapability(this.descriptor, this.value, capability);
            if (result.ok) {
                const claim = this.descriptor.derives(this.value, result.ok);
                if (claim.error) {
                    errors.push(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["DelegationError"]([
                        new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["EscalatedCapability"](this.value, result.ok, claim.error)
                    ], this));
                } else {
                    matches.push(new Match(capability, result.ok, this.descriptor));
                }
            } else {
                switch(result.error.name){
                    case 'UnknownCapability':
                        unknown.push(result.error.capability);
                        break;
                    case 'MalformedCapability':
                    default:
                        errors.push(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["DelegationError"]([
                            result.error
                        ], this));
                }
            }
        }
        return {
            matches,
            unknown,
            errors
        };
    }
    toString() {
        const { nb } = this.value;
        return JSON.stringify({
            can: this.descriptor.can,
            with: this.value.with,
            nb: nb && Object.keys(nb).length > 0 ? nb : undefined
        });
    }
}
/**
 * @template {API.ParsedCapability} T
 * @template {API.Match} M
 * @implements {API.DerivedMatch<T, M>}
 */ class DerivedMatch {
    /**
   * @param {API.DirectMatch<T>} selected
   * @param {API.MatchSelector<M>} from
   * @param {API.Derives<T, API.InferDeriveProof<M['value']>>} derives
   */ constructor(selected, from, derives){
        this.selected = selected;
        this.from = from;
        this.derives = derives;
    }
    get can() {
        return this.value.can;
    }
    get source() {
        return this.selected.source;
    }
    get proofs() {
        const proofs = [];
        for (const { delegation } of this.selected.source){
            proofs.push(delegation);
        }
        Object.defineProperties(this, {
            proofs: {
                value: proofs
            }
        });
        return proofs;
    }
    get value() {
        return this.selected.value;
    }
    /**
   * @param {API.CanIssue} context
   */ prune(context) {
        const selected = this.selected.prune(context);
        return selected ? new DerivedMatch(selected, this.from, this.derives) : null;
    }
    /**
   * @param {API.Source[]} capabilities
   */ select(capabilities) {
        const { derives, selected, from } = this;
        const { value } = selected;
        const direct = selected.select(capabilities);
        const derived = from.select(capabilities);
        const matches = [];
        const errors = [];
        for (const match of derived.matches){
            // If capability can not be derived it escalates
            const result = derives(value, match.value);
            if (result.error) {
                errors.push(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["DelegationError"]([
                    new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["EscalatedCapability"](value, match.value, result.error)
                ], this));
            } else {
                matches.push(match);
            }
        }
        return {
            unknown: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["intersection"])(direct.unknown, derived.unknown),
            errors: [
                ...errors,
                ...direct.errors,
                ...derived.errors.map((error)=>new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["DelegationError"]([
                        error
                    ], this))
            ],
            matches: [
                ...direct.matches.map((match)=>new DerivedMatch(match, from, derives)),
                ...matches
            ]
        };
    }
    toString() {
        return this.selected.toString();
    }
}
/**
 * @template {API.MatchSelector<API.Match>[]} Selectors
 * @implements {API.Amplify<API.InferMembers<Selectors>>}
 */ class AndMatch {
    /**
   * @param {API.Match[]} matches
   */ constructor(matches){
        this.matches = matches;
    }
    get selectors() {
        return this.matches;
    }
    /**
   * @returns {API.Source[]}
   */ get source() {
        const source = [];
        for (const match of this.matches){
            source.push(...match.source);
        }
        Object.defineProperties(this, {
            source: {
                value: source
            }
        });
        return source;
    }
    /**
   * @param {API.CanIssue} context
   */ prune(context) {
        const matches = [];
        for (const match of this.matches){
            const pruned = match.prune(context);
            if (pruned) {
                matches.push(pruned);
            }
        }
        return matches.length === 0 ? null : new AndMatch(matches);
    }
    get proofs() {
        const proofs = [];
        for (const { delegation } of this.source){
            proofs.push(delegation);
        }
        Object.defineProperties(this, {
            proofs: {
                value: proofs
            }
        });
        return proofs;
    }
    /**
   * @type {API.InferValue<API.InferMembers<Selectors>>}
   */ get value() {
        const value = [];
        for (const match of this.matches){
            value.push(match.value);
        }
        Object.defineProperties(this, {
            value: {
                value
            }
        });
        return value;
    }
    /**
   * @param {API.Source[]} capabilities
   */ select(capabilities) {
        return selectGroup(this, capabilities);
    }
    toString() {
        return `[${this.matches.map((match)=>match.toString()).join(', ')}]`;
    }
}
/**
 * Resolves ability `pattern` of the delegated capability from the ability
 * of the claimed capability. If pattern matches returns claimed ability
 * otherwise returns given `fallback`.
 *
 * @example
 * ```js
 * resolveAbility('*', 'store/add', null) // => 'store/add'
 * resolveAbility('store/*', 'store/add', null) // => 'store/add'
 * resolveAbility('store/add', 'store/add', null) // => 'store/add'
 * resolveAbility('store/', 'store/add', null) // => null
 * resolveAbility('store/a*', 'store/add', null) // => null
 * resolveAbility('store/list', 'store/add', null) // => null
 * ```
 *
 * @template {API.Ability} T
 * @template U
 * @param {string} pattern
 * @param {T} can
 * @param {U} fallback
 * @returns {T|U}
 */ const resolveAbility = (pattern, can, fallback)=>{
    switch(pattern){
        case can:
        case '*':
            return can;
        default:
            return pattern.endsWith('/*') && can.startsWith(pattern.slice(0, -1)) ? can : fallback;
    }
};
/**
 * Resolves `source` resource of the delegated capability from the resource
 * `uri` of the claimed capability. If `source` is `"ucan:*""` or matches `uri`
 * then it returns `uri` back otherwise it returns `fallback`.
 *
 * @example
 * ```js
 * resolveResource('ucan:*', 'did:key:zAlice', null) // => 'did:key:zAlice'
 * resolveAbility('ucan:*', 'https://example.com', null) // => 'https://example.com'
 * resolveAbility('did:*', 'did:key:zAlice', null) // => null
 * resolveAbility('did:key:zAlice', 'did:key:zAlice', null) // => did:key:zAlice
 * ```
 * @template {string} T
 * @template U
 * @param {T} uri
 * @param {string} source
 * @param {U} fallback
 * @returns {T|U}
 */ const resolveResource = (source, uri, fallback)=>{
    switch(source){
        case uri:
        case 'ucan:*':
            return uri;
        default:
            return fallback;
    }
};
/**
 * Parses capability from the `source` using a provided `parser`.
 *
 * @template {API.Ability} A
 * @template {API.URI} R
 * @template {API.Caveats} C
 * @param {Required<Descriptor<A, R, C>>} descriptor
 * @param {API.Source} source
 * @returns {API.Result<API.ParsedCapability<A, R, C>, API.InvalidCapability>}
 */ const parseCapability = (descriptor, source)=>{
    const { delegation } = source;
    const capability = source.capability;
    if (descriptor.can !== capability.can) {
        return {
            error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["UnknownCapability"](capability)
        };
    }
    const uri = descriptor.with.read(capability.with);
    if (uri.error) {
        return {
            error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["MalformedCapability"](capability, uri.error)
        };
    }
    const nb = descriptor.nb.read(capability.nb || {});
    if (nb.error) {
        return {
            error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["MalformedCapability"](capability, nb.error)
        };
    }
    return {
        ok: new CapabilityView(descriptor.can, uri.ok, nb.ok, delegation)
    };
};
/**
 * Resolves delegated capability `source` from the `claimed` capability using
 * provided capability `parser`. It is similar to `parseCapability` except
 * `source` here is treated as capability pattern which is matched against the
 * `claimed` capability. This means we resolve `can` and `with` fields from the
 * `claimed` capability and inherit all missing `nb` fields from the claimed
 * capability.
 *
 * @template {API.Ability} A
 * @template {API.URI} R
 * @template {API.Caveats} C
 * @param {Required<Descriptor<A, R, C>>} descriptor
 * @param {API.ParsedCapability<A, R, C>} claimed
 * @param {API.Source} source
 * @returns {API.Result<API.ParsedCapability<A, R, C>, API.InvalidCapability>}
 */ const resolveCapability = (descriptor, claimed, { capability, delegation })=>{
    const can = resolveAbility(capability.can, claimed.can, null);
    if (can == null) {
        return {
            error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["UnknownCapability"](capability)
        };
    }
    const resource = resolveResource(capability.with, claimed.with, capability.with);
    const uri = descriptor.with.read(resource);
    if (uri.error) {
        return {
            error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["MalformedCapability"](capability, uri.error)
        };
    }
    const nb = descriptor.nb.read({
        ...claimed.nb,
        ...capability.nb
    });
    if (nb.error) {
        return {
            error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["MalformedCapability"](capability, nb.error)
        };
    }
    return {
        ok: new CapabilityView(can, uri.ok, nb.ok, delegation)
    };
};
/**
 * @template {API.Ability} A
 * @template {API.URI} R
 * @template C
 */ class CapabilityView {
    /**
   * @param {A} can
   * @param {R} with_
   * @param {C} nb
   * @param {API.Delegation} delegation
   */ constructor(can, with_, nb, delegation){
        this.can = can;
        this.with = with_;
        this.delegation = delegation;
        this.nb = nb;
    }
}
/**
 * @template {API.Match} M
 * @param {API.Matcher<M>} matcher
 * @param {API.Source[]} capabilities
 * @returns {API.Select<M>}
 */ const select = (matcher, capabilities)=>{
    const unknown = [];
    const matches = [];
    const errors = [];
    for (const capability of capabilities){
        const result = matcher.match(capability);
        if (result.error) {
            switch(result.error.name){
                case 'UnknownCapability':
                    unknown.push(result.error.capability);
                    break;
                case 'MalformedCapability':
                default:
                    errors.push(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["DelegationError"]([
                        result.error
                    ], result.error.capability));
            }
        } else {
            matches.push(result.ok);
        }
    }
    return {
        matches,
        errors,
        unknown
    };
};
/**
 * @template {API.Selector<API.Match>[]} S
 * @param {{selectors:S}} self
 * @param {API.Source[]} capabilities
 */ const selectGroup = (self, capabilities)=>{
    let unknown;
    const data = [];
    const errors = [];
    for (const selector of self.selectors){
        const selected = selector.select(capabilities);
        unknown = unknown ? (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["intersection"])(unknown, selected.unknown) : selected.unknown;
        for (const error of selected.errors){
            errors.push(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["DelegationError"]([
                error
            ], self));
        }
        data.push(selected.matches);
    }
    const matches = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["combine"])(data).map((group)=>new AndMatch(group));
    return {
        unknown: /* c8 ignore next */ unknown || [],
        errors,
        matches
    };
};
/**
 * @template {API.ParsedCapability} T
 * @template {API.ParsedCapability} U
 * @param {T} claimed
 * @param {U} delegated
 * @return {API.Result<true, API.Failure>}
 */ const defaultDerives = (claimed, delegated)=>{
    if (delegated.with.endsWith('*')) {
        if (!claimed.with.startsWith(delegated.with.slice(0, -1))) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].error(`Resource ${claimed.with} does not match delegated ${delegated.with} `);
        }
    } else if (delegated.with !== claimed.with) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].error(`Resource ${claimed.with} is not contained by ${delegated.with}`);
    }
    /* c8 ignore next 2 */ const caveats = delegated.nb || {};
    const nb = claimed.nb || {};
    const kv = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$util$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["entries"])(caveats);
    for (const [name, value] of kv){
        if (nb[name] != value) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Schema$3e$__["Schema"].error(`${String(name)}: ${nb[name]} violates ${value}`);
        }
    }
    return {
        ok: true
    };
};
}),
"[project]/node_modules/@ucanto/validator/src/authorization.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "create",
    ()=>create,
    "iterate",
    ()=>iterate
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
;
/**
 * @template {API.ParsedCapability} C
 * @implements {API.Authorization<C>}
 */ class Authorization {
    /**
   * @param {API.Match<C>} match
   * @param {API.Authorization<API.ParsedCapability>[]} proofs
   */ constructor(match, proofs){
        this.match = match;
        this.proofs = proofs;
    }
    get capability() {
        return this.match.value;
    }
    get delegation() {
        return this.match.source[0].delegation;
    }
    get issuer() {
        return this.delegation.issuer;
    }
    get audience() {
        return this.delegation.audience;
    }
}
const create = (match, proofs = [])=>new Authorization(match, proofs);
const iterate = function*({ delegation, proofs }) {
    yield delegation.cid;
    for (const proof of proofs){
        yield* iterate(proof);
    }
};
}),
"[project]/node_modules/@ucanto/validator/src/lib.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "access",
    ()=>access,
    "authorize",
    ()=>authorize,
    "claim",
    ()=>claim
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__UCAN$3e$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/lib.js [app-client] (ecmascript) <export * as UCAN>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/result.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$capability$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/validator/src/capability.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/schema.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/schema.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/schema/schema.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2f$link$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__$3c$export__match__as__link$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/schema/link.js [app-client] (ecmascript) <locals> <export match as link>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$authorization$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/validator/src/authorization.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/validator/src/error.js [app-client] (ecmascript) <locals>");
;
;
;
;
;
;
;
;
;
/**
 * @param {UCAN.Link} proof
 * @returns {{error:API.UnavailableProof}}
 */ const unavailable = (proof)=>({
        error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["UnavailableProof"](proof)
    });
/**
 *
 * @param {UCAN.DID} did
 * @returns {{error:API.DIDKeyResolutionError}}
 */ const failDIDKeyResolution = (did)=>({
        error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["DIDKeyResolutionError"](did)
    });
/**
 * @param {Required<API.ClaimOptions>} config
 * @param {API.Match<unknown, API.Match>} match
 */ const resolveMatch = async (match, config)=>{
    const promises = [];
    const includes = new Set();
    for (const source of match.source){
        const id = source.delegation.cid.toString();
        if (!includes.has(id)) {
            promises.push(await resolveSources(source, config));
        }
    }
    const groups = await Promise.all(promises);
    const sources = [];
    const errors = [];
    for (const group of groups){
        sources.push(...group.sources);
        errors.push(...group.errors);
    }
    return {
        sources,
        errors
    };
};
/**
 * Takes `proofs` from the delegation which may contain `Delegation` or a link
 * to one and attempts to resolve links by side loading them. Returns set of
 * resolved `Delegation`s and errors for the proofs that could not be resolved.
 *
 * @param {API.Proof[]} proofs
 * @param {Required<API.ProofResolver>} config
 */ const resolveProofs = async (proofs, config)=>{
    /** @type {API.Delegation[]} */ const delegations = [];
    /** @type {API.UnavailableProof[]} */ const errors = [];
    const promises = [];
    for (const proof of proofs){
        // If it is a delegation we can just add it to the resolved set.
        if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isDelegation"])(proof)) {
            delegations.push(proof);
        } else {
            promises.push(new Promise(async (resolve)=>{
                // config.resolve is not supposed to throw, but we catch it just in
                // case it does and consider proof resolution failed.
                try {
                    const result = await config.resolve(proof);
                    if (result.error) {
                        errors.push(result.error);
                    } else {
                        delegations.push(result.ok);
                    }
                } catch (error) {
                    errors.push(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["UnavailableProof"](proof, error));
                }
                // we don't care about the result, we just need to signal that we are
                // done with this promise.
                resolve(null);
            }));
        }
    }
    // Wait for all the promises to resolve. At this point we have collected all
    // the resolved delegations and errors.
    await Promise.all(promises);
    return {
        delegations,
        errors
    };
};
/**
 * Takes a delegation source and attempts to resolve all the linked proofs.
 *
 * @param {API.Source} from
 * @param {Required<API.ClaimOptions>} config
 * @return {Promise<{sources:API.Source[], errors:ProofError[]}>}
 */ const resolveSources = async ({ delegation }, config)=>{
    const errors = [];
    const sources = [];
    const proofs = [];
    // First we attempt to resolve all the linked proofs.
    const { delegations, errors: failedProofs } = await resolveProofs(delegation.proofs, config);
    // All the proofs that failed to resolve are saved as proof errors.
    for (const error of failedProofs){
        errors.push(new ProofError(error.link, error));
    }
    // All the proofs that resolved are checked for principal alignment. Ones that
    // do not align are saved as proof errors.
    for (const proof of delegations){
        // If proof does not delegate to a matching audience save an proof error.
        if (delegation.issuer.did() !== proof.audience.did()) {
            errors.push(new ProofError(proof.cid, new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["PrincipalAlignmentError"](delegation.issuer, proof)));
        } else {
            proofs.push(proof);
        }
    }
    // In the second pass we attempt to proofs that were resolved and are aligned.
    for (const proof of proofs){
        // If proof is not valid (expired, not active yet or has incorrect
        // signature) save a corresponding proof error.
        const validation = await validate(proof, proofs, config);
        if (validation.error) {
            errors.push(new ProofError(proof.cid, validation.error));
        } else {
            // otherwise create source objects for it's capabilities, so we could
            // track which proof in which capability the are from.
            for (const capability of proof.capabilities){
                sources.push({
                    capability,
                    delegation: proof
                });
            }
        }
    }
    return {
        sources,
        errors
    };
};
/**
 * @param {API.ParsedCapability} capability
 * @param {API.DID} issuer
 */ const isSelfIssued = (capability, issuer)=>capability.with === issuer;
const access = async (invocation, { capability, ...config })=>claim(capability, [
        invocation
    ], config);
const claim = async (capability, proofs, { authority, principal, validateAuthorization, resolveDIDKey = failDIDKeyResolution, canIssue = isSelfIssued, resolve = unavailable, proofs: localProofs = [] })=>{
    const config = {
        canIssue,
        resolve,
        principal,
        capability,
        authority,
        validateAuthorization,
        resolveDIDKey,
        proofs: localProofs
    };
    const invalidProofs = [];
    /** @type {API.Source[]} */ const sources = [];
    const { delegations, errors } = await resolveProofs(proofs, config);
    invalidProofs.push(...errors);
    for (const proof of delegations){
        // Validate each proof if valid add ech capability to the list of sources.
        // otherwise collect the error.
        const validation = await validate(proof, delegations, config);
        if (validation.ok) {
            for (const capability of validation.ok.capabilities.values()){
                sources.push({
                    capability,
                    delegation: validation.ok
                });
            }
        } else {
            invalidProofs.push(validation.error);
        }
    }
    // look for the matching capability
    const selection = capability.select(sources);
    const { errors: delegationErrors, unknown: unknownCapabilities } = selection;
    const failedProofs = [];
    for (const matched of selection.matches){
        const selector = matched.prune(config);
        if (selector == null) {
            const authorization = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$authorization$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["create"](matched, []);
            const result = await validateAuthorization(authorization);
            if (result.error) {
                invalidProofs.push(result.error);
            } else {
                return {
                    ok: authorization
                };
            }
        } else {
            const result = await authorize(selector, config);
            if (result.error) {
                failedProofs.push(result.error);
            } else {
                const authorization = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$authorization$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["create"](matched, [
                    result.ok
                ]);
                const approval = await validateAuthorization(authorization);
                if (approval.error) {
                    invalidProofs.push(approval.error);
                } else {
                    return {
                        ok: authorization
                    };
                }
            }
        }
    }
    return {
        error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["Unauthorized"]({
            capability,
            delegationErrors,
            unknownCapabilities,
            invalidProofs,
            failedProofs
        })
    };
};
const authorize = async (match, config)=>{
    // load proofs from all delegations
    const { sources, errors: invalidProofs } = await resolveMatch(match, config);
    const selection = match.select(sources);
    const { errors: delegationErrors, unknown: unknownCapabilities } = selection;
    const failedProofs = [];
    for (const matched of selection.matches){
        const selector = matched.prune(config);
        if (selector == null) {
            return {
                ok: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$authorization$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["create"](// @ts-expect-error - it may not be a parsed capability but rather a
                // group of capabilities but we can deal with that in the future.
                matched, [])
            };
        } else {
            const result = await authorize(selector, config);
            if (result.error) {
                failedProofs.push(result.error);
            } else {
                return {
                    ok: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$authorization$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["create"](// @ts-expect-error - it may not be a parsed capability but rather a
                    // group of capabilities but we can deal with that in the future.
                    matched, [
                        result.ok
                    ])
                };
            }
        }
    }
    return {
        error: new InvalidClaim({
            match,
            delegationErrors,
            unknownCapabilities,
            invalidProofs,
            failedProofs
        })
    };
};
class ProofError extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {API.UCANLink} proof
   * @param {API.Failure} cause
   */ constructor(proof, cause){
        super();
        this.name = 'ProofError';
        this.proof = proof;
        this.cause = cause;
    }
    describe() {
        return [
            `Capability can not be derived from prf:${this.proof} because:`,
            (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["li"])(this.cause.message)
        ].join(`\n`);
    }
}
/**
 * @implements {API.InvalidClaim}
 */ class InvalidClaim extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Failure"] {
    /**
   * @param {{
   * match: API.Match
   * delegationErrors: API.DelegationError[]
   * unknownCapabilities: API.Capability[]
   * invalidProofs: ProofError[]
   * failedProofs: API.InvalidClaim[]
   * }} info
   */ constructor(info){
        super();
        this.info = info;
        this.name = 'InvalidClaim';
    }
    get issuer() {
        return this.delegation.issuer;
    }
    get delegation() {
        return this.info.match.source[0].delegation;
    }
    describe() {
        const errors = [
            ...this.info.failedProofs.map((error)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["li"])(error.message)),
            ...this.info.delegationErrors.map((error)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["li"])(error.message)),
            ...this.info.invalidProofs.map((error)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["li"])(error.message))
        ];
        const unknown = this.info.unknownCapabilities.map((c)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["li"])(JSON.stringify(c)));
        return [
            `Capability ${this.info.match} is not authorized because:`,
            (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["li"])(`Capability can not be (self) issued by '${this.issuer.did()}'`),
            ...errors.length > 0 ? errors : [
                (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["li"])(`Delegated capability not found`)
            ],
            ...unknown.length > 0 ? [
                (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["li"])(`Encountered unknown capabilities\n${unknown.join('\n')}`)
            ] : []
        ].join('\n');
    }
}
/**
 * Validate a delegation to check it is within the time bound and that it is
 * authorized by the issuer.
 *
 * @template {API.Delegation} T
 * @param {T} delegation
 * @param {API.Delegation[]} proofs
 * @param {Required<API.ClaimOptions>} config
 * @returns {Promise<API.Result<T, API.InvalidProof|API.SessionEscalation|API.DIDKeyResolutionError>>}
 */ const validate = async (delegation, proofs, config)=>{
    if (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__UCAN$3e$__["UCAN"].isExpired(delegation.data)) {
        return {
            error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["Expired"](delegation)
        };
    }
    if (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__UCAN$3e$__["UCAN"].isTooEarly(delegation.data)) {
        return {
            error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["NotValidBefore"](delegation)
        };
    }
    return await verifyAuthorization(delegation, proofs, config);
};
/**
 * Verifies that delegation has been authorized by the issuer. If issued by the
 * did:key principal checks that the signature is valid. If issued by the root
 * authority checks that the signature is valid. If issued by the principal
 * identified by other DID method attempts to resolve a valid `ucan/attest`
 * attestation from the authority, if attestation is not found falls back to
 * resolving did:key for the issuer and verifying its signature.
 *
 * @template {API.Delegation} T
 * @param {T} delegation
 * @param {API.Delegation[]} proofs
 * @param {Required<API.ClaimOptions>} config
 * @returns {Promise<API.Result<T, API.InvalidSignature|API.SessionEscalation|API.DIDKeyResolutionError>>}
 */ const verifyAuthorization = async (delegation, proofs, config)=>{
    const issuer = delegation.issuer.did();
    // If the issuer is a did:key we just verify a signature
    if (issuer.startsWith('did:key:')) {
        return verifySignature(delegation, config.principal.parse(issuer));
    } else if (issuer === config.authority.did()) {
        return verifySignature(delegation, config.authority);
    } else {
        // If issuer is not a did:key principal nor configured authority, we
        // attempt to resolve embedded authorization session from the authority.
        const session = await verifySession(delegation, proofs, config);
        // If we have valid session we consider authorization valid
        if (session.ok) {
            return {
                ok: delegation
            };
        } else if (session.error.failedProofs.length > 0) {
            return {
                error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["SessionEscalation"]({
                    delegation,
                    cause: session.error
                })
            };
        } else {
            const result = await config.resolveDIDKey(issuer);
            if (result.error) {
                return result;
            }
            const verifiers = result.ok;
            /** @type {(API.InvalidSignature | API.DIDKeyResolutionError)[]} */ const verificationErrResults = [];
            for (const verifier of verifiers){
                const verificationResult = await verifySignature(delegation, config.principal.parse(verifier).withDID(issuer));
                if (verificationResult.ok) {
                    return verificationResult;
                }
                if (verificationResult.error) {
                    verificationErrResults.push(verificationResult.error);
                }
            }
            // If no verifiers were found, there is no way to verify the signature
            if (verificationErrResults.length === 0) {
                return {
                    error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["DIDKeyResolutionError"](issuer)
                };
            }
            const combinedError = verificationErrResults[0];
            const combinedMessage = verificationErrResults.map((err)=>err.message).join('\n  ');
            // @ts-expect-error - both error types have describe method, override it to return the concatenated message
            combinedError.describe = ()=>combinedMessage;
            return {
                error: combinedError
            };
        }
    }
};
/**
 * @template {API.Delegation} T
 * @param {T} delegation
 * @param {API.Verifier} verifier
 * @returns {Promise<API.Result<T, API.InvalidSignature|API.DIDKeyResolutionError>>}
 */ const verifySignature = async (delegation, verifier)=>{
    const valid = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__UCAN$3e$__["UCAN"].verifySignature(delegation.data, verifier);
    return valid ? {
        ok: delegation
    } : {
        error: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$error$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["InvalidSignature"](delegation, verifier)
    };
};
/**
 * Attempts to find an authorization session - an `ucan/attest` capability
 * delegation where `with` matches `config.authority` and `nb.proof`
 * matches given delegation.
 * @see https://github.com/storacha/specs/blob/feat/auth+account/w3-session.md#authorization-session
 *
 * @param {API.Delegation} delegation
 * @param {API.Delegation[]} proofs
 * @param {Required<API.ClaimOptions>} config
 */ const verifySession = async (delegation, proofs, config)=>{
    // Recognize attestations from all authorized principals, not just authority
    const withSchemas = config.proofs.filter((p)=>p.capabilities[0].can === 'ucan/attest' && p.capabilities[0].with === config.authority.did()).map((p)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["literal"](p.audience.did()));
    const withSchema = withSchemas.length ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["union"]([
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["literal"](config.authority.did()),
        ...withSchemas
    ]) : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["literal"](config.authority.did());
    // Create a schema that will match an authorization for this exact delegation
    const attestation = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$validator$2f$src$2f$capability$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["capability"])({
        with: withSchema,
        can: 'ucan/attest',
        nb: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2f$schema$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["struct"]({
            proof: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$schema$2f$link$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__$3c$export__match__as__link$3e$__["link"](delegation.cid)
        })
    });
    return await claim(attestation, proofs// We only consider attestations otherwise we will end up doing an
    // exponential scan if there are other proofs that require attestations.
    .filter(isAttestation)// Also filter any proofs that _are_ the delegation we're verifying so
    // we don't recurse indefinitely.
    .filter((p)=>p.cid.toString() !== delegation.cid.toString()), config);
};
/**
 * Checks if the delegation is an attestation.
 *
 * @param {API.Delegation} proof
 */ const isAttestation = (proof)=>proof.capabilities[0]?.can === 'ucan/attest';
}),
"[project]/node_modules/@ucanto/principal/src/ed25519/type.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
}),
"[project]/node_modules/@ucanto/principal/src/verifier.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "or",
    ()=>or,
    "withDID",
    ()=>withDID
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
;
/**
 * @param {API.DID} did
 * @param {API.PrincipalParser[]} parsers
 * @return {API.Verifier}
 */ const parseWith = (did, parsers)=>{
    if (did.startsWith('did:')) {
        for (const parser of parsers){
            try {
                return parser.parse(did);
            } catch (_) {}
        }
        throw new Error(`Unsupported did ${did}`);
    } else {
        throw new Error(`Expected did instead got ${did}`);
    }
};
const or = (left, right)=>new Parser([
        left,
        right
    ]);
/**
 * @implements {API.ComposedDIDParser}
 */ class Parser {
    /**
   * @param {API.PrincipalParser[]} variants
   */ constructor(variants){
        this.variants = variants;
    }
    /**
   * @param {API.DID} did
   */ parse(did) {
        return parseWith(did, this.variants);
    }
    /**
   * @param {API.PrincipalParser} parser
   */ or(parser) {
        return new Parser([
            ...this.variants,
            parser
        ]);
    }
}
const withDID = (key, id)=>new VerifierWithDID(id, key);
/**
 * @template {API.DID} ID
 * @template {API.MulticodecCode} SigAlg
 * @implements {API.Verifier<ID, SigAlg>}
 */ class VerifierWithDID {
    /**
   * @param {ID} id
   * @param {API.VerifierKey<SigAlg>} key
   */ constructor(id, key){
        this.id = id;
        this.key = key;
    }
    did() {
        return this.id;
    }
    toDIDKey() {
        return this.key.toDIDKey();
    }
    /**
   * @template T
   * @param {API.ByteView<T>} payload
   * @param {API.Signature<T, SigAlg>} signature
   * @returns {API.Await<boolean>}
   */ verify(payload, signature) {
        return this.key.verify(payload, signature);
    }
    /**
   * @template {API.DID} ID
   * @param {ID} id
   */ withDID(id) {
        return withDID(this.key, id);
    }
}
}),
"[project]/node_modules/@ucanto/principal/src/ed25519/verifier.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "code",
    ()=>code,
    "decode",
    ()=>decode,
    "encode",
    ()=>encode,
    "format",
    ()=>format,
    "name",
    ()=>name,
    "or",
    ()=>or,
    "parse",
    ()=>parse,
    "signatureAlgorithm",
    ()=>signatureAlgorithm,
    "signatureCode",
    ()=>signatureCode
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/did.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$noble$2f$ed25519$2f$lib$2f$esm$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@noble/ed25519/lib/esm/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/varint.js [app-client] (ecmascript) <export * as varint>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$type$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/type.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/signature.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base58$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/bases/base58.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/verifier.js [app-client] (ecmascript)");
;
;
;
;
;
;
;
const code = 0xed;
const name = 'Ed25519';
const signatureCode = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EdDSA"];
const signatureAlgorithm = 'EdDSA';
const PUBLIC_TAG_SIZE = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].encodingLength(code);
const SIZE = 32 + PUBLIC_TAG_SIZE;
const parse = (did)=>decode(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["parse"](did));
const decode = (bytes)=>{
    const [algorithm] = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].decode(bytes);
    if (algorithm !== code) {
        throw new RangeError(`Unsupported key algorithm with multicode 0x${code.toString(16)}`);
    } else if (bytes.byteLength !== SIZE) {
        throw new RangeError(`Expected Uint8Array with byteLength ${SIZE}, instead got Uint8Array with byteLength ${bytes.byteLength}`);
    } else {
        return new Ed25519Verifier(bytes.buffer, bytes.byteOffset, bytes.byteLength);
    }
};
const format = (principal)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["format"](principal);
const encode = (principal)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encode"](principal);
/**
 * @implements {API.EdVerifier}
 */ class Ed25519Verifier extends Uint8Array {
    /** @type {typeof code} */ get code() {
        return code;
    }
    /** @type {typeof signatureCode} */ get signatureCode() {
        return signatureCode;
    }
    /** @type {typeof signatureAlgorithm} */ get signatureAlgorithm() {
        return signatureAlgorithm;
    }
    /**
   * Raw public key without a multiformat code.
   *
   * @readonly
   */ get publicKey() {
        const key = new Uint8Array(this.buffer, this.byteOffset + PUBLIC_TAG_SIZE);
        Object.defineProperties(this, {
            publicKey: {
                value: key
            }
        });
        return key;
    }
    /**
   * DID of the Principal in `did:key` format.
   * @returns {API.DID<"key">}
   */ did() {
        return `did:key:${__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base58$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base58btc"].encode(this)}`;
    }
    /**
   * @template T
   * @param {API.ByteView<T>} payload
   * @param {API.Signature<T, Signature.EdDSA>} signature
   * @returns {API.Await<boolean>}
   */ verify(payload, signature) {
        return signature.code === signatureCode && __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$noble$2f$ed25519$2f$lib$2f$esm$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["verify"](signature.raw, payload, this.publicKey);
    }
    /**
   * @template {API.DID} ID
   * @param {ID} id
   * @returns {API.Verifier<ID, typeof signatureCode>}
   */ withDID(id) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["withDID"](this, id);
    }
    toDIDKey() {
        return this.did();
    }
}
const or = (other)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["or"]({
        parse
    }, other);
}),
"[project]/node_modules/@ucanto/principal/src/signer.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "or",
    ()=>or,
    "withDID",
    ()=>withDID
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
;
const or = (left, right)=>new Importer([
        left,
        right
    ]);
/**
 * @template {[API.SignerImporter, ...API.SignerImporter[]]} Importers
 * @implements {API.CompositeImporter<Importers>}
 */ class Importer {
    /**
   * @param {Importers} variants
   */ constructor(variants){
        this.variants = variants;
        this.from = create(variants);
    }
    /**
   * @template {API.SignerImporter} Other
   * @param {Other} other
   * @returns {API.CompositeImporter<[Other, ...Importers]>}
   */ or(other) {
        return new Importer([
            other,
            ...this.variants
        ]);
    }
}
/**
 * @template {[API.SignerImporter, ...API.SignerImporter[]]} Importers
 * @param {Importers} importers
 */ const create = (importers)=>{
    /**
   * @template {API.DID} ID - DID that can be imported, which may be a type union.
   * @template {API.SigAlg} Alg - Multicodec code corresponding to signature algorithm.
   * @param {API.SignerArchive<ID, Alg>} archive
   * @returns {API.Signer<ID, Alg>}
   */ const from = (archive)=>{
        if (archive.id.startsWith('did:key:')) {
            return importWith(archive, importers);
        } else {
            for (const [name, key] of Object.entries(archive.keys)){
                const id = name;
                const signer = importWith({
                    id,
                    keys: {
                        [id]: key
                    }
                }, importers);
                return signer.withDID(archive.id);
            }
            throw new Error(`Archive ${archive.id} contains no keys`);
        }
    };
    return from;
};
/**
 * @param {API.SignerArchive} archive
 * @param {API.SignerImporter[]} importers
 * @returns {API.Signer}
 */ const importWith = (archive, importers)=>{
    for (const importer of importers){
        try {
            return importer.from(archive);
        } catch (_) {}
    }
    throw new Error(`Unsupported signer`);
};
const withDID = ({ signer, verifier }, id)=>new SignerWithDID(signer, verifier.withDID(id));
/**
 * @template {API.DID} ID
 * @template {number} Code
 * @implements {API.Signer<ID, Code>}
 */ class SignerWithDID {
    /**
   * @param {API.Signer<API.DID<'key'>, Code>} key
   * @param {API.Verifier<ID, Code>} verifier
   */ constructor(key, verifier){
        this.key = key;
        this.verifier = verifier;
    }
    /** @type {API.Signer<ID, Code>} */ get signer() {
        return this;
    }
    get signatureAlgorithm() {
        return this.key.signatureAlgorithm;
    }
    get signatureCode() {
        return this.key.signatureCode;
    }
    /**
   * @returns {ID}
   */ did() {
        return this.verifier.did();
    }
    toDIDKey() {
        return this.verifier.toDIDKey();
    }
    /**
   * @template {API.DID} ID
   * @param {ID} id
   */ withDID(id) {
        return withDID(this.key, id);
    }
    /**
   * @template T
   * @param {API.ByteView<T>} payload
   */ sign(payload) {
        return this.key.sign(payload);
    }
    /**
   * @template T
   * @param {API.ByteView<T>} payload
   * @param {API.Signature<T, Code>} signature
   */ verify(payload, signature) {
        return this.verifier.verify(payload, signature);
    }
    toArchive() {
        const { keys } = this.key.toArchive();
        return {
            id: this.did(),
            keys
        };
    }
}
}),
"[project]/node_modules/@ucanto/principal/src/ed25519/signer.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "PUB_KEY_OFFSET",
    ()=>PUB_KEY_OFFSET,
    "code",
    ()=>code,
    "decode",
    ()=>decode,
    "derive",
    ()=>derive,
    "encode",
    ()=>encode,
    "format",
    ()=>format,
    "from",
    ()=>from,
    "generate",
    ()=>generate,
    "name",
    ()=>name,
    "or",
    ()=>or,
    "parse",
    ()=>parse,
    "signatureAlgorithm",
    ()=>signatureAlgorithm,
    "signatureCode",
    ()=>signatureCode
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$noble$2f$ed25519$2f$lib$2f$esm$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@noble/ed25519/lib/esm/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/varint.js [app-client] (ecmascript) <export * as varint>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$type$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/type.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/verifier.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/bases/base64.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/signature.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/signer.js [app-client] (ecmascript)");
;
;
;
;
;
;
;
;
const code = 0x1300;
const name = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["name"];
const signatureAlgorithm = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["signatureAlgorithm"];
const signatureCode = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["signatureCode"];
const PRIVATE_TAG_SIZE = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].encodingLength(code);
const PUBLIC_TAG_SIZE = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].encodingLength(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["code"]);
const KEY_SIZE = 32;
const SIZE = PRIVATE_TAG_SIZE + KEY_SIZE + PUBLIC_TAG_SIZE + KEY_SIZE;
const PUB_KEY_OFFSET = PRIVATE_TAG_SIZE + KEY_SIZE;
const generate = ()=>derive(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$noble$2f$ed25519$2f$lib$2f$esm$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["utils"].randomPrivateKey());
const derive = async (secret)=>{
    if (secret.byteLength !== KEY_SIZE) {
        throw new Error(`Expected Uint8Array with byteLength of ${KEY_SIZE} instead not ${secret.byteLength}`);
    }
    const publicKey = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$noble$2f$ed25519$2f$lib$2f$esm$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["getPublicKey"](secret);
    const signer = new Ed25519Signer(SIZE);
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].encodeTo(code, signer, 0);
    signer.set(secret, PRIVATE_TAG_SIZE);
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].encodeTo(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["code"], signer, PRIVATE_TAG_SIZE + KEY_SIZE);
    signer.set(publicKey, PRIVATE_TAG_SIZE + KEY_SIZE + PUBLIC_TAG_SIZE);
    return signer;
};
const from = ({ id, keys })=>{
    if (id.startsWith('did:key:')) {
        const key = keys[id];
        if (key instanceof Uint8Array) {
            return decode(key);
        }
    }
    throw new TypeError(`Unsupported archive format`);
};
const or = (other)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["or"]({
        from
    }, other);
const decode = (bytes)=>{
    if (bytes.byteLength !== SIZE) {
        throw new Error(`Expected Uint8Array with byteLength of ${SIZE} instead not ${bytes.byteLength}`);
    }
    {
        const [keyCode] = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].decode(bytes);
        if (keyCode !== code) {
            throw new Error(`Given bytes must be a multiformat with ${code} tag`);
        }
    }
    {
        const [code] = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].decode(bytes.subarray(PUB_KEY_OFFSET));
        if (code !== __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["code"]) {
            throw new Error(`Given bytes must contain public key in multiformats with ${__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["code"]} tag`);
        }
    }
    return new Ed25519Signer(bytes);
};
const encode = (signer)=>signer.encode();
const format = (signer, encoder)=>(encoder || __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64pad"]).encode(encode(signer));
const parse = (principal, decoder)=>decode((decoder || __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64pad"]).decode(principal));
/**
 * @implements {API.EdSigner}
 */ class Ed25519Signer extends Uint8Array {
    /** @type {typeof code} */ get code() {
        return code;
    }
    get signer() {
        return this;
    }
    /** @type {API.EdVerifier} */ get verifier() {
        const bytes = new Uint8Array(this.buffer, PRIVATE_TAG_SIZE + KEY_SIZE);
        const verifier = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["decode"](bytes);
        Object.defineProperties(this, {
            verifier: {
                value: verifier
            }
        });
        return verifier;
    }
    /**
   * Raw public key without multiformat code.
   */ get secret() {
        const secret = new Uint8Array(this.buffer, PRIVATE_TAG_SIZE, KEY_SIZE);
        Object.defineProperties(this, {
            secret: {
                value: secret
            }
        });
        return secret;
    }
    /**
   * DID of this principal in `did:key` format.
   */ did() {
        return this.verifier.did();
    }
    toDIDKey() {
        return this.verifier.toDIDKey();
    }
    /**
   * @template {API.DID} ID
   * @param {ID} id
   * @returns {API.Signer<ID, typeof Signature.EdDSA>}
   */ withDID(id) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["withDID"](this, id);
    }
    /**
   * @template T
   * @param {API.ByteView<T>} payload
   * @returns {Promise<API.SignatureView<T, typeof Signature.EdDSA>>}
   */ async sign(payload) {
        const raw = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$noble$2f$ed25519$2f$lib$2f$esm$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["sign"](payload, this.secret);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["create"](this.signatureCode, raw);
    }
    /**
   * @template T
   * @param {API.ByteView<T>} payload
   * @param {API.Signature<T, typeof this.signatureCode>} signature
   */ verify(payload, signature) {
        return this.verifier.verify(payload, signature);
    }
    get signatureAlgorithm() {
        return signatureAlgorithm;
    }
    get signatureCode() {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EdDSA"];
    }
    encode() {
        return this;
    }
    toArchive() {
        const id = this.did();
        return {
            id,
            keys: {
                [id]: this.encode()
            }
        };
    }
}
}),
"[project]/node_modules/@ucanto/principal/src/ed25519.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/signer.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/verifier.js [app-client] (ecmascript)");
;
;
;
}),
"[project]/node_modules/@ucanto/principal/src/ed25519/signer.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "PUB_KEY_OFFSET",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["PUB_KEY_OFFSET"],
    "code",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["code"],
    "decode",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["decode"],
    "derive",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["derive"],
    "encode",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["encode"],
    "format",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["format"],
    "from",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["from"],
    "generate",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["generate"],
    "name",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["name"],
    "or",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["or"],
    "parse",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["parse"],
    "signatureAlgorithm",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["signatureAlgorithm"],
    "signatureCode",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["signatureCode"]
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/signer.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$type$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/type.js [app-client] (ecmascript)");
}),
"[project]/node_modules/@ucanto/principal/src/ed25519.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "PUB_KEY_OFFSET",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["PUB_KEY_OFFSET"],
    "Signer",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__,
    "Verifier",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__,
    "code",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["code"],
    "decode",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["decode"],
    "derive",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["derive"],
    "encode",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encode"],
    "format",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["format"],
    "from",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["from"],
    "generate",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["generate"],
    "name",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["name"],
    "or",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["or"],
    "parse",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["parse"],
    "signatureAlgorithm",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["signatureAlgorithm"],
    "signatureCode",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["signatureCode"]
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/signer.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/verifier.js [app-client] (ecmascript)");
}),
"[project]/node_modules/@ucanto/principal/src/ed25519/verifier.js [app-client] (ecmascript) <export * as Verifier>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Verifier",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/verifier.js [app-client] (ecmascript)");
}),
"[project]/node_modules/@ucanto/principal/src/rsa/type.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
}),
"[project]/node_modules/@ucanto/principal/src/multiformat.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "decode",
    ()=>decode,
    "encodeTo",
    ()=>encodeTo,
    "encodingLength",
    ()=>encodingLength,
    "tagWith",
    ()=>tagWith,
    "untagWith",
    ()=>untagWith
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/varint.js [app-client] (ecmascript) <export * as varint>");
;
const tagWith = (code, bytes)=>{
    const offset = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].encodingLength(code);
    const multiformat = new Uint8Array(bytes.byteLength + offset);
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].encodeTo(code, multiformat, 0);
    multiformat.set(bytes, offset);
    return multiformat;
};
const untagWith = (code, source, byteOffset = 0)=>{
    const bytes = byteOffset !== 0 ? source.subarray(byteOffset) : source;
    const [tag, size] = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].decode(bytes);
    if (tag !== code) {
        throw new Error(`Expected multiformat with 0x${code.toString(16)} tag instead got 0x${tag.toString(16)}`);
    } else {
        return new Uint8Array(bytes.buffer, bytes.byteOffset + size);
    }
};
const encodingLength = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].encodingLength;
const encodeTo = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].encodeTo;
const decode = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$varint$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__varint$3e$__["varint"].decode;
}),
"[project]/node_modules/@ucanto/principal/src/rsa/asn1.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * ASN1 Tags as per https://luca.ntop.org/Teaching/Appunti/asn1.html
 */ __turbopack_context__.s([
    "BITSTRING_TAG",
    ()=>BITSTRING_TAG,
    "INT_TAG",
    ()=>INT_TAG,
    "NULL_TAG",
    ()=>NULL_TAG,
    "OBJECT_TAG",
    ()=>OBJECT_TAG,
    "OCTET_STRING_TAG",
    ()=>OCTET_STRING_TAG,
    "SEQUENCE_TAG",
    ()=>SEQUENCE_TAG,
    "UNUSED_BIT_PAD",
    ()=>UNUSED_BIT_PAD,
    "encodeBitString",
    ()=>encodeBitString,
    "encodeDERLength",
    ()=>encodeDERLength,
    "encodeInt",
    ()=>encodeInt,
    "encodeOctetString",
    ()=>encodeOctetString,
    "encodeSequence",
    ()=>encodeSequence,
    "enterSequence",
    ()=>enterSequence,
    "into",
    ()=>into,
    "readBitString",
    ()=>readBitString,
    "readDERLength",
    ()=>readDERLength,
    "readInt",
    ()=>readInt,
    "readOctetString",
    ()=>readOctetString,
    "readSequence",
    ()=>readSequence,
    "readSequenceWith",
    ()=>readSequenceWith,
    "skip",
    ()=>skip,
    "skipInt",
    ()=>skipInt,
    "skipSequence",
    ()=>skipSequence
]);
const TAG_SIZE = 1;
const INT_TAG = 0x02;
const BITSTRING_TAG = 0x03;
const OCTET_STRING_TAG = 0x04;
const NULL_TAG = 0x05;
const OBJECT_TAG = 0x06;
const SEQUENCE_TAG = 0x30;
const UNUSED_BIT_PAD = 0x00;
const encodeDERLength = (length)=>{
    if (length <= 127) {
        return new Uint8Array([
            length
        ]);
    }
    /** @type {number[]} */ const octets = [];
    while(length !== 0){
        octets.push(length & 0xff);
        length = length >>> 8;
    }
    octets.reverse();
    return new Uint8Array([
        0x80 | octets.length & 0xff,
        ...octets
    ]);
};
const readDERLength = (bytes, offset = 0)=>{
    if ((bytes[offset] & 0x80) === 0) {
        return {
            number: bytes[offset],
            consumed: 1
        };
    }
    const numberBytes = bytes[offset] & 0x7f;
    /* c8 ignore next 5 */ if (bytes.length < numberBytes + 1) {
        throw new Error(`ASN parsing error: Too few bytes. Expected encoded length's length to be at least ${numberBytes}`);
    }
    let length = 0;
    for(let i = 0; i < numberBytes; i++){
        length = length << 8;
        length = length | bytes[offset + i + 1];
    }
    return {
        number: length,
        consumed: numberBytes + 1
    };
};
const skip = (input, expectedTag, position)=>{
    const parsed = into(input, expectedTag, position);
    return parsed.position + parsed.length;
};
const into = (input, expectedTag, offset)=>{
    const actualTag = input[offset];
    /* c8 ignore next 7 */ if (actualTag !== expectedTag) {
        throw new Error(`ASN parsing error: Expected tag 0x${expectedTag.toString(16)} at position ${offset}, but got 0x${actualTag.toString(16)}.`);
    }
    // length
    const length = readDERLength(input, offset + TAG_SIZE);
    const position = offset + TAG_SIZE + length.consumed;
    // content
    return {
        position,
        length: length.number
    };
};
const encodeBitString = (input)=>{
    // encode input length + 1 for unused bit pad
    const length = encodeDERLength(input.byteLength + 1);
    // allocate a buffer of desired size
    const bytes = new Uint8Array(TAG_SIZE + // ASN_BITSTRING_TAG
    length.byteLength + 1 + // amount of unused bits at the end of our bitstring
    input.byteLength);
    let byteOffset = 0;
    // write bytestring tag
    bytes[byteOffset] = BITSTRING_TAG;
    byteOffset += TAG_SIZE;
    // write length of the bytestring
    bytes.set(length, byteOffset);
    byteOffset += length.byteLength;
    // write unused bits at the end of our bitstring
    bytes[byteOffset] = UNUSED_BIT_PAD;
    byteOffset += 1;
    // write actual data into bitstring
    bytes.set(input, byteOffset);
    return bytes;
};
const encodeOctetString = (input)=>{
    // encode input length
    const length = encodeDERLength(input.byteLength);
    // allocate a buffer of desired size
    const bytes = new Uint8Array(TAG_SIZE + length.byteLength + input.byteLength);
    let byteOffset = 0;
    // write octet string tag
    bytes[byteOffset] = OCTET_STRING_TAG;
    byteOffset += TAG_SIZE;
    // write octet string length
    bytes.set(length, byteOffset);
    byteOffset += length.byteLength;
    // write actual data into bitstring
    bytes.set(input, byteOffset);
    return bytes;
};
const encodeSequence = (sequence)=>{
    // calculate bytelength for all the parts
    let byteLength = 0;
    for (const item of sequence){
        byteLength += item.byteLength;
    }
    // encode sequence byte length
    const length = encodeDERLength(byteLength);
    // allocate the buffer to write sequence into
    const bytes = new Uint8Array(TAG_SIZE + length.byteLength + byteLength);
    let byteOffset = 0;
    // write the sequence tag
    bytes[byteOffset] = SEQUENCE_TAG;
    byteOffset += TAG_SIZE;
    // write sequence length
    bytes.set(length, byteOffset);
    byteOffset += length.byteLength;
    // write each item in the sequence
    for (const item of sequence){
        bytes.set(item, byteOffset);
        byteOffset += item.byteLength;
    }
    return bytes;
};
const readSequence = (bytes, offset = 0)=>{
    const { position, length } = into(bytes, SEQUENCE_TAG, offset);
    return new Uint8Array(bytes.buffer, bytes.byteOffset + position, length);
};
const encodeInt = (input)=>{
    const extra = input.byteLength === 0 || input[0] & 0x80 ? 1 : 0;
    // encode input length
    const length = encodeDERLength(input.byteLength + extra);
    // allocate a buffer of desired size
    const bytes = new Uint8Array(TAG_SIZE + // INT_TAG
    length.byteLength + input.byteLength + extra);
    let byteOffset = 0;
    // write octet string tag
    bytes[byteOffset] = INT_TAG;
    byteOffset += TAG_SIZE;
    // write int length
    bytes.set(length, byteOffset);
    byteOffset += length.byteLength;
    // add 0 if the most-significant bit is set
    if (extra > 0) {
        bytes[byteOffset] = UNUSED_BIT_PAD;
        byteOffset += extra;
    }
    // write actual data into bitstring
    bytes.set(input, byteOffset);
    return bytes;
};
const enterSequence = (bytes, offset = 0)=>into(bytes, SEQUENCE_TAG, offset).position;
const skipSequence = (bytes, offset = 0)=>skip(bytes, SEQUENCE_TAG, offset);
const skipInt = (bytes, offset = 0)=>skip(bytes, INT_TAG, offset);
const readBitString = (bytes, offset = 0)=>{
    const { position, length } = into(bytes, BITSTRING_TAG, offset);
    const tag = bytes[position];
    /* c8 ignore next 5 */ if (tag !== UNUSED_BIT_PAD) {
        throw new Error(`Can not read bitstring, expected length to be multiple of 8, but got ${tag} unused bits in last byte.`);
    }
    return new Uint8Array(bytes.buffer, bytes.byteOffset + position + 1, length - 1);
};
const readInt = (bytes, byteOffset = 0)=>{
    const { position, length } = into(bytes, INT_TAG, byteOffset);
    let delta = 0;
    // drop leading 0s
    while(bytes[position + delta] === 0){
        delta++;
    }
    return new Uint8Array(bytes.buffer, bytes.byteOffset + position + delta, length - delta);
};
const readOctetString = (bytes, offset = 0)=>{
    const { position, length } = into(bytes, OCTET_STRING_TAG, offset);
    return new Uint8Array(bytes.buffer, bytes.byteOffset + position, length);
};
const readSequenceWith = (readers, source, byteOffset = 0)=>{
    const results = [];
    const sequence = readSequence(source, byteOffset);
    let offset = 0;
    for (const read of readers){
        const chunk = read(sequence, offset);
        results.push(chunk);
        offset = chunk.byteOffset + chunk.byteLength - sequence.byteOffset;
    }
    return results;
};
}),
"[project]/node_modules/@ucanto/principal/src/rsa/spki.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "SPKI_PARAMS_ENCODED",
    ()=>SPKI_PARAMS_ENCODED,
    "decode",
    ()=>decode,
    "encode",
    ()=>encode
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/asn1.js [app-client] (ecmascript)");
;
;
const SPKI_PARAMS_ENCODED = new Uint8Array([
    48,
    13,
    6,
    9,
    42,
    134,
    72,
    134,
    247,
    13,
    1,
    1,
    1,
    5,
    0
]);
const encode = (key)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeSequence"])([
        SPKI_PARAMS_ENCODED,
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeBitString"])(key)
    ]);
const decode = (info)=>{
    // go into the top-level SEQUENCE
    const offset = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["enterSequence"])(info, 0);
    // skip the header we expect (SKPI_PARAMS_ENCODED)
    const keyOffset = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["skipSequence"])(info, offset);
    // we expect the bitstring next
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readBitString"])(info, keyOffset);
};
}),
"[project]/node_modules/@ucanto/principal/src/rsa/pkcs8.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "decode",
    ()=>decode,
    "encode",
    ()=>encode
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/bases/base64.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/asn1.js [app-client] (ecmascript)");
;
;
;
const PKSC8_HEADER = new Uint8Array([
    // version
    2,
    1,
    0,
    // privateKeyAlgorithm
    48,
    13,
    6,
    9,
    42,
    134,
    72,
    134,
    247,
    13,
    1,
    1,
    1,
    5,
    0
]);
const decode = (info)=>{
    let offset = 0;
    // go into the top-level SEQUENCE
    offset = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["enterSequence"])(info, offset);
    offset = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["skipInt"])(info, offset);
    offset = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["skipSequence"])(info, offset);
    // we expect the bitstring next
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readOctetString"])(info, offset);
};
const encode = (key)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeSequence"])([
        PKSC8_HEADER,
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeOctetString"])(key)
    ]);
}),
"[project]/node_modules/@ucanto/principal/src/rsa/public-key.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "decode",
    ()=>decode,
    "encode",
    ()=>encode,
    "fromJWK",
    ()=>fromJWK,
    "fromSPKI",
    ()=>fromSPKI,
    "toJWK",
    ()=>toJWK,
    "toSPKI",
    ()=>toSPKI
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/asn1.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$spki$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/spki.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/bases/base64.js [app-client] (ecmascript)");
;
;
;
;
const decode = (key, byteOffset = 0)=>{
    const [n, e] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readSequenceWith"])([
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readInt"],
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readInt"]
    ], key, byteOffset);
    return {
        n,
        e
    };
};
const encode = ({ n, e })=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeSequence"])([
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeInt"])(n),
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeInt"])(e)
    ]);
const toSPKI = (key)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$spki$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encode"](encode(key));
const fromSPKI = (info)=>decode(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$spki$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["decode"](info));
const toJWK = ({ n, e })=>({
        kty: 'RSA',
        alg: 'RS256',
        key_ops: [
            'verify'
        ],
        ext: true,
        n: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64url"].baseEncode(n),
        e: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64url"].baseEncode(e)
    });
const fromJWK = ({ n, e })=>({
        n: base64urlDecode(n),
        e: base64urlDecode(e)
    });
/**
 * @param {string|undefined} input
 */ const base64urlDecode = (input = '')=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64url"].baseDecode(input);
}),
"[project]/node_modules/@ucanto/principal/src/rsa/private-key.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "code",
    ()=>code,
    "decode",
    ()=>decode,
    "encode",
    ()=>encode,
    "fromJWK",
    ()=>fromJWK,
    "fromPKCS8",
    ()=>fromPKCS8,
    "toJWK",
    ()=>toJWK,
    "toPKCS8",
    ()=>toPKCS8,
    "toSPKI",
    ()=>toSPKI
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/asn1.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/bases/base64.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$pkcs8$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/pkcs8.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$spki$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/spki.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$public$2d$key$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/public-key.js [app-client] (ecmascript)");
;
;
;
;
;
;
const code = 0x1305;
const VERSION = new Uint8Array();
const decode = (source, byteOffset = 0)=>{
    const [v, n, e, d, p, q, dp, dq, qi] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readSequenceWith"])([
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readInt"],
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readInt"],
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readInt"],
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readInt"],
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readInt"],
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readInt"],
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readInt"],
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readInt"],
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["readInt"]
    ], source, byteOffset);
    return {
        v,
        n,
        e,
        d,
        p,
        q,
        dp,
        dq,
        qi
    };
};
const encode = ({ v, n, e, d, p, q, dp, dq, qi })=>{
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeSequence"])([
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeInt"])(v),
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeInt"])(n),
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeInt"])(e),
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeInt"])(d),
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeInt"])(p),
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeInt"])(q),
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeInt"])(dp),
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeInt"])(dq),
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$asn1$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encodeInt"])(qi)
    ]);
};
const toJWK = ({ n, e, d, p, q, dp, dq, qi })=>({
        kty: 'RSA',
        alg: 'RS256',
        key_ops: [
            'sign'
        ],
        ext: true,
        n: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64url"].baseEncode(n),
        e: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64url"].baseEncode(e),
        d: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64url"].baseEncode(d),
        p: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64url"].baseEncode(p),
        q: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64url"].baseEncode(q),
        dp: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64url"].baseEncode(dp),
        dq: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64url"].baseEncode(dq),
        qi: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64url"].baseEncode(qi)
    });
const fromJWK = ({ n, e, d, p, q, dp, dq, qi })=>({
        v: VERSION,
        n: base64urlDecode(n),
        e: base64urlDecode(e),
        d: base64urlDecode(d),
        p: base64urlDecode(p),
        q: base64urlDecode(q),
        dp: base64urlDecode(dp),
        dq: base64urlDecode(dq),
        qi: base64urlDecode(qi)
    });
const toPKCS8 = (key)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$pkcs8$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encode"](encode(key));
const fromPKCS8 = (info)=>decode(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$pkcs8$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["decode"](info));
const toSPKI = (key)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$spki$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encode"](__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$public$2d$key$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encode"](key));
/**
 *
 * @param {string|undefined} input
 * @returns
 */ const base64urlDecode = (input = '')=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64url"].baseDecode(input);
}),
"[project]/node_modules/@ucanto/principal/src/rsa.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Verifier",
    ()=>RSAVerifier,
    "code",
    ()=>code,
    "decode",
    ()=>decode,
    "from",
    ()=>from,
    "generate",
    ()=>generate,
    "name",
    ()=>name,
    "or",
    ()=>or,
    "signatureAlgorithm",
    ()=>signatureAlgorithm,
    "signatureCode",
    ()=>signatureCode
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$one$2d$webcrypto$2f$browser$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/one-webcrypto/browser.mjs [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base58$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/bases/base58.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$type$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/type.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/did.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$multiformat$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/multiformat.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/signature.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$spki$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/spki.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$pkcs8$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/pkcs8.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$private$2d$key$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/private-key.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$public$2d$key$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/public-key.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/verifier.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/signer.js [app-client] (ecmascript)");
;
;
;
;
;
;
;
;
;
;
;
;
;
const name = 'RSA';
const code = 0x1305;
/** @type {API.RSAVerifier['code']} */ const verifierCode = 0x1205;
const signatureCode = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["RS256"];
const signatureAlgorithm = 'RS256';
const ALG = 'RSASSA-PKCS1-v1_5';
const HASH_ALG = 'SHA-256';
const KEY_SIZE = 2048;
const SALT_LENGTH = 128;
const IMPORT_PARAMS = {
    name: ALG,
    hash: {
        name: HASH_ALG
    }
};
const generate = async ({ size = KEY_SIZE, extractable = false } = {})=>{
    // We start by generate an RSA keypair using web crypto API.
    const { publicKey, privateKey } = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$one$2d$webcrypto$2f$browser$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["webcrypto"].subtle.generateKey({
        name: ALG,
        modulusLength: size,
        publicExponent: new Uint8Array([
            0x01,
            0x00,
            0x01
        ]),
        hash: {
            name: HASH_ALG
        }
    }, extractable, [
        'sign',
        'verify'
    ]);
    // Next we need to encode public key, because `RSAVerifier` uses it to
    // for implementing a `did()` method. To do this we first export
    // Subject Public Key Info (SPKI) using web crypto API.
    const spki = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$one$2d$webcrypto$2f$browser$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["webcrypto"].subtle.exportKey('spki', publicKey);
    // Then we extract public key from the SPKI and tag it with RSA public key
    // multicode
    const publicBytes = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$multiformat$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["tagWith"])(verifierCode, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$spki$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["decode"](new Uint8Array(spki)));
    // Now that we have publicKey and it's multiformat representation we can
    // create a verifier.
    const verifier = new RSAVerifier({
        bytes: publicBytes,
        publicKey
    });
    // If we generated non extractable key we just wrap actual keys and verifier
    // in the RSASigner view.
    if (!extractable) {
        return new UnextractableRSASigner({
            privateKey,
            verifier
        });
    } else {
        const pkcs8 = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$one$2d$webcrypto$2f$browser$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["webcrypto"].subtle.exportKey('pkcs8', privateKey);
        const bytes = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$multiformat$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["tagWith"])(code, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$pkcs8$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["decode"](new Uint8Array(pkcs8)));
        return new ExtractableRSASigner({
            privateKey,
            bytes,
            verifier
        });
    }
};
const from = ({ id, keys })=>{
    if (id.startsWith('did:key:')) {
        const did = id;
        const key = keys[did];
        if (key instanceof Uint8Array) {
            return decode(key);
        } else {
            return new UnextractableRSASigner({
                privateKey: key,
                verifier: RSAVerifier.parse(did)
            });
        }
    } else {
        throw new TypeError(`RSA can not import from ${id} archive, try generic Signer instead`);
    }
};
const or = (other)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["or"]({
        from
    }, other);
const decode = (bytes)=>{
    // First we decode RSA key data from the private key with multicode tag.
    const rsa = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$private$2d$key$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["decode"]((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$multiformat$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["untagWith"])(code, bytes));
    // Then we encode RSA key data as public key with multicode tag.
    const publicBytes = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$multiformat$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["tagWith"])(verifierCode, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$public$2d$key$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encode"](rsa));
    return new ExtractableRSASigner({
        bytes,
        privateKey: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$one$2d$webcrypto$2f$browser$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["webcrypto"].subtle.importKey('pkcs8', __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$pkcs8$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encode"]((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$multiformat$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["untagWith"])(code, bytes)), IMPORT_PARAMS, true, [
            'sign'
        ]),
        verifier: RSAVerifier.decode(publicBytes)
    });
};
/**
 * @implements {API.RSAVerifier}
 */ class RSAVerifier {
    /**
   * @param {object} options
   * @param {API.Await<CryptoKey>} options.publicKey
   * @param {API.ByteView<API.RSAVerifier>} options.bytes
   */ constructor({ publicKey, bytes }){
        /** @private */ this.publicKey = publicKey;
        /** @private */ this.bytes = bytes;
    }
    /**
   * @template {API.DID} ID
   * @param {ID} id
   * @returns {API.Verifier<ID, typeof signatureCode>}
   */ withDID(id) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["withDID"](this, id);
    }
    toDIDKey() {
        return this.did();
    }
    /**
   * @param {API.ByteView<API.RSAVerifier>} bytes
   * @returns {API.RSAVerifier}
   */ static decode(bytes) {
        return new this({
            bytes,
            publicKey: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$one$2d$webcrypto$2f$browser$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["webcrypto"].subtle.importKey('spki', __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$spki$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["encode"]((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$multiformat$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["untagWith"])(verifierCode, bytes)), IMPORT_PARAMS, true, [
                'verify'
            ])
        });
    }
    /**
   * @param {API.DIDKey} did
   * @returns {API.RSAVerifier}
   */ static parse(did) {
        return RSAVerifier.decode(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["parse"](did));
    }
    /**
   * @param {API.PrincipalParser} other
   */ static or(other) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["or"](this, other);
    }
    /** @type {typeof verifierCode} */ get code() {
        return verifierCode;
    }
    /**
   * @type {typeof signatureCode}
   */ get signatureCode() {
        return signatureCode;
    }
    /**
   * @type {typeof signatureAlgorithm}
   */ get signatureAlgorithm() {
        return signatureAlgorithm;
    }
    /**
   * DID of the Principal in `did:key` format.
   * @returns {API.DID<"key">}
   */ did() {
        return `did:key:${__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$bases$2f$base58$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base58btc"].encode(this.bytes)}`;
    }
    /**
   * @template T
   * @param {API.ByteView<T>} payload
   * @param {API.Signature<T, typeof this.signatureCode>} signature
   * @returns {Promise<boolean>}
   */ async verify(payload, signature) {
        // if signature code does not match RS256 it's not signed by corresponding
        // signer.
        if (signature.code !== signatureCode) {
            return false;
        }
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$one$2d$webcrypto$2f$browser$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["webcrypto"].subtle.verify({
            name: ALG,
            hash: {
                name: HASH_ALG
            }
        }, await this.publicKey, signature.raw, payload);
    }
}
const RSAVerifier$ = RSAVerifier;
;
/**
 * @typedef {API.ByteView<API.Signer<API.DID<'key'>, typeof signatureCode> & CryptoKey>} EncodedSigner
 */ class RSASigner {
    /**
   * @param {object} options
   * @param {API.Await<CryptoKey>} options.privateKey
   * @param {API.RSAVerifier} options.verifier
   */ constructor({ privateKey, verifier }){
        /** @readonly */ this.verifier = verifier;
        /** @protected */ this.privateKey = privateKey;
    }
    get signer() {
        return this;
    }
    /**
   * @type {typeof code}
   */ get code() {
        return code;
    }
    /**
   * @type {typeof signatureCode}
   */ get signatureCode() {
        return signatureCode;
    }
    /**
   * @type {typeof signatureAlgorithm}
   */ get signatureAlgorithm() {
        return signatureAlgorithm;
    }
    did() {
        return this.verifier.did();
    }
    toDIDKey() {
        return this.verifier.toDIDKey();
    }
    /**
   * @template T
   * @param {API.ByteView<T>} payload
   * @param {API.Signature<T, typeof this.signatureCode>} signature
   */ verify(payload, signature) {
        return this.verifier.verify(payload, signature);
    }
    /**
   * @template T
   * @param {API.ByteView<T>} payload
   * @returns {Promise<API.SignatureView<T, typeof signatureCode>>}
   */ async sign(payload) {
        const buffer = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$one$2d$webcrypto$2f$browser$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["webcrypto"].subtle.sign({
            name: ALG,
            saltLength: SALT_LENGTH
        }, await this.privateKey, payload);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["create"](signatureCode, new Uint8Array(buffer));
    }
}
/**
 * @implements {API.RSASigner}
 */ class ExtractableRSASigner extends RSASigner {
    /**
   * @param {object} options
   * @param {API.Await<CryptoKey>} options.privateKey
   * @param {EncodedSigner} options.bytes
   * @param {API.RSAVerifier} options.verifier
   */ constructor(options){
        super(options);
        this.bytes = options.bytes;
    }
    /**
   * @template {API.DID} ID
   * @param {ID} id
   * @returns {API.Signer<ID, typeof signatureCode>}
   */ withDID(id) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["withDID"](this, id);
    }
    toArchive() {
        const id = this.did();
        return {
            id,
            keys: {
                [id]: this.bytes
            }
        };
    }
}
/**
 * @implements {API.RSASigner}
 */ class UnextractableRSASigner extends RSASigner {
    /**
   * @param {object} options
   * @param {CryptoKey} options.privateKey
   * @param {API.RSAVerifier} options.verifier
   */ constructor(options){
        super(options);
        this.privateKey = options.privateKey;
    }
    /**
   * @template {API.DID} ID
   * @param {ID} id
   * @returns {API.Signer<ID, typeof signatureCode>}
   */ withDID(id) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["withDID"](this, id);
    }
    toArchive() {
        const id = this.did();
        return {
            id,
            keys: {
                [id]: this.privateKey
            }
        };
    }
}
}),
"[project]/node_modules/@ucanto/principal/src/rsa.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Verifier",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["Verifier"],
    "code",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["code"],
    "decode",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["decode"],
    "from",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["from"],
    "generate",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["generate"],
    "name",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["name"],
    "or",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["or"],
    "signatureAlgorithm",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["signatureAlgorithm"],
    "signatureCode",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["signatureCode"]
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2f$type$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa/type.js [app-client] (ecmascript)");
}),
"[project]/node_modules/@ucanto/principal/src/absentee.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "from",
    ()=>from
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/signature.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/lib.js [app-client] (ecmascript) <locals>");
;
;
const from = ({ id })=>new Absentee(id);
/**
 * An absentee is a special type of signer that produces an absent signature,
 * which signals that verifier needs to verify authorization interactively.
 *
 * @template {UCAN.DID} ID
 * @implements {UCAN.Signer<ID, Signature.NON_STANDARD>}
 */ class Absentee {
    /**
   * @param {ID} id
   */ constructor(id){
        this.id = id;
    }
    did() {
        return this.id;
    }
    /* c8 ignore next 3 */ get signatureCode() {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NON_STANDARD"];
    }
    get signatureAlgorithm() {
        return '';
    }
    sign() {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$signature$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createNonStandard"](this.signatureAlgorithm, new Uint8Array(0));
    }
}
}),
"[project]/node_modules/@ucanto/principal/src/lib.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Signer",
    ()=>Signer,
    "Verifier",
    ()=>Verifier
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Verifier$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/verifier.js [app-client] (ecmascript) <export * as Verifier>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/signer.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$absentee$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/absentee.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$multiformat$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/multiformat.js [app-client] (ecmascript)");
;
;
;
;
const Verifier = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$verifier$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Verifier$3e$__["Verifier"].or(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__.Verifier);
const Signer = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["or"](__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__);
;
}),
"[project]/node_modules/@ucanto/principal/src/ed25519/signer.js [app-client] (ecmascript) <export * as Signer>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Signer",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2f$signer$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519/signer.js [app-client] (ecmascript)");
}),
"[project]/node_modules/@ucanto/principal/src/ed25519.js [app-client] (ecmascript) <export * as ed25519>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "ed25519",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519.js [app-client] (ecmascript)");
}),
]);

//# sourceMappingURL=node_modules_%40ucanto_95731577._.js.map