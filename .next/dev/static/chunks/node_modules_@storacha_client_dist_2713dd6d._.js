(globalThis.TURBOPACK || (globalThis.TURBOPACK = [])).push([typeof document === "object" ? document.currentScript : undefined,
"[project]/node_modules/@storacha/client/dist/service.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "accessServiceConnection",
    ()=>accessServiceConnection,
    "accessServicePrincipal",
    ()=>accessServicePrincipal,
    "accessServiceURL",
    ()=>accessServiceURL,
    "defaultHeaders",
    ()=>defaultHeaders,
    "filecoinServiceConnection",
    ()=>filecoinServiceConnection,
    "filecoinServicePrincipal",
    ()=>filecoinServicePrincipal,
    "filecoinServiceURL",
    ()=>filecoinServiceURL,
    "gatewayServiceConnection",
    ()=>gatewayServiceConnection,
    "gatewayServicePrincipal",
    ()=>gatewayServicePrincipal,
    "gatewayServiceURL",
    ()=>gatewayServiceURL,
    "serviceConf",
    ()=>serviceConf,
    "uploadServiceConnection",
    ()=>uploadServiceConnection,
    "uploadServicePrincipal",
    ()=>uploadServicePrincipal,
    "uploadServiceURL",
    ()=>uploadServiceURL
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$environment$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/environment/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/lib.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/client/src/connection.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/lib.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/car.js [app-client] (ecmascript) <export * as CAR>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/transport/src/http.js [app-client] (ecmascript) <export * as HTTP>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ipld/dag-ucan/src/did.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/upload-client/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/upload-client/dist/service.js [app-client] (ecmascript)");
;
;
;
;
;
const accessServiceURL = new URL('https://up.storacha.network');
const accessServicePrincipal = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["parse"]('did:web:up.storacha.network');
/* c8 ignore start */ const envName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$environment$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isBrowser"] ? 'Browser' : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$environment$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isNode"] ? 'Node' : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$environment$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isBun"] ? 'Bun' : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$environment$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isDeno"] ? 'Deno' : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$environment$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isElectron"] ? 'Electron' : 'Unknown';
const defaultHeaders = {
    'X-Client': `Storacha/1 (js; ${envName})`
};
const accessServiceConnection = (options = {})=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["connect"]({
        id: options.id ?? accessServicePrincipal,
        codec: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].outbound,
        channel: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__["HTTP"].open({
            url: options.url ?? accessServiceURL,
            method: 'POST',
            headers: {
                ...defaultHeaders,
                ...options.headers
            }
        })
    });
const uploadServiceURL = new URL('https://up.storacha.network');
const uploadServicePrincipal = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["parse"]('did:web:up.storacha.network');
const uploadServiceConnection = (options = {})=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["connect"]({
        id: options.id ?? uploadServicePrincipal,
        codec: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].outbound,
        channel: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__["HTTP"].open({
            url: options.url ?? uploadServiceURL,
            method: 'POST',
            headers: {
                ...defaultHeaders,
                ...options.headers
            }
        })
    });
const filecoinServiceURL = new URL('https://up.storacha.network');
const filecoinServicePrincipal = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["parse"]('did:web:up.storacha.network');
const filecoinServiceConnection = (options = {})=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["connect"]({
        id: options.id ?? filecoinServicePrincipal,
        codec: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].outbound,
        channel: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__["HTTP"].open({
            url: options.url ?? filecoinServiceURL,
            method: 'POST',
            headers: {
                ...defaultHeaders,
                ...options.headers
            }
        })
    });
const gatewayServiceURL = new URL('https://gateway.storacha.network');
const gatewayServicePrincipal = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ipld$2f$dag$2d$ucan$2f$src$2f$did$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["parse"]('did:web:w3s.link');
const gatewayServiceConnection = ({ id, url } = {})=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$client$2f$src$2f$connection$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["connect"]({
        id: id ?? gatewayServicePrincipal,
        codec: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$car$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__CAR$3e$__["CAR"].outbound,
        channel: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$transport$2f$src$2f$http$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__HTTP$3e$__["HTTP"].open({
            url: url ?? gatewayServiceURL,
            method: 'POST'
        })
    });
const serviceConf = ()=>({
        access: accessServiceConnection(),
        upload: uploadServiceConnection(),
        filecoin: filecoinServiceConnection(),
        gateway: gatewayServiceConnection()
    });
;
 //# sourceMappingURL=service.js.map
}),
"[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Base",
    ()=>Base
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/agent.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$service$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/service.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/upload-client/dist/service.js [app-client] (ecmascript)");
;
;
class Base {
    /**
     * @type {Agent}
     * @protected
     */ _agent;
    /**
     * @type {import('./types.js').ServiceConf}
     * @protected
     */ _serviceConf;
    /**
     * @param {import('@storacha/access').AgentData} agentData
     * @param {object} [options]
     * @param {import('./types.js').ServiceConf} [options.serviceConf]
     * @param {URL} [options.receiptsEndpoint]
     */ constructor(agentData, options = {}){
        this._serviceConf = options.serviceConf ?? (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$service$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["serviceConf"])();
        this._agent = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["Agent"](agentData, {
            servicePrincipal: this._serviceConf.access.id,
            // @ts-expect-error I know but it will be HTTP for the forseeable.
            url: this._serviceConf.access.channel.url,
            connection: this._serviceConf.access
        });
        this._receiptsEndpoint = options.receiptsEndpoint ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$service$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["receiptsEndpoint"];
    }
    /**
     * The current user agent (this device).
     *
     * @type {Agent}
     */ get agent() {
        return this._agent;
    }
    /**
     * @protected
     * @param {import('./types.js').Ability[]} abilities
     */ async _invocationConfig(abilities) {
        const resource = this._agent.currentSpace();
        if (!resource) {
            throw new Error('missing current space: use createSpace() or setCurrentSpace()');
        }
        const issuer = this._agent.issuer;
        const proofs = await this._agent.proofs(abilities.map((can)=>({
                can,
                with: resource
            })));
        const audience = this._serviceConf.upload.id;
        return {
            issuer,
            with: resource,
            proofs,
            audience
        };
    }
} //# sourceMappingURL=base.js.map
}),
"[project]/node_modules/@storacha/client/dist/types.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/did-mailto/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$types$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/types.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$client$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/client.js [app-client] (ecmascript) <locals>"); //# sourceMappingURL=types.js.map
;
;
;
;
}),
"[project]/node_modules/@storacha/client/dist/result.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "try",
    ()=>unwrap,
    "unwrap",
    ()=>unwrap
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/result.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$interface$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/interface/src/lib.js [app-client] (ecmascript)");
;
;
const unwrap = ({ ok, error })=>{
    if (error) {
        throw error;
    } else {
        return ok;
    }
};
;
 //# sourceMappingURL=result.js.map
}),
"[project]/node_modules/@storacha/client/dist/capability/access.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "AccessClient",
    ()=>AccessClient,
    "accountAccess",
    ()=>accountAccess,
    "claim",
    ()=>claim,
    "createPendingAccessRequest",
    ()=>createPendingAccessRequest,
    "delegate",
    ()=>delegate,
    "request",
    ()=>request,
    "spaceAccess",
    ()=>spaceAccess
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/agent.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Access$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/access.js [app-client] (ecmascript) <export * as Access>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/did-mailto/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/did-mailto/dist/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/result.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$types$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/types.js [app-client] (ecmascript) <locals>");
;
;
;
;
;
;
class AccessClient extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Base"] {
    /* c8 ignore start - testing websocket code is hard */ /**
     * Authorize the current agent to use capabilities granted to the passed
     * email account.
     *
     * @deprecated Use `request` instead.
     *
     * @param {`${string}@${string}`} email
     * @param {object} [options]
     * @param {AbortSignal} [options.signal]
     * @param {Iterable<{ can: API.Ability }>} [options.capabilities]
     */ async authorize(email, options) {
        const account = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["fromEmail"](email);
        const authorization = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["unwrap"](await request(this, {
            account
        }));
        const access = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["unwrap"](await authorization.claim(options));
        await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["unwrap"](await access.save());
        return access.proofs;
    }
    /* c8 ignore stop */ /**
     * Claim delegations granted to the account associated with this agent.
     *
     * @param {object} [input]
     * @param {API.DID} [input.audience]
     */ async claim(input) {
        const access = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["unwrap"](await claim(this, input));
        await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["unwrap"](await access.save());
        return access.proofs;
    }
    /**
     * Requests specified `access` level from the account from the given account.
     *
     * @param {object} input
     * @param {API.AccountDID} input.account
     * @param {API.Access} [input.access]
     * @param {AbortSignal} [input.signal]
     */ async request(input) {
        return await request(this, input);
    }
    /**
     * Shares access with delegates.
     *
     * @param {object} input
     * @param {API.Delegation[]} input.delegations
     * @param {API.SpaceDID} [input.space]
     * @param {API.Delegation[]} [input.proofs]
     */ async delegate(input) {
        return await delegate(this, input);
    }
}
const claim = async ({ agent }, input)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Access$3e$__["Access"].claim(agent, input);
const request = async ({ agent }, input)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Access$3e$__["Access"].request(agent, input);
const createPendingAccessRequest = ({ agent }, input)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Access$3e$__["Access"].createPendingAccessRequest(agent, input);
const delegate = async ({ agent }, input)=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Access$3e$__["Access"].delegate(agent, input);
const { spaceAccess, accountAccess } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Access$3e$__["Access"]; //# sourceMappingURL=access.js.map
}),
"[project]/node_modules/@storacha/client/dist/capability/plan.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "PlanClient",
    ()=>PlanClient,
    "createAdminSession",
    ()=>createAdminSession,
    "createCheckoutSession",
    ()=>createCheckoutSession,
    "get",
    ()=>get,
    "set",
    ()=>set
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$types$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/types.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/plan.js [app-client] (ecmascript)");
;
;
;
class PlanClient extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Base"] {
    /**
     * Required delegated capabilities:
     * - `plan/get`
     *
     * @param {import('@storacha/access').AccountDID} account
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ async get(account, options) {
        const out = await get({
            agent: this.agent
        }, {
            ...options,
            account
        });
        if (!out.ok) {
            throw new Error(`failed ${__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["get"].can} invocation`, {
                cause: out.error
            });
        }
        return out.ok;
    }
    /**
     * Required delegated capabilities:
     * - `plan/set`
     *
     * @param {API.AccountDID} account
     * @param {API.DID} product
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ async set(account, product, options) {
        const out = await set({
            agent: this.agent
        }, {
            ...options,
            account,
            product
        });
        if (!out.ok) {
            throw new Error(`failed ${__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["set"].can} invocation`, {
                cause: out.error
            });
        }
        return out.ok;
    }
    /**
     *
     * @param {API.AccountDID} account
     * @param {string} returnURL
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ async createAdminSession(account, returnURL, options) {
        const out = await createAdminSession({
            agent: this.agent
        }, {
            ...options,
            account,
            returnURL
        });
        if (!out.ok) {
            throw new Error(`failed ${__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createAdminSession"].can} invocation`, {
                cause: out.error
            });
        }
        return out.ok;
    }
    /**
     *
     * @param {API.AccountDID} account
     * @param {object} options
     * @param {API.DID} options.planID
     * @param {string} [options.successURL]
     * @param {string} [options.cancelURL]
     * @param {boolean} [options.redirectAfterCompletion]
     * @param {boolean} [options.freeTrial]
     * @param {string} [options.nonce]
     */ async createCheckoutSession(account, options) {
        const out = await createCheckoutSession({
            agent: this.agent
        }, {
            ...options,
            account
        });
        if (!out.ok) {
            throw new Error(`failed ${__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createCheckoutSession"].can} invocation`, {
                cause: out.error
            });
        }
        return out.ok;
    }
}
const get = async ({ agent }, { account, nonce, proofs = [] })=>{
    const receipt = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["get"], {
        with: account,
        proofs,
        nonce
    });
    return receipt.out;
};
const set = async ({ agent }, { account, product, nonce, proofs = [] })=>{
    const receipt = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["set"], {
        with: account,
        nb: {
            product
        },
        nonce,
        proofs
    });
    return receipt.out;
};
const createAdminSession = async ({ agent }, { account, returnURL, nonce, proofs = [] })=>{
    const receipt = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createAdminSession"], {
        with: account,
        proofs,
        nonce,
        nb: {
            returnURL
        }
    });
    return receipt.out;
};
const createCheckoutSession = async ({ agent }, { account, planID, successURL, cancelURL, redirectAfterCompletion = true, freeTrial = false, nonce, proofs = [] })=>{
    const receipt = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createCheckoutSession"], {
        with: account,
        proofs,
        nonce,
        nb: {
            planID,
            successURL,
            cancelURL,
            redirectAfterCompletion,
            freeTrial
        }
    });
    return receipt.out;
}; //# sourceMappingURL=plan.js.map
}),
"[project]/node_modules/@storacha/client/dist/capability/subscription.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "SubscriptionClient",
    ()=>SubscriptionClient,
    "list",
    ()=>list
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$subscription$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Subscription$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/subscription.js [app-client] (ecmascript) <export * as Subscription>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$types$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/types.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)");
;
;
;
class SubscriptionClient extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Base"] {
    /**
     * List subscriptions for the passed account.
     *
     * Required delegated capabilities:
     * - `subscription/list`
     *
     * @param {import('@storacha/access').AccountDID} account
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ /* c8 ignore next */ async list(account, options) {
        const out = await list({
            agent: this.agent
        }, {
            ...options,
            account
        });
        /* c8 ignore next 8 */ if (!out.ok) {
            throw new Error(`failed ${__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$subscription$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Subscription$3e$__["Subscription"].list.can} invocation`, {
                cause: out.error
            });
        }
        return out.ok;
    }
}
const list = async ({ agent }, { account, nonce, proofs = [] })=>{
    const receipt = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$subscription$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Subscription$3e$__["Subscription"].list, {
        with: account,
        proofs,
        nb: undefined,
        nonce
    });
    return receipt.out;
}; //# sourceMappingURL=subscription.js.map
}),
"[project]/node_modules/@storacha/client/dist/account.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Account",
    ()=>Account,
    "AccountPlan",
    ()=>AccountPlan,
    "externalLogin",
    ()=>externalLogin,
    "list",
    ()=>list,
    "login",
    ()=>login
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$types$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/types.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/access.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__DIDMailto$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/did-mailto/dist/index.js [app-client] (ecmascript) <export * as DIDMailto>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/plan.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$subscription$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/subscription.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/agent.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Delegation$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-client] (ecmascript) <export * as Delegation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$provider$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/provider.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/did-mailto/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$ucan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/ucan.js [app-client] (ecmascript)");
;
;
;
;
;
;
;
;
;
const list = ({ agent }, { account } = {})=>{
    const query = {
        with: account ?? /did:mailto:.*/,
        can: '*'
    };
    const proofs = agent.proofs([
        query
    ]);
    /** @type {Record<API.DidMailto, Account>} */ const accounts = {};
    /** @type {Record<string, API.Delegation>} */ const attestations = {};
    for (const proof of proofs){
        const access = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Delegation$3e$__["Delegation"].allows(proof);
        for (const [resource, abilities] of Object.entries(access)){
            if (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$provider$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AccountDID"].is(resource) && abilities['*']) {
                const id = resource;
                const account = accounts[id] || (accounts[id] = new Account({
                    id,
                    agent,
                    proofs: []
                }));
                account.addProof(proof);
            }
            for (const settings of abilities['ucan/attest'] || []){
                const id = settings.proof;
                if (id) {
                    attestations[`${id}`] = proof;
                }
            }
        }
    }
    for (const account of Object.values(accounts)){
        for (const proof of account.proofs){
            const attestation = attestations[`${proof.cid}`];
            if (attestation) {
                account.addProof(attestation);
            }
        }
    }
    return accounts;
};
const login = async ({ agent }, email, options = {})=>{
    const account = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["fromEmail"])(email);
    // If we already have a session for this account we
    // skip the authentication process, otherwise we will
    // end up adding more UCAN proofs and attestations to
    // the store which we then will be sending when using
    // this account.
    // Note: This is not a robust solution as there may be
    // reasons to re-authenticate e.g. previous session is
    // no longer valid because it was revoked. But dropping
    // revoked UCANs from store is something we should do
    // anyway.
    const session = list({
        agent
    }, {
        account
    })[account];
    if (session) {
        return {
            ok: session
        };
    }
    const result = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["request"]({
        agent
    }, {
        account,
        access: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["accountAccess"],
        appName: options.appName,
        sso: options.sso
    });
    const { ok: access, error } = result;
    /* c8 ignore next 2 - don't know how to test this */ if (error) {
        return {
            error
        };
    } else {
        const { ok, error } = await access.claim({
            signal: options.signal
        });
        /* c8 ignore next 2 - don't know how to test this */ if (error) {
            return {
                error
            };
        } else {
            return {
                ok: new Account({
                    id: account,
                    proofs: ok.proofs,
                    agent
                })
            };
        }
    }
};
const externalLogin = async ({ agent }, { request, expiration, ...options })=>{
    const access = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createPendingAccessRequest"]({
        agent
    }, {
        request,
        expiration
    });
    const { ok, error } = await access.claim({
        signal: options.signal
    });
    /* c8 ignore next 2 - don't know how to test this */ if (error) {
        return {
            error
        };
    }
    let attestedProof;
    for (const p of ok.proofs){
        if (isUCANAttest(p)) {
            attestedProof = p.capabilities[0].nb.proof;
            break;
        }
    }
    if (!attestedProof) {
        return {
            error: new Error('missing attestation')
        };
    }
    let account;
    for (const p of ok.proofs){
        if (p.cid.toString() === attestedProof.toString()) {
            try {
                account = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__DIDMailto$3e$__["DIDMailto"].fromString(p.issuer.did());
            } catch (err) {
                return {
                    error: new Error('invalid account DID', {
                        cause: err
                    })
                };
            }
            break;
        }
    }
    if (!account) {
        return {
            error: new Error('missing attested delegation')
        };
    }
    return {
        ok: new Account({
            id: account,
            proofs: ok.proofs,
            agent
        })
    };
};
/* c8 ignore end */ /**
 * @param {API.Delegation} d
 * @returns {d is API.Delegation<[API.UCANAttest]>}
 */ const isUCANAttest = (d)=>d.capabilities[0].can === __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$ucan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["attest"].can;
class Account {
    /**
     * @param {Model} model
     */ constructor(model){
        this.model = model;
        this.plan = new AccountPlan(model);
    }
    get agent() {
        return this.model.agent;
    }
    get proofs() {
        return this.model.proofs;
    }
    did() {
        return this.model.id;
    }
    toEmail() {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["toEmail"])(this.did());
    }
    /**
     * @param {API.Delegation} proof
     */ addProof(proof) {
        this.proofs.push(proof);
    }
    toJSON() {
        return {
            id: this.did(),
            proofs: this.proofs// we sort proofs to get a deterministic JSON representation.
            .sort((a, b)=>a.cid.toString().localeCompare(b.cid.toString())).map((proof)=>proof.toJSON())
        };
    }
    /**
     * Provisions given `space` with this account.
     *
     * @param {API.SpaceDID} space
     * @param {object} input
     * @param {API.ProviderDID} [input.provider]
     * @param {API.Agent} [input.agent]
     */ provision(space, input = {}) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$provider$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add"])(this.agent, {
            ...input,
            account: this.did(),
            consumer: space,
            proofs: this.proofs
        });
    }
    /**
     * Saves account in the agent store so it can be accessed across sessions.
     *
     * @param {object} input
     * @param {API.Agent} [input.agent]
     */ async save({ agent = this.agent } = {}) {
        return await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["importAuthorization"])(agent, this);
    }
}
class AccountPlan {
    /**
     * @param {Model} model
     */ constructor(model){
        this.model = model;
    }
    /**
     * Gets information about the plan associated with this account.
     *
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ async get(options) {
        return await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["get"](this.model, {
            ...options,
            account: this.model.id,
            proofs: this.model.proofs
        });
    }
    /**
     * Sets the plan associated with this account.
     *
     * @param {import('@ucanto/interface').DID} productDID
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ async set(productDID, options) {
        return await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["set"](this.model, {
            ...options,
            account: this.model.id,
            product: productDID,
            proofs: this.model.proofs
        });
    }
    /**
     * Waits for a payment plan to be selected.
     * This method continuously checks the account's payment plan status
     * at a specified interval until a valid plan is selected, or when the timeout is reached,
     * or when the abort signal is aborted.
     *
     * @param {object} [options]
     * @param {number} [options.interval] - The polling interval in milliseconds (default is 1000ms).
     * @param {number} [options.timeout] - The maximum time to wait in milliseconds before throwing a timeout error (default is 15 minutes).
     * @param {AbortSignal} [options.signal] - An optional AbortSignal to cancel the waiting process.
     * @returns {Promise<import('@storacha/access').PlanGetSuccess>} - Resolves once a payment plan is selected within the timeout.
     * @throws {Error} - Throws an error if there is an issue retrieving the payment plan or if the timeout is exceeded.
     */ async wait(options) {
        const startTime = Date.now();
        const interval = options?.interval || 1000; // 1 second
        const timeout = options?.timeout || 60 * 15 * 1000; // 15 minutes
        // eslint-disable-next-line no-constant-condition
        while(true){
            const res = await this.get();
            if (res.ok) return res.ok;
            if (res.error) {
                if (res.error.name === 'PlanNotFound') {
                    continue;
                }
                throw new Error(`Error retrieving payment plan: ${JSON.stringify(res.error)}`);
            }
            if (Date.now() - startTime > timeout) {
                throw new Error('Timeout: Payment plan selection took too long.');
            }
            if (options?.signal?.aborted) {
                throw new Error('Aborted: Payment plan selection was aborted.');
            }
            console.log('Waiting for payment plan to be selected...');
            await new Promise((resolve)=>setTimeout(resolve, interval));
        }
    }
    /**
     *
     * @param {import('@storacha/access').AccountDID} accountDID
     * @param {string} returnURL
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ async createAdminSession(accountDID, returnURL, options) {
        return await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createAdminSession"](this.model, {
            ...options,
            account: accountDID,
            returnURL
        });
    }
    /**
     *
     * @param {import('@storacha/access').AccountDID} accountDID
     * @param {object} options
     * @param {import('@storacha/did-mailto').DidMailto} options.planID
     * @param {string} options.successURL
     * @param {string} options.cancelURL
     * @param {boolean} options.freeTrial
     * @param {string} [options.nonce]
     */ async createCheckoutSession(accountDID, options) {
        return await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createCheckoutSession"](this.model, {
            ...options,
            account: accountDID
        });
    }
    /**
     *
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ async subscriptions(options) {
        return await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$subscription$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["list"](this.model, {
            ...options,
            account: this.model.id,
            proofs: this.model.proofs
        });
    }
} //# sourceMappingURL=account.js.map
}),
"[project]/node_modules/@storacha/client/dist/capability/usage.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "UsageClient",
    ()=>UsageClient,
    "report",
    ()=>report
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$usage$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Usage$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/usage.js [app-client] (ecmascript) <export * as Usage>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$types$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/types.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)");
;
;
;
class UsageClient extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Base"] {
    /**
     * Get a usage report for the passed space in the given time period.
     *
     * Required delegated capabilities:
     * - `usage/report`
     *
     * @param {import('../types.js').SpaceDID} space
     * @param {{ from: Date, to: Date }} period
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ async report(space, period, options) {
        const out = await report({
            agent: this.agent
        }, {
            ...options,
            space,
            period
        });
        /* c8 ignore next 7 */ if (!out.ok) {
            throw new Error(`failed ${__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$usage$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Usage$3e$__["Usage"].report.can} invocation`, {
                cause: out.error
            });
        }
        return out.ok;
    }
}
const report = async ({ agent }, { space, period, nonce, proofs = [] })=>{
    const receipt = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$usage$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Usage$3e$__["Usage"].report, {
        with: space,
        proofs,
        nonce,
        nb: {
            period: {
                from: Math.floor(period.from.getTime() / 1000),
                to: Math.ceil(period.to.getTime() / 1000)
            }
        }
    });
    return receipt.out;
}; //# sourceMappingURL=usage.js.map
}),
"[project]/node_modules/@storacha/client/dist/space.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Space",
    ()=>Space,
    "StorageUsage",
    ()=>StorageUsage
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$space$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/space.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$usage$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/usage.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$types$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/types.js [app-client] (ecmascript) <locals>");
;
;
;
class Space {
    #model;
    /**
     * @param {Model} model
     */ constructor(model){
        this.#model = model;
        this.usage = new StorageUsage(model);
    }
    /**
     * The given space name.
     */ get name() {
        /* c8 ignore next */ return String(this.#model.meta?.name ?? '');
    }
    get access() {
        return this.#model.meta?.access ?? {
            type: 'public'
        };
    }
    /**
     * The DID of the space.
     */ did() {
        return this.#model.id;
    }
    /**
     * User defined space metadata.
     */ meta() {
        return this.#model.meta;
    }
}
class StorageUsage {
    #model;
    /**
     * @param {Model} model
     */ constructor(model){
        this.#model = model;
    }
    /**
     * Get the current usage in bytes.
     */ async get() {
        const { agent } = this.#model;
        const space = this.#model.id;
        const now = new Date();
        const period = {
            // we may not have done a snapshot for this month _yet_, so get report
            // from last month -> now
            from: startOfLastMonth(now),
            to: now
        };
        const result = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$usage$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["report"]({
            agent
        }, {
            space,
            period
        });
        /* c8 ignore next */ if (result.error) return result;
        const provider = agent.connection.id.did();
        const report = result.ok[provider];
        return {
            /* c8 ignore next */ ok: report?.size.final == null ? undefined : BigInt(report.size.final)
        };
    }
}
/** @param {string|number|Date} now */ const startOfMonth = (now)=>{
    const d = new Date(now);
    d.setUTCDate(1);
    d.setUTCHours(0);
    d.setUTCMinutes(0);
    d.setUTCSeconds(0);
    d.setUTCMilliseconds(0);
    return d;
};
/** @param {string|number|Date} now */ const startOfLastMonth = (now)=>{
    const d = startOfMonth(now);
    d.setUTCMonth(d.getUTCMonth() - 1);
    return d;
}; //# sourceMappingURL=space.js.map
}),
"[project]/node_modules/@storacha/client/dist/delegation.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "AgentDelegation",
    ()=>AgentDelegation
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-client] (ecmascript)");
;
;
class AgentDelegation extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Delegation"] {
    /* c8 ignore stop */ /** @type {Record<string, any>} */ #meta;
    /**
     * @param {import('./types.js').UCANBlock<C>} root
     * @param {Map<string, import('./types.js').Block>} [blocks]
     * @param {Record<string, any>} [meta]
     */ constructor(root, blocks, meta = {}){
        super(root, blocks);
        this.#meta = meta;
    }
    /**
     * User defined delegation metadata.
     */ meta() {
        return this.#meta;
    }
} //# sourceMappingURL=delegation.js.map
}),
"[project]/node_modules/@storacha/client/dist/capability/blob.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "BlobClient",
    ()=>BlobClient
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/upload-client/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$blob$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Blob$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/upload-client/dist/blob/index.js [app-client] (ecmascript) <export * as Blob>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$blob$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceBlob$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/space/blob.js [app-client] (ecmascript) <export * as SpaceBlob>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$sha2$2d$browser$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/hashes/sha2-browser.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)");
;
;
;
;
class BlobClient extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Base"] {
    /**
     * Store a Blob to the resource.
     *
     * Required delegated capabilities:
     * - `space/blob/add`
     *
     * @param {Blob} blob - blob data.
     * @param {import('../types.js').RequestOptions} [options]
     */ async add(blob, options = {}) {
        options = {
            receiptsEndpoint: this._receiptsEndpoint.toString(),
            connection: this._serviceConf.upload,
            ...options
        };
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$blob$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceBlob$3e$__["SpaceBlob"].add.can
        ]);
        const bytes = new Uint8Array(await blob.arrayBuffer());
        const digest = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$sha2$2d$browser$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["sha256"].digest(bytes);
        return {
            digest,
            ...await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$blob$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Blob$3e$__["Blob"].add(conf, digest, bytes, options)
        };
    }
    /**
     * List blobs stored to the resource.
     *
     * Required delegated capabilities:
     * - `space/blob/list`
     *
     * @param {import('../types.js').ListRequestOptions} [options]
     */ async list(options = {}) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$blob$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceBlob$3e$__["SpaceBlob"].list.can
        ]);
        options.connection = this._serviceConf.upload;
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$blob$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Blob$3e$__["Blob"].list(conf, options);
    }
    /**
     * Remove a stored blob by multihash digest.
     *
     * Required delegated capabilities:
     * - `space/blob/remove`
     *
     * @param {import('multiformats').MultihashDigest} digest - digest of blob to remove.
     * @param {import('../types.js').RequestOptions} [options]
     */ async remove(digest, options = {}) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$blob$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceBlob$3e$__["SpaceBlob"].remove.can
        ]);
        options.connection = this._serviceConf.upload;
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$blob$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Blob$3e$__["Blob"].remove(conf, digest, options);
    }
    /**
     * Gets a stored blob by multihash digest.
     *
     * @param {import('multiformats').MultihashDigest} digest - digest of blob to get.
     * @param {import('../types.js').RequestOptions} [options]
     */ async get(digest, options = {}) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$blob$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceBlob$3e$__["SpaceBlob"].get.can
        ]);
        options.connection = this._serviceConf.upload;
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$blob$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Blob$3e$__["Blob"].get(conf, digest, options);
    }
    /**
     * Replicate a blob to the specified number of nodes.
     *
     * @param {object} blob - details of the blob to replicate
     * @param {import('multiformats').MultihashDigest} blob.digest - hash of the blob
     * @param {number} blob.size - size of the blob in bytes
     * @param {import('../types.js').Delegation<[AssertLocation]>} site - location commitment specifying where the blob can be obtained.
     * @param {number} replicas - total number of replicas to provision.
     * @param {import('../types.js').RequestOptions} [options]
     */ async replicate(blob, site, replicas, options = {}) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$blob$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceBlob$3e$__["SpaceBlob"].replicate.can
        ]);
        options.connection = this._serviceConf.upload;
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$blob$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Blob$3e$__["Blob"].replicate(conf, blob, site, replicas, options);
    }
} //# sourceMappingURL=blob.js.map
}),
"[project]/node_modules/@storacha/client/dist/capability/index.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "IndexClient",
    ()=>IndexClient
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/upload-client/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$index$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Index$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/upload-client/dist/index/index.js [app-client] (ecmascript) <export * as Index>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceIndex$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/space/index.js [app-client] (ecmascript) <export * as SpaceIndex>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)");
;
;
;
class IndexClient extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Base"] {
    /**
     * Register an "index" to the resource.
     *
     * Required delegated capabilities:
     * - `space/index/add`
     *
     * @param {import('../types.js').CARLink} index - CID of the CAR file that contains the index data.
     * @param {import('../types.js').RequestOptions} [options]
     */ async add(index, options = {}) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceIndex$3e$__["SpaceIndex"].add.can
        ]);
        options.connection = this._serviceConf.upload;
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$index$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Index$3e$__["Index"].add(conf, index, options);
    }
} //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@storacha/client/dist/capability/upload.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "UploadClient",
    ()=>UploadClient
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/upload-client/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$upload$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/upload-client/dist/upload/index.js [app-client] (ecmascript) <export * as Upload>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$upload$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/upload.js [app-client] (ecmascript) <export * as Upload>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)");
;
;
;
class UploadClient extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Base"] {
    /**
     * Register an "upload" to the resource.
     *
     * Required delegated capabilities:
     * - `upload/add`
     *
     * @param {import('../types.js').UnknownLink} root - Root data CID for the DAG that was stored.
     * @param {import('../types.js').CARLink[]} shards - CIDs of CAR files that contain the DAG.
     * @param {import('../types.js').RequestOptions} [options]
     */ async add(root, shards, options = {}) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$upload$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__["Upload"].add.can
        ]);
        options.connection = this._serviceConf.upload;
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$upload$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__["Upload"].add(conf, root, shards, options);
    }
    /**
     * Get details of an "upload".
     *
     * Required delegated capabilities:
     * - `upload/get`
     *
     * @param {import('../types.js').UnknownLink} root - Root data CID for the DAG that was stored.
     * @param {import('../types.js').RequestOptions} [options]
     */ async get(root, options = {}) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$upload$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__["Upload"].get.can
        ]);
        options.connection = this._serviceConf.upload;
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$upload$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__["Upload"].get(conf, root, options);
    }
    /**
     * List uploads registered to the resource.
     *
     * Required delegated capabilities:
     * - `upload/list`
     *
     * @param {import('../types.js').ListRequestOptions} [options]
     */ async list(options = {}) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$upload$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__["Upload"].list.can
        ]);
        options.connection = this._serviceConf.upload;
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$upload$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__["Upload"].list(conf, options);
    }
    /**
     * Remove an upload by root data CID.
     *
     * Required delegated capabilities:
     * - `upload/remove`
     *
     * @param {import('../types.js').UnknownLink} root - Root data CID to remove.
     * @param {import('../types.js').RequestOptions} [options]
     */ async remove(root, options = {}) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$upload$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__["Upload"].remove.can
        ]);
        options.connection = this._serviceConf.upload;
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$upload$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__["Upload"].remove(conf, root, options);
    }
} //# sourceMappingURL=upload.js.map
}),
"[project]/node_modules/@storacha/client/dist/capability/space.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "SpaceClient",
    ()=>SpaceClient,
    "egressRecord",
    ()=>egressRecord
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Space$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/space.js [app-client] (ecmascript) <export * as Space>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$types$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/types.js [app-client] (ecmascript) <locals>");
;
;
;
class SpaceClient extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Base"] {
    /**
     * Get information about a space.
     *
     * Required delegated capabilities:
     * - `space/info`
     *
     * @param {import('../types.js').DID} space - DID of the space to retrieve info about.
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ async info(space, options) {
        return await this._agent.getSpaceInfo(space, options);
    }
    /**
     * Record egress data for a served resource.
     * It will execute the capability invocation to find the customer and then record the egress data for the resource.
     *
     * Required delegated capabilities:
     * - `space/content/serve/egress/record`
     *
     * @param {object} egressData
     * @param {import('../types.js').SpaceDID} egressData.space
     * @param {API.UnknownLink} egressData.resource
     * @param {number} egressData.bytes
     * @param {string} egressData.servedAt
     * @param {object} [options]
     * @param {string} [options.nonce]
     * @param {API.Delegation[]} [options.proofs]
     * @returns {Promise<API.EgressRecordSuccess>}
     */ async egressRecord(egressData, options) {
        const out = await egressRecord({
            agent: this.agent
        }, {
            ...egressData
        }, {
            ...options
        });
        if (!out.ok) {
            throw new Error(`failed ${__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Space$3e$__["Space"].egressRecord.can} invocation`, {
                cause: out.error
            });
        }
        return out.ok;
    }
}
const egressRecord = async ({ agent }, { space, resource, bytes, servedAt }, { nonce, proofs = [] })=>{
    const receipt = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Space$3e$__["Space"].egressRecord, {
        with: space,
        proofs,
        nonce,
        nb: {
            resource,
            bytes,
            servedAt: Math.floor(new Date(servedAt).getTime() / 1000)
        }
    });
    return receipt.out;
}; //# sourceMappingURL=space.js.map
}),
"[project]/node_modules/@storacha/client/dist/capability/account/usage.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "AccountUsageClient",
    ()=>AccountUsageClient,
    "get",
    ()=>get
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$account$2f$usage$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__AccountUsage$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/account/usage.js [app-client] (ecmascript) <export * as AccountUsage>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$types$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/types.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)");
;
;
;
class AccountUsageClient extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Base"] {
    /**
     * Get a usage report for the passed space in the given time period.
     *
     * Required delegated capabilities:
     * - `usage/report`
     *
     * @param {API.AccountDID} account
     * @param {object} [options]
     * @param {{ from: Date, to: Date }} [options.period]
     * @param {import('../../types.js').SpaceDID[]} [options.spaces]
     * @param {string} [options.nonce]
     */ async get(account, options) {
        const out = await get({
            agent: this.agent
        }, {
            ...options,
            account
        });
        /* c8 ignore next 7 */ if (!out.ok) {
            throw new Error(`failed ${__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$account$2f$usage$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__AccountUsage$3e$__["AccountUsage"].get.can} invocation`, {
                cause: out.error
            });
        }
        return out.ok;
    }
}
const get = async ({ agent }, { account, spaces, period, nonce, proofs = [] })=>{
    const receipt = await agent.invokeAndExecute(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$account$2f$usage$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__AccountUsage$3e$__["AccountUsage"].get, {
        with: account,
        proofs,
        nonce,
        nb: {
            spaces,
            period: period ? {
                from: Math.floor(period.from.getTime() / 1000),
                to: Math.ceil(period.to.getTime() / 1000)
            } : undefined
        }
    });
    return receipt.out;
}; //# sourceMappingURL=usage.js.map
}),
"[project]/node_modules/@storacha/client/dist/capability/filecoin.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "FilecoinClient",
    ()=>FilecoinClient
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/filecoin-client/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$storefront$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Storefront$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/filecoin-client/dist/storefront.js [app-client] (ecmascript) <export * as Storefront>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Filecoin$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/filecoin/index.js [app-client] (ecmascript) <export * as Filecoin>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)");
;
;
;
class FilecoinClient extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Base"] {
    /**
     * Offer a Filecoin "piece" to the resource.
     *
     * Required delegated capabilities:
     * - `filecoin/offer`
     *
     * @param {import('multiformats').UnknownLink} content
     * @param {import('@storacha/capabilities/types').PieceLink} piece
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ async offer(content, piece, options) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Filecoin$3e$__["Filecoin"].offer.can
        ]);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$storefront$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Storefront$3e$__["Storefront"].filecoinOffer(conf, content, piece, {
            ...options,
            connection: this._serviceConf.filecoin
        });
    }
    /**
     * Request info about a content piece in Filecoin deals
     *
     * Required delegated capabilities:
     * - `filecoin/info`
     *
     * @param {import('@storacha/capabilities/types').PieceLink} piece
     * @param {object} [options]
     * @param {string} [options.nonce]
     */ async info(piece, options) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Filecoin$3e$__["Filecoin"].info.can
        ]);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$filecoin$2d$client$2f$dist$2f$storefront$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Storefront$3e$__["Storefront"].filecoinInfo(conf, piece, {
            ...options,
            connection: this._serviceConf.filecoin
        });
    }
} //# sourceMappingURL=filecoin.js.map
}),
"[project]/node_modules/@storacha/client/dist/coupon.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Coupon",
    ()=>Coupon,
    "CouponAPI",
    ()=>CouponAPI,
    "archive",
    ()=>archive,
    "extract",
    ()=>extract,
    "issue",
    ()=>issue,
    "redeem",
    ()=>redeem
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$types$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/types.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/lib.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$sha2$2d$browser$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/multiformats/dist/src/hashes/sha2-browser.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Delegation$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/delegation.js [app-client] (ecmascript) <export * as Delegation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$lib$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/lib.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__ed25519$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/ed25519.js [app-client] (ecmascript) <export * as ed25519>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/result.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/core/src/result.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/access.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)");
;
;
;
;
;
;
class CouponAPI extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Base"] {
    /**
     * Redeems coupon from the the the archive. Throws an error if the coupon
     * password is invalid or if provided archive is not a valid.
     *
     * @param {Uint8Array} archive
     * @param {object} [options]
     * @param {string} [options.password]
     */ async redeem(archive, options = {}) {
        const { agent } = this;
        const coupon = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["unwrap"](await extract(archive));
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["unwrap"](await redeem(coupon, {
            ...options,
            agent
        }));
    }
    /**
     * Issues a coupon for the given delegation.
     *
     * @param {Omit<CouponOptions, 'issuer'>} options
     */ async issue({ proofs = [], ...options }) {
        const { agent } = this;
        return await issue({
            ...options,
            issuer: agent.issuer,
            proofs: [
                ...proofs,
                ...agent.proofs(options.capabilities)
            ]
        });
    }
}
const extract = async (archive)=>{
    const { ok, error } = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Delegation$3e$__["Delegation"].extract(archive);
    return ok ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["ok"](new Coupon({
        proofs: [
            ok
        ]
    })) : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["error"](error);
};
const archive = async (coupon)=>{
    const [delegation] = coupon.proofs;
    return await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Delegation$3e$__["Delegation"].archive(delegation);
};
const issue = async ({ password = '', ...options })=>{
    const audience = await deriveSigner(password);
    const delegation = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["delegate"])({
        ...options,
        audience
    });
    return new Coupon({
        proofs: [
            delegation
        ]
    });
};
const redeem = async (coupon, { agent, password = '' })=>{
    const audience = await deriveSigner(password);
    const [delegation] = coupon.proofs;
    if (delegation.audience.did() !== audience.did()) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["error"](new RangeError(password === '' ? 'Extracting account requires a password' : 'Provided password is invalid'));
    } else {
        const authorization = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["delegate"])({
            issuer: audience,
            audience: agent,
            capabilities: delegation.capabilities,
            expiration: delegation.expiration,
            notBefore: delegation.notBefore,
            proofs: [
                delegation
            ]
        });
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$core$2f$src$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["ok"](new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["GrantedAccess"]({
            agent,
            proofs: [
                authorization
            ]
        }));
    }
};
/**
 * @param {string} password
 */ const deriveSigner = async (password)=>{
    const { digest } = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$multiformats$2f$dist$2f$src$2f$hashes$2f$sha2$2d$browser$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["sha256"].digest(new TextEncoder().encode(password));
    return await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$ed25519$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__ed25519$3e$__["ed25519"].Signer.derive(digest);
};
class Coupon {
    /**
     * @param {Model} model
     */ constructor(model){
        this.model = model;
    }
    get proofs() {
        return this.model.proofs;
    }
    /**
     *
     * @param {API.Agent} agent
     * @param {object} [options]
     * @param {string} [options.password]
     */ redeem(agent, options = {}) {
        return redeem(this, {
            ...options,
            agent
        });
    }
    archive() {
        return archive(this);
    }
} //# sourceMappingURL=coupon.js.map
}),
"[project]/node_modules/@storacha/client/dist/client.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Client",
    ()=>Client,
    "authorizeContentServe",
    ()=>authorizeContentServe
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/upload-client/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$receipts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Receipt$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/upload-client/dist/receipts.js [app-client] (ecmascript) <export * as Receipt>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Access$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/access.js [app-client] (ecmascript) <export * as Access>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$blob$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceBlob$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/space/blob.js [app-client] (ecmascript) <export * as SpaceBlob>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceIndex$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/space/index.js [app-client] (ecmascript) <export * as SpaceIndex>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$upload$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/upload.js [app-client] (ecmascript) <export * as Upload>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Filecoin$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/filecoin/index.js [app-client] (ecmascript) <export * as Filecoin>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Space$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/space.js [app-client] (ecmascript) <export * as Space>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/did-mailto/dist/index.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/base.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$account$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/account.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$space$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/space.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/delegation.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$blob$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/blob.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$upload$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/upload.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$space$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/space.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$subscription$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/subscription.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$usage$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/usage.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$account$2f$usage$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/account/usage.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/access.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/plan.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$filecoin$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/capability/filecoin.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$coupon$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/coupon.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/result.js [app-client] (ecmascript) <locals>");
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
class Client extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$base$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Base"] {
    /**
     * @param {import('@storacha/access').AgentData} agentData
     * @param {object} [options]
     * @param {import('./types.js').ServiceConf} [options.serviceConf]
     * @param {URL} [options.receiptsEndpoint]
     */ constructor(agentData, options){
        super(agentData, options);
        this.capability = {
            access: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["AccessClient"](agentData, options),
            filecoin: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$filecoin$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["FilecoinClient"](agentData, options),
            index: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["IndexClient"](agentData, options),
            plan: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$plan$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["PlanClient"](agentData, options),
            space: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$space$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SpaceClient"](agentData, options),
            blob: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$blob$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["BlobClient"](agentData, options),
            subscription: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$subscription$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SubscriptionClient"](agentData, options),
            upload: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$upload$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["UploadClient"](agentData, options),
            usage: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$usage$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["UsageClient"](agentData, options),
            account: {
                usage: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$capability$2f$account$2f$usage$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AccountUsageClient"](agentData, options)
            }
        };
        this.coupon = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$coupon$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CouponAPI"](agentData, options);
    }
    did() {
        return this._agent.did();
    }
    /* c8 ignore start */ /**
     * @deprecated - Use client.login instead.
     *
     * Authorize the current agent to use capabilities granted to the passed
     * email account.
     *
     * @param {`${string}@${string}`} email
     * @param {object} [options]
     * @param {AbortSignal} [options.signal]
     * @param {Iterable<{ can: import('./types.js').Ability }>} [options.capabilities]
     */ async authorize(email, options) {
        await this.capability.access.authorize(email, options);
    }
    /* c8 ignore stop */ /**
     * @param {Account.EmailAddress} email
     * @param {object} [options]
     * @param {AbortSignal} [options.signal]
     * @param {import('@storacha/client/types').AppName} [options.appName]
     * @param {import('@storacha/client/types').SSORequestParams} [options.sso] - SSO authentication request (all fields required if provided)
     */ async login(email, options = {}) {
        const account = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["unwrap"](await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$account$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["login"](this, email, options));
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["unwrap"](await account.save());
        return account;
    }
    /**
     * List all accounts that agent has stored access to.
     *
     * @returns {Record<DIDMailto.DidMailto, Account.Account>} A dictionary with `did:mailto` as keys and `Account` instances as values.
     */ accounts() {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$account$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["list"](this);
    }
    /**
     * Uploads a file to the service and returns the root data CID for the
     * generated DAG.
     *
     * Required delegated capabilities:
     * - `filecoin/offer`
     * - `space/blob/add`
     * - `space/index/add`
     * - `upload/add`
     *
     * @param {import('./types.js').BlobLike} file - File data.
     * @param {import('./types.js').UploadFileOptions} [options]
     */ async uploadFile(file, options = {}) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$blob$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceBlob$3e$__["SpaceBlob"].add.can,
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceIndex$3e$__["SpaceIndex"].add.can,
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Filecoin$3e$__["Filecoin"].offer.can,
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$upload$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__["Upload"].add.can
        ]);
        options = {
            receiptsEndpoint: this._receiptsEndpoint.toString(),
            connection: this._serviceConf.upload,
            ...options
        };
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["uploadFile"])(conf, file, options);
    }
    /**
     * Uploads a directory of files to the service and returns the root data CID
     * for the generated DAG. All files are added to a container directory, with
     * paths in the file names preserved.
     *
     * Required delegated capabilities:
     * - `filecoin/offer`
     * - `space/blob/add`
     * - `space/index/add`
     * - `upload/add`
     *
     * @param {import('./types.js').FileLike[]} files - File data.
     * @param {import('./types.js').UploadDirectoryOptions} [options]
     */ async uploadDirectory(files, options = {}) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$blob$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceBlob$3e$__["SpaceBlob"].add.can,
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceIndex$3e$__["SpaceIndex"].add.can,
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Filecoin$3e$__["Filecoin"].offer.can,
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$upload$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__["Upload"].add.can
        ]);
        options = {
            receiptsEndpoint: this._receiptsEndpoint.toString(),
            connection: this._serviceConf.upload,
            ...options
        };
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["uploadDirectory"])(conf, files, options);
    }
    /**
     * Uploads a CAR file to the service.
     *
     * The difference between this function and `capability.blob.add` is that
     * the CAR file is automatically sharded, an index is generated, uploaded and
     * registered (see `capability.index.add`) and finally an an "upload" is
     * registered, linking the individual shards (see `capability.upload.add`).
     *
     * Use the `onShardStored` callback to obtain the CIDs of the CAR file shards.
     *
     * Required delegated capabilities:
     * - `filecoin/offer`
     * - `space/blob/add`
     * - `space/index/add`
     * - `upload/add`
     *
     * @param {import('./types.js').BlobLike} car - CAR file.
     * @param {import('./types.js').UploadOptions} [options]
     */ async uploadCAR(car, options = {}) {
        const conf = await this._invocationConfig([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$blob$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceBlob$3e$__["SpaceBlob"].add.can,
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__SpaceIndex$3e$__["SpaceIndex"].add.can,
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$filecoin$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Filecoin$3e$__["Filecoin"].offer.can,
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$upload$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Upload$3e$__["Upload"].add.can
        ]);
        options = {
            receiptsEndpoint: this._receiptsEndpoint.toString(),
            connection: this._serviceConf.upload,
            ...options
        };
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["uploadCAR"])(conf, car, options);
    }
    /**
     * Get a receipt for an executed task by its CID.
     *
     * @template {import('./types.js').Capability} C
     * @template {Record<string, any>} S
     * @param {import('./types.js').UCANLink<[C]>} taskCid
     * @param {import('./types.js').ReceiptGetOptions<S> & import('./types.js').Retryable} [options]
     * @returns {Promise<import('./types.js').InferReceipt<C, S>>}
     */ async getReceipt(taskCid, options) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$upload$2d$client$2f$dist$2f$receipts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Receipt$3e$__["Receipt"].poll(taskCid, {
            endpoint: new URL(this._receiptsEndpoint),
            ...options
        });
    }
    /**
     * Return the default provider.
     */ defaultProvider() {
        return this._agent.connection.id.did();
    }
    /**
     * The current space.
     */ currentSpace() {
        const agent = this._agent;
        const id = agent.currentSpace();
        if (!id) return;
        const meta = agent.spaces.get(id);
        return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$space$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["Space"]({
            id,
            meta,
            agent
        });
    }
    /**
     * Use a specific space.
     *
     * @param {import('./types.js').DID} did
     */ async setCurrentSpace(did) {
        await this._agent.setCurrentSpace(did);
    }
    /**
     * Spaces available to this agent.
     */ spaces() {
        return [
            ...this._agent.spaces
        ].map(([id, meta])=>{
            // @ts-expect-error id is not did:key
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$space$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["Space"]({
                id,
                meta,
                agent: this._agent
            });
        });
    }
    /**
     * Creates a new space with a given name.
     * If an account is not provided, the space is created without any delegation and is not saved, hence it is a temporary space.
     * When an account is provided in the options argument, then it creates a delegated recovery account
     * by provisioning the space, saving it and then delegating access to the recovery account.
     * In addition, it authorizes the listed Gateway Services to serve content from the created space.
     * It is done by delegating the `space/content/serve/*` capability to the Gateway Service.
     * User can skip the Gateway authorization by setting the `skipGatewayAuthorization` option to `true`.
     * If no gateways are specified or the `skipGatewayAuthorization` flag is not set, the client will automatically grant access
     * to the Storacha Gateway by default (https://w3s.link/).
     *
     * @typedef {import('./types.js').ConnectionView<import('./types.js').ContentServeService>} ConnectionView
     *
     * @typedef {object} SpaceCreateOptions
     * @property {Account.Account} [account] - The account configured as the recovery account for the space.
     * @property {Array<ConnectionView>} [authorizeGatewayServices] - The DID Key or DID Web of the Gateway to authorize to serve content from the created space.
     * @property {boolean} [skipGatewayAuthorization] - Whether to skip the Gateway authorization. It means that the content of the space will not be served by any Gateway.
     * @property {import('@storacha/access').SpaceAccessType} [access] - Access type for the space - determines client-side encryption behavior.
     *
     * @param {string} name - The name of the space to create.
     * @param {SpaceCreateOptions} [options] - Options for the space creation.
     * @returns {Promise<import("./space.js").OwnedSpace>} The created space owned by the agent.
     */ async createSpace(name, options = {}) {
        // Save the space to authorize the client to use the space
        const { access, account, skipGatewayAuthorization, authorizeGatewayServices } = options;
        const space = await this._agent.createSpace(name, {
            access
        });
        if (account) {
            // Provision the account with the space
            const provisionResult = await account.provision(space.did());
            if (provisionResult.error) {
                throw new Error(`failed to provision account: ${provisionResult.error.message}`, {
                    cause: provisionResult.error
                });
            }
            // Save the space to authorize the client to use the space
            await space.save();
            // Create a recovery for the account
            const recovery = await space.createRecovery(account.did());
            // Delegate space access to the recovery
            const delegationResult = await this.capability.access.delegate({
                space: space.did(),
                delegations: [
                    recovery
                ]
            });
            if (delegationResult.error) {
                // c8 ignore next 4
                throw new Error(`failed to authorize recovery account: ${delegationResult.error.message}`, {
                    cause: delegationResult.error
                });
            }
        }
        // Authorize the listed Gateway Services to serve content from the created space
        if (skipGatewayAuthorization !== true) {
            let gatewayServices = authorizeGatewayServices;
            if (!gatewayServices || gatewayServices.length === 0) {
                // If no Gateway Services are provided, authorize the Storacha Gateway Service
                gatewayServices = [
                    this._serviceConf.gateway
                ];
            }
            // Save the space to authorize the client to use the space
            await space.save();
            for (const serviceConnection of gatewayServices){
                await authorizeContentServe(this, space, serviceConnection);
            }
        }
        return space;
    }
    /**
     * Share an existing space with another Storacha account via email address delegation.
     * Delegates access to the space to the specified email account with the following permissions:
     * - space/* - for managing space metadata
     * - blob/* - for managing blobs
     * - store/* - for managing stores
     * - upload/*- for registering uploads
     * - access/* - for re-delegating access to other devices
     * - filecoin/* - for submitting to the filecoin pipeline
     * - usage/* - for querying usage
     * The default expiration is set to infinity.
     *
     * @typedef {object} ShareOptions
     * @property {import('./types.js').ServiceAbility[]} abilities - Abilities to delegate to the delegate account.
     * @property {number} expiration - Expiration time in seconds.
     
     * @param {import("./types.js").EmailAddress} delegateEmail - Email of the account to share the space with.
     * @param {import('./types.js').SpaceDID} spaceDID - The DID of the space to share.
     * @param {ShareOptions} [options] - Options for the delegation.
     *
     * @returns {Promise<import('./delegation.js').AgentDelegation<any>>} Resolves with the AgentDelegation instance once the space is successfully shared.
     * @throws {Error} - Throws an error if there is an issue delegating access to the space.
     */ async shareSpace(delegateEmail, spaceDID, options = {
        abilities: [
            'space/*',
            'store/*',
            'upload/*',
            'access/*',
            'usage/*',
            'filecoin/*'
        ],
        expiration: Infinity
    }) {
        const { abilities, ...restOptions } = options;
        const currentSpace = this.agent.currentSpace();
        try {
            // Make sure the agent is using the shared space before delegating
            await this.agent.setCurrentSpace(spaceDID);
            // Delegate capabilities to the delegate account to access the **current space**
            const { root, blocks } = await this.agent.delegate({
                ...restOptions,
                abilities,
                audience: {
                    did: ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["fromEmail"](__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$did$2d$mailto$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["email"](delegateEmail))
                },
                // @ts-expect-error audienceMeta is not defined in ShareOptions
                audienceMeta: options.audienceMeta ?? {}
            });
            const delegation = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["AgentDelegation"](root, blocks, {
                audience: delegateEmail
            });
            const sharingResult = await this.capability.access.delegate({
                space: spaceDID,
                delegations: [
                    delegation
                ]
            });
            if (sharingResult.error) {
                throw new Error(`failed to share space with ${delegateEmail}: ${sharingResult.error.message}`, {
                    cause: sharingResult.error
                });
            }
            return delegation;
        } finally{
            // Reset to the original space if it was different
            if (currentSpace && currentSpace !== spaceDID) {
                await this.agent.setCurrentSpace(currentSpace);
            }
        }
    }
    /* c8 ignore stop */ /**
     * Add a space from a received proof.
     *
     * @param {import('./types.js').Delegation} proof
     */ async addSpace(proof) {
        return await this._agent.importSpaceFromDelegation(proof);
    }
    /**
     * Get all the proofs matching the capabilities.
     *
     * Proofs are delegations with an _audience_ matching the agent DID.
     *
     * @param {import('./types.js').Capability[]} [caps] - Capabilities to
     * filter by. Empty or undefined caps with return all the proofs.
     */ proofs(caps) {
        return this._agent.proofs(caps);
    }
    /**
     * Add a proof to the agent. Proofs are delegations with an _audience_
     * matching the agent DID.
     *
     * @param {import('./types.js').Delegation} proof
     */ async addProof(proof) {
        await this._agent.addProof(proof);
    }
    /**
     * Get delegations created by the agent for others.
     *
     * @param {import('./types.js').Capability[]} [caps] - Capabilities to
     * filter by. Empty or undefined caps with return all the delegations.
     */ delegations(caps) {
        const delegations = [];
        for (const { delegation, meta } of this._agent.delegationsWithMeta(caps)){
            delegations.push(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["AgentDelegation"](delegation.root, delegation.blocks, meta));
        }
        return delegations;
    }
    /**
     * Create a delegation to the passed audience for the given abilities with
     * the _current_ space as the resource.
     *
     * @param {import('./types.js').Principal} audience
     * @param {import('./types.js').ServiceAbility[]} abilities
     * @param {Omit<import('./types.js').UCANOptions, 'audience'> & { audienceMeta?: import('./types.js').AgentMeta }} [options]
     */ async createDelegation(audience, abilities, options = {}) {
        const audienceMeta = options.audienceMeta ?? {
            name: 'agent',
            type: 'device'
        };
        const { root, blocks } = await this._agent.delegate({
            ...options,
            abilities,
            audience,
            audienceMeta
        });
        return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$delegation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["AgentDelegation"](root, blocks, {
            audience: audienceMeta
        });
    }
    /**
     * Revoke a delegation by CID.
     *
     * If the delegation was issued by this agent (and therefore is stored in the
     * delegation store) you can just pass the CID. If not, or if the current agent's
     * delegation store no longer contains the delegation, you MUST pass a chain of
     * proofs that proves your authority to revoke this delegation as `options.proofs`.
     *
     * @param {import('@ucanto/interface').UCANLink} delegationCID
     * @param {object} [options]
     * @param {import('@ucanto/interface').Delegation[]} [options.proofs]
     */ async revokeDelegation(delegationCID, options = {}) {
        return this._agent.revoke(delegationCID, {
            proofs: options.proofs
        });
    }
    /**
     * Removes association of a content CID with the space. Optionally, also removes
     * association of CAR shards with space.
     *
     *  If `shards` option is `true` all shards will be deleted even if there is another upload(s) that
     * reference same shards, which in turn could corrupt those uploads.
     *
     * Required delegated capabilities:
     * - `space/blob/remove`
     * - `store/remove`
     * - `upload/get`
     * - `upload/remove`
     *
     * @param {import('multiformats').UnknownLink} contentCID
     * @param {object} [options]
     * @param {boolean} [options.shards]
     */ async remove(contentCID, options = {}) {
        // Shortcut if there is no request to remove shards
        if (!options.shards) {
            // Remove association of content CID with selected space.
            await this.capability.upload.remove(contentCID);
            return;
        }
        // Get shards associated with upload.
        const upload = await this.capability.upload.get(contentCID);
        // Remove shards
        if (upload.shards?.length) {
            await Promise.allSettled(upload.shards.map((shard)=>this.capability.blob.remove(shard.multihash)));
        }
        // Remove association of content CID with selected space.
        await this.capability.upload.remove(contentCID);
    }
}
const authorizeContentServe = async (client, space, connection, options = {})=>{
    const currentSpace = client.currentSpace();
    try {
        // Set the current space to the space we are authorizing the gateway for, otherwise the delegation will fail
        await client.setCurrentSpace(space.did());
        /** @type {import('@ucanto/client').Principal<`did:${string}:${string}`>} */ const audience = {
            did: ()=>options.audience ?? connection.id.did()
        };
        // Grant the audience the ability to serve content from the space, it includes existing proofs automatically
        const delegation = await client.createDelegation(audience, [
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$space$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Space$3e$__["Space"].contentServe.can
        ], {
            expiration: options.expiration ?? Infinity
        });
        // Publish the delegation to the content serve service
        const accessProofs = client.proofs([
            {
                can: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Access$3e$__["Access"].access.can,
                with: space.did()
            }
        ]);
        const verificationResult = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$access$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__Access$3e$__["Access"].delegate.invoke({
            issuer: client.agent.issuer,
            audience,
            with: space.did(),
            proofs: [
                ...accessProofs,
                delegation
            ],
            nb: {
                delegations: {
                    [delegation.cid.toString()]: delegation.cid
                }
            }
        }).execute(connection);
        /* c8 ignore next 8 - can't mock this error */ if (verificationResult.out.error) {
            throw new Error(`failed to publish delegation for audience ${audience.did()}: ${verificationResult.out.error.message}`, {
                cause: verificationResult.out.error
            });
        }
        return {
            ok: {
                ...verificationResult.out.ok,
                delegation
            }
        };
    } finally{
        if (currentSpace) {
            await client.setCurrentSpace(currentSpace.did());
        }
    }
}; //# sourceMappingURL=client.js.map
}),
"[project]/node_modules/@storacha/client/dist/ability.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "asAbilities",
    ()=>asAbilities
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/capabilities/dist/index.js [app-client] (ecmascript) <locals>");
;
const setOfAbilities = new Set(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$capabilities$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["abilitiesAsStrings"]);
function asAbilities(abilities) {
    for (const ability of abilities){
        if (!setOfAbilities.has(ability)) {
            throw new Error(`${ability} is not a supported capability`);
        }
    }
    return abilities;
} //# sourceMappingURL=ability.js.map
}),
"[project]/node_modules/@storacha/client/dist/index.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

/**
 * The main entry point for the `@storacha/client` package.
 *
 * Use the static {@link create} function to create a new {@link Client} object.
 *
 * @module
 */ __turbopack_context__.s([
    "create",
    ()=>create
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/agent.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2d$data$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/agent-data.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$stores$2f$store$2d$indexeddb$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/access/dist/stores/store-indexeddb.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@ucanto/principal/src/rsa.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$client$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/client.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$result$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/result.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$account$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/account.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$ability$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@storacha/client/dist/ability.js [app-client] (ecmascript)");
;
;
;
;
;
;
;
;
async function create(options = {}) {
    const store = options.store ?? new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$stores$2f$store$2d$indexeddb$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["StoreIndexedDB"]('w3up-client');
    const raw = await store.load();
    if (raw) {
        const data = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2d$data$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AgentData"].fromExport(raw, {
            store
        });
        if (options.principal && data.principal.did() !== options.principal.did()) {
            throw new Error(`store cannot be used with ${options.principal.did()}, stored principal and passed principal must match`);
        }
        return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$client$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["Client"](data, options);
    }
    const principal = options.principal ?? await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$ucanto$2f$principal$2f$src$2f$rsa$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["generate"])();
    const data = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$access$2f$dist$2f$agent$2d$data$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AgentData"].create({
        principal
    }, {
        store
    });
    return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$storacha$2f$client$2f$dist$2f$client$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["Client"](data, options);
}
;
 //# sourceMappingURL=index.js.map
}),
]);

//# sourceMappingURL=node_modules_%40storacha_client_dist_2713dd6d._.js.map